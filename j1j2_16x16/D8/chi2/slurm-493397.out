/home/rppeng/code/quimb-refactor/quimb/tensor/decomp.py:214: UserWarning: TN SVD failed, trying again with alternate driver.
  warnings.warn("TN SVD failed, trying again with alternate driver.")
/home/rppeng/code/quimb-refactor/quimb/tensor/decomp.py:214: UserWarning: TN SVD failed, trying again with alternate driver.
  warnings.warn("TN SVD failed, trying again with alternate driver.")
/home/rppeng/code/quimb-refactor/quimb/tensor/decomp.py:214: UserWarning: TN SVD failed, trying again with alternate driver.
  warnings.warn("TN SVD failed, trying again with alternate driver.")
/home/rppeng/code/quimb-refactor/quimb/tensor/decomp.py:214: UserWarning: TN SVD failed, trying again with alternate driver.
  warnings.warn("TN SVD failed, trying again with alternate driver.")
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 632, in pair_energies_deterministic
    ex[site1,site2] = self.pair_energy_deterministic(config,peps,site1,site2,cache_bot,cache_top,sign_fn) * sign
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 606, in pair_energy_deterministic
    bot_term = self.get_bot_env(i,row,bot_term,config_new,cache_bot)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 224, in get_bot_env
    tn.contract_boundary_from_bottom_(xrange=(i-1,i),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1235, in contract_boundary_from_bottom
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 857, in _contract_boundary_single
    compress_opts=compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 723, in compress_row
    cutoff=cutoff, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5038, in compress_between
    **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 4942, in _compress_between_tids
    tensor_compress_bond(ta, tb, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 967, in tensor_compress_bond
    get='tensors', method='qr')
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 816, in tensor_split
    right = reshape(right, (-1, *right_dims))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [-1, 0] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 625, in pair_energies_deterministic
    env_bot,env_top = self.get_all_benvs(peps,config,cache_bot,cache_top)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 275, in get_all_benvs
    env_bot = self.get_all_bot_envs(peps,config,cache_bot,imax=imax)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 235, in get_all_bot_envs
    env_prev = self.get_bot_env(i,row,env_prev,config,cache_bot)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 224, in get_bot_env
    tn.contract_boundary_from_bottom_(xrange=(i-1,i),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1235, in contract_boundary_from_bottom
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 857, in _contract_boundary_single
    compress_opts=compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 723, in compress_row
    cutoff=cutoff, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5038, in compress_between
    **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 4942, in _compress_between_tids
    tensor_compress_bond(ta, tb, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 974, in tensor_compress_bond
    absorb=absorb, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 815, in tensor_split
    left = reshape(left, (*left_dims, -1))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [0, -1] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 625, in pair_energies_deterministic
    env_bot,env_top = self.get_all_benvs(peps,config,cache_bot,cache_top)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 278, in get_all_benvs
    env_top = self.get_all_top_envs(peps,config,cache_top,imin=imin)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 268, in get_all_top_envs
    env_prev = self.get_top_env(i,row,env_prev,config,cache_top)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 258, in get_top_env
    tn.contract_boundary_from_top_(xrange=(i,i+1),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1351, in contract_boundary_from_top
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 848, in _contract_boundary_single
    canonize_fn(i, equalize_norms=equalize_norms)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 583, in canonize_row
    self.canonize_between((i, j), (i, j - 1), **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5110, in canonize_between
    self._canonize_between_tids(tid1, tid2, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5068, in _canonize_between_tids
    tensor_canonize_bond(Tl, Tr, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 897, in tensor_canonize_bond
    new_T1, tRfact = T1.split(left_env_ix, get='tensors', **split_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 815, in tensor_split
    left = reshape(left, (*left_dims, -1))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [0, 8, -1] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 632, in pair_energies_deterministic
    ex[site1,site2] = self.pair_energy_deterministic(config,peps,site1,site2,cache_bot,cache_top,sign_fn) * sign
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 606, in pair_energy_deterministic
    bot_term = self.get_bot_env(i,row,bot_term,config_new,cache_bot)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 224, in get_bot_env
    tn.contract_boundary_from_bottom_(xrange=(i-1,i),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1235, in contract_boundary_from_bottom
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 857, in _contract_boundary_single
    compress_opts=compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 723, in compress_row
    cutoff=cutoff, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5038, in compress_between
    **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 4942, in _compress_between_tids
    tensor_compress_bond(ta, tb, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 967, in tensor_compress_bond
    get='tensors', method='qr')
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 816, in tensor_split
    right = reshape(right, (-1, *right_dims))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [-1, 0] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 625, in pair_energies_deterministic
    env_bot,env_top = self.get_all_benvs(peps,config,cache_bot,cache_top)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 275, in get_all_benvs
    env_bot = self.get_all_bot_envs(peps,config,cache_bot,imax=imax)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 235, in get_all_bot_envs
    env_prev = self.get_bot_env(i,row,env_prev,config,cache_bot)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 224, in get_bot_env
    tn.contract_boundary_from_bottom_(xrange=(i-1,i),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1235, in contract_boundary_from_bottom
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 857, in _contract_boundary_single
    compress_opts=compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 723, in compress_row
    cutoff=cutoff, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5038, in compress_between
    **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 4942, in _compress_between_tids
    tensor_compress_bond(ta, tb, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 974, in tensor_compress_bond
    absorb=absorb, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 815, in tensor_split
    left = reshape(left, (*left_dims, -1))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [0, -1] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 632, in pair_energies_deterministic
    ex[site1,site2] = self.pair_energy_deterministic(config,peps,site1,site2,cache_bot,cache_top,sign_fn) * sign
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 606, in pair_energy_deterministic
    bot_term = self.get_bot_env(i,row,bot_term,config_new,cache_bot)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 224, in get_bot_env
    tn.contract_boundary_from_bottom_(xrange=(i-1,i),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1235, in contract_boundary_from_bottom
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 857, in _contract_boundary_single
    compress_opts=compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 723, in compress_row
    cutoff=cutoff, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5038, in compress_between
    **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 4942, in _compress_between_tids
    tensor_compress_bond(ta, tb, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 974, in tensor_compress_bond
    absorb=absorb, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 815, in tensor_split
    left = reshape(left, (*left_dims, -1))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [0, -1] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 625, in pair_energies_deterministic
    env_bot,env_top = self.get_all_benvs(peps,config,cache_bot,cache_top)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 278, in get_all_benvs
    env_top = self.get_all_top_envs(peps,config,cache_top,imin=imin)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 268, in get_all_top_envs
    env_prev = self.get_top_env(i,row,env_prev,config,cache_top)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 258, in get_top_env
    tn.contract_boundary_from_top_(xrange=(i,i+1),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1351, in contract_boundary_from_top
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 848, in _contract_boundary_single
    canonize_fn(i, equalize_norms=equalize_norms)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 583, in canonize_row
    self.canonize_between((i, j), (i, j - 1), **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5110, in canonize_between
    self._canonize_between_tids(tid1, tid2, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5068, in _canonize_between_tids
    tensor_canonize_bond(Tl, Tr, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 897, in tensor_canonize_bond
    new_T1, tRfact = T1.split(left_env_ix, get='tensors', **split_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 815, in tensor_split
    left = reshape(left, (*left_dims, -1))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [0, 8, -1] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 625, in pair_energies_deterministic
    env_bot,env_top = self.get_all_benvs(peps,config,cache_bot,cache_top)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 275, in get_all_benvs
    env_bot = self.get_all_bot_envs(peps,config,cache_bot,imax=imax)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 235, in get_all_bot_envs
    env_prev = self.get_bot_env(i,row,env_prev,config,cache_bot)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 224, in get_bot_env
    tn.contract_boundary_from_bottom_(xrange=(i-1,i),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1235, in contract_boundary_from_bottom
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 857, in _contract_boundary_single
    compress_opts=compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 723, in compress_row
    cutoff=cutoff, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5038, in compress_between
    **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 4942, in _compress_between_tids
    tensor_compress_bond(ta, tb, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 967, in tensor_compress_bond
    get='tensors', method='qr')
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 816, in tensor_split
    right = reshape(right, (-1, *right_dims))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [-1, 0] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 625, in pair_energies_deterministic
    env_bot,env_top = self.get_all_benvs(peps,config,cache_bot,cache_top)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 275, in get_all_benvs
    env_bot = self.get_all_bot_envs(peps,config,cache_bot,imax=imax)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 235, in get_all_bot_envs
    env_prev = self.get_bot_env(i,row,env_prev,config,cache_bot)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 224, in get_bot_env
    tn.contract_boundary_from_bottom_(xrange=(i-1,i),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1235, in contract_boundary_from_bottom
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 857, in _contract_boundary_single
    compress_opts=compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 723, in compress_row
    cutoff=cutoff, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5038, in compress_between
    **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 4942, in _compress_between_tids
    tensor_compress_bond(ta, tb, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 974, in tensor_compress_bond
    absorb=absorb, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 815, in tensor_split
    left = reshape(left, (*left_dims, -1))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [0, -1] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 625, in pair_energies_deterministic
    env_bot,env_top = self.get_all_benvs(peps,config,cache_bot,cache_top)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 278, in get_all_benvs
    env_top = self.get_all_top_envs(peps,config,cache_top,imin=imin)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 268, in get_all_top_envs
    env_prev = self.get_top_env(i,row,env_prev,config,cache_top)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 258, in get_top_env
    tn.contract_boundary_from_top_(xrange=(i,i+1),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1351, in contract_boundary_from_top
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 848, in _contract_boundary_single
    canonize_fn(i, equalize_norms=equalize_norms)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 583, in canonize_row
    self.canonize_between((i, j), (i, j - 1), **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5110, in canonize_between
    self._canonize_between_tids(tid1, tid2, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5068, in _canonize_between_tids
    tensor_canonize_bond(Tl, Tr, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 897, in tensor_canonize_bond
    new_T1, tRfact = T1.split(left_env_ix, get='tensors', **split_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 815, in tensor_split
    left = reshape(left, (*left_dims, -1))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [0, 8, -1] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 625, in pair_energies_deterministic
    env_bot,env_top = self.get_all_benvs(peps,config,cache_bot,cache_top)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 278, in get_all_benvs
    env_top = self.get_all_top_envs(peps,config,cache_top,imin=imin)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 268, in get_all_top_envs
    env_prev = self.get_top_env(i,row,env_prev,config,cache_top)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 258, in get_top_env
    tn.contract_boundary_from_top_(xrange=(i,i+1),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1351, in contract_boundary_from_top
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 848, in _contract_boundary_single
    canonize_fn(i, equalize_norms=equalize_norms)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 583, in canonize_row
    self.canonize_between((i, j), (i, j - 1), **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5110, in canonize_between
    self._canonize_between_tids(tid1, tid2, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5068, in _canonize_between_tids
    tensor_canonize_bond(Tl, Tr, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 897, in tensor_canonize_bond
    new_T1, tRfact = T1.split(left_env_ix, get='tensors', **split_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 815, in tensor_split
    left = reshape(left, (*left_dims, -1))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [0, 8, -1] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 625, in pair_energies_deterministic
    env_bot,env_top = self.get_all_benvs(peps,config,cache_bot,cache_top)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 278, in get_all_benvs
    env_top = self.get_all_top_envs(peps,config,cache_top,imin=imin)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 268, in get_all_top_envs
    env_prev = self.get_top_env(i,row,env_prev,config,cache_top)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 258, in get_top_env
    tn.contract_boundary_from_top_(xrange=(i,i+1),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1351, in contract_boundary_from_top
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 857, in _contract_boundary_single
    compress_opts=compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 719, in compress_row
    cutoff=cutoff, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5038, in compress_between
    **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 4942, in _compress_between_tids
    tensor_compress_bond(ta, tb, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 967, in tensor_compress_bond
    get='tensors', method='qr')
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 816, in tensor_split
    right = reshape(right, (-1, *right_dims))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [-1, 0] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 625, in pair_energies_deterministic
    env_bot,env_top = self.get_all_benvs(peps,config,cache_bot,cache_top)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 275, in get_all_benvs
    env_bot = self.get_all_bot_envs(peps,config,cache_bot,imax=imax)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 235, in get_all_bot_envs
    env_prev = self.get_bot_env(i,row,env_prev,config,cache_bot)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 224, in get_bot_env
    tn.contract_boundary_from_bottom_(xrange=(i-1,i),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1235, in contract_boundary_from_bottom
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 848, in _contract_boundary_single
    canonize_fn(i, equalize_norms=equalize_norms)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 579, in canonize_row
    self.canonize_between((i, j), (i, j + 1), **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5110, in canonize_between
    self._canonize_between_tids(tid1, tid2, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5068, in _canonize_between_tids
    tensor_canonize_bond(Tl, Tr, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 897, in tensor_canonize_bond
    new_T1, tRfact = T1.split(left_env_ix, get='tensors', **split_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 815, in tensor_split
    left = reshape(left, (*left_dims, -1))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [0, 8, -1] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 632, in pair_energies_deterministic
    ex[site1,site2] = self.pair_energy_deterministic(config,peps,site1,site2,cache_bot,cache_top,sign_fn) * sign
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 606, in pair_energy_deterministic
    bot_term = self.get_bot_env(i,row,bot_term,config_new,cache_bot)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 224, in get_bot_env
    tn.contract_boundary_from_bottom_(xrange=(i-1,i),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1235, in contract_boundary_from_bottom
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 848, in _contract_boundary_single
    canonize_fn(i, equalize_norms=equalize_norms)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 579, in canonize_row
    self.canonize_between((i, j), (i, j + 1), **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5110, in canonize_between
    self._canonize_between_tids(tid1, tid2, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5068, in _canonize_between_tids
    tensor_canonize_bond(Tl, Tr, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 897, in tensor_canonize_bond
    new_T1, tRfact = T1.split(left_env_ix, get='tensors', **split_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 815, in tensor_split
    left = reshape(left, (*left_dims, -1))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [0, 8, -1] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 625, in pair_energies_deterministic
    env_bot,env_top = self.get_all_benvs(peps,config,cache_bot,cache_top)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 275, in get_all_benvs
    env_bot = self.get_all_bot_envs(peps,config,cache_bot,imax=imax)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 235, in get_all_bot_envs
    env_prev = self.get_bot_env(i,row,env_prev,config,cache_bot)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 224, in get_bot_env
    tn.contract_boundary_from_bottom_(xrange=(i-1,i),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1235, in contract_boundary_from_bottom
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 857, in _contract_boundary_single
    compress_opts=compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 723, in compress_row
    cutoff=cutoff, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5038, in compress_between
    **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 4942, in _compress_between_tids
    tensor_compress_bond(ta, tb, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 967, in tensor_compress_bond
    get='tensors', method='qr')
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 816, in tensor_split
    right = reshape(right, (-1, *right_dims))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [-1, 0] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 632, in pair_energies_deterministic
    ex[site1,site2] = self.pair_energy_deterministic(config,peps,site1,site2,cache_bot,cache_top,sign_fn) * sign
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 606, in pair_energy_deterministic
    bot_term = self.get_bot_env(i,row,bot_term,config_new,cache_bot)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 224, in get_bot_env
    tn.contract_boundary_from_bottom_(xrange=(i-1,i),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1235, in contract_boundary_from_bottom
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 857, in _contract_boundary_single
    compress_opts=compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 723, in compress_row
    cutoff=cutoff, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5038, in compress_between
    **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 4942, in _compress_between_tids
    tensor_compress_bond(ta, tb, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 967, in tensor_compress_bond
    get='tensors', method='qr')
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 816, in tensor_split
    right = reshape(right, (-1, *right_dims))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [-1, 0] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 625, in pair_energies_deterministic
    env_bot,env_top = self.get_all_benvs(peps,config,cache_bot,cache_top)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 275, in get_all_benvs
    env_bot = self.get_all_bot_envs(peps,config,cache_bot,imax=imax)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 235, in get_all_bot_envs
    env_prev = self.get_bot_env(i,row,env_prev,config,cache_bot)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 224, in get_bot_env
    tn.contract_boundary_from_bottom_(xrange=(i-1,i),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1235, in contract_boundary_from_bottom
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 857, in _contract_boundary_single
    compress_opts=compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 723, in compress_row
    cutoff=cutoff, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5038, in compress_between
    **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 4942, in _compress_between_tids
    tensor_compress_bond(ta, tb, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 967, in tensor_compress_bond
    get='tensors', method='qr')
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 816, in tensor_split
    right = reshape(right, (-1, *right_dims))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [-1, 0] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 632, in pair_energies_deterministic
    ex[site1,site2] = self.pair_energy_deterministic(config,peps,site1,site2,cache_bot,cache_top,sign_fn) * sign
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 606, in pair_energy_deterministic
    bot_term = self.get_bot_env(i,row,bot_term,config_new,cache_bot)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 224, in get_bot_env
    tn.contract_boundary_from_bottom_(xrange=(i-1,i),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1235, in contract_boundary_from_bottom
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 857, in _contract_boundary_single
    compress_opts=compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 723, in compress_row
    cutoff=cutoff, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5038, in compress_between
    **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 4942, in _compress_between_tids
    tensor_compress_bond(ta, tb, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 974, in tensor_compress_bond
    absorb=absorb, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 815, in tensor_split
    left = reshape(left, (*left_dims, -1))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [0, -1] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 632, in pair_energies_deterministic
    ex[site1,site2] = self.pair_energy_deterministic(config,peps,site1,site2,cache_bot,cache_top,sign_fn) * sign
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 606, in pair_energy_deterministic
    bot_term = self.get_bot_env(i,row,bot_term,config_new,cache_bot)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 224, in get_bot_env
    tn.contract_boundary_from_bottom_(xrange=(i-1,i),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1235, in contract_boundary_from_bottom
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 848, in _contract_boundary_single
    canonize_fn(i, equalize_norms=equalize_norms)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 579, in canonize_row
    self.canonize_between((i, j), (i, j + 1), **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5110, in canonize_between
    self._canonize_between_tids(tid1, tid2, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5068, in _canonize_between_tids
    tensor_canonize_bond(Tl, Tr, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 897, in tensor_canonize_bond
    new_T1, tRfact = T1.split(left_env_ix, get='tensors', **split_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 815, in tensor_split
    left = reshape(left, (*left_dims, -1))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [0, 8, -1] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 625, in pair_energies_deterministic
    env_bot,env_top = self.get_all_benvs(peps,config,cache_bot,cache_top)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 275, in get_all_benvs
    env_bot = self.get_all_bot_envs(peps,config,cache_bot,imax=imax)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 235, in get_all_bot_envs
    env_prev = self.get_bot_env(i,row,env_prev,config,cache_bot)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 224, in get_bot_env
    tn.contract_boundary_from_bottom_(xrange=(i-1,i),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1235, in contract_boundary_from_bottom
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 857, in _contract_boundary_single
    compress_opts=compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 723, in compress_row
    cutoff=cutoff, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5038, in compress_between
    **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 4942, in _compress_between_tids
    tensor_compress_bond(ta, tb, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 967, in tensor_compress_bond
    get='tensors', method='qr')
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 816, in tensor_split
    right = reshape(right, (-1, *right_dims))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [-1, 0] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 625, in pair_energies_deterministic
    env_bot,env_top = self.get_all_benvs(peps,config,cache_bot,cache_top)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 275, in get_all_benvs
    env_bot = self.get_all_bot_envs(peps,config,cache_bot,imax=imax)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 235, in get_all_bot_envs
    env_prev = self.get_bot_env(i,row,env_prev,config,cache_bot)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 224, in get_bot_env
    tn.contract_boundary_from_bottom_(xrange=(i-1,i),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1235, in contract_boundary_from_bottom
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 848, in _contract_boundary_single
    canonize_fn(i, equalize_norms=equalize_norms)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 579, in canonize_row
    self.canonize_between((i, j), (i, j + 1), **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5110, in canonize_between
    self._canonize_between_tids(tid1, tid2, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5068, in _canonize_between_tids
    tensor_canonize_bond(Tl, Tr, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 897, in tensor_canonize_bond
    new_T1, tRfact = T1.split(left_env_ix, get='tensors', **split_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 815, in tensor_split
    left = reshape(left, (*left_dims, -1))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [0, 8, -1] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 632, in pair_energies_deterministic
    ex[site1,site2] = self.pair_energy_deterministic(config,peps,site1,site2,cache_bot,cache_top,sign_fn) * sign
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 606, in pair_energy_deterministic
    bot_term = self.get_bot_env(i,row,bot_term,config_new,cache_bot)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 224, in get_bot_env
    tn.contract_boundary_from_bottom_(xrange=(i-1,i),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1235, in contract_boundary_from_bottom
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 848, in _contract_boundary_single
    canonize_fn(i, equalize_norms=equalize_norms)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 579, in canonize_row
    self.canonize_between((i, j), (i, j + 1), **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5110, in canonize_between
    self._canonize_between_tids(tid1, tid2, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5068, in _canonize_between_tids
    tensor_canonize_bond(Tl, Tr, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 897, in tensor_canonize_bond
    new_T1, tRfact = T1.split(left_env_ix, get='tensors', **split_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 815, in tensor_split
    left = reshape(left, (*left_dims, -1))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [0, 8, -1] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 625, in pair_energies_deterministic
    env_bot,env_top = self.get_all_benvs(peps,config,cache_bot,cache_top)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 278, in get_all_benvs
    env_top = self.get_all_top_envs(peps,config,cache_top,imin=imin)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 268, in get_all_top_envs
    env_prev = self.get_top_env(i,row,env_prev,config,cache_top)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 258, in get_top_env
    tn.contract_boundary_from_top_(xrange=(i,i+1),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1351, in contract_boundary_from_top
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 848, in _contract_boundary_single
    canonize_fn(i, equalize_norms=equalize_norms)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 583, in canonize_row
    self.canonize_between((i, j), (i, j - 1), **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5110, in canonize_between
    self._canonize_between_tids(tid1, tid2, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5068, in _canonize_between_tids
    tensor_canonize_bond(Tl, Tr, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 897, in tensor_canonize_bond
    new_T1, tRfact = T1.split(left_env_ix, get='tensors', **split_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 815, in tensor_split
    left = reshape(left, (*left_dims, -1))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [0, 8, -1] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 625, in pair_energies_deterministic
    env_bot,env_top = self.get_all_benvs(peps,config,cache_bot,cache_top)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 275, in get_all_benvs
    env_bot = self.get_all_bot_envs(peps,config,cache_bot,imax=imax)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 235, in get_all_bot_envs
    env_prev = self.get_bot_env(i,row,env_prev,config,cache_bot)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 224, in get_bot_env
    tn.contract_boundary_from_bottom_(xrange=(i-1,i),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1235, in contract_boundary_from_bottom
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 848, in _contract_boundary_single
    canonize_fn(i, equalize_norms=equalize_norms)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 579, in canonize_row
    self.canonize_between((i, j), (i, j + 1), **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5110, in canonize_between
    self._canonize_between_tids(tid1, tid2, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5068, in _canonize_between_tids
    tensor_canonize_bond(Tl, Tr, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 897, in tensor_canonize_bond
    new_T1, tRfact = T1.split(left_env_ix, get='tensors', **split_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 815, in tensor_split
    left = reshape(left, (*left_dims, -1))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [0, 8, -1] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 632, in pair_energies_deterministic
    ex[site1,site2] = self.pair_energy_deterministic(config,peps,site1,site2,cache_bot,cache_top,sign_fn) * sign
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 606, in pair_energy_deterministic
    bot_term = self.get_bot_env(i,row,bot_term,config_new,cache_bot)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 224, in get_bot_env
    tn.contract_boundary_from_bottom_(xrange=(i-1,i),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1235, in contract_boundary_from_bottom
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 848, in _contract_boundary_single
    canonize_fn(i, equalize_norms=equalize_norms)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 579, in canonize_row
    self.canonize_between((i, j), (i, j + 1), **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5110, in canonize_between
    self._canonize_between_tids(tid1, tid2, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5068, in _canonize_between_tids
    tensor_canonize_bond(Tl, Tr, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 897, in tensor_canonize_bond
    new_T1, tRfact = T1.split(left_env_ix, get='tensors', **split_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 815, in tensor_split
    left = reshape(left, (*left_dims, -1))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [0, 8, -1] because the unspecified dimension size -1 can be any value and is ambiguous
/home/rppeng/code/quimb-refactor/quimb/tensor/decomp.py:214: UserWarning: TN SVD failed, trying again with alternate driver.
  warnings.warn("TN SVD failed, trying again with alternate driver.")
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 625, in pair_energies_deterministic
    env_bot,env_top = self.get_all_benvs(peps,config,cache_bot,cache_top)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 275, in get_all_benvs
    env_bot = self.get_all_bot_envs(peps,config,cache_bot,imax=imax)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 235, in get_all_bot_envs
    env_prev = self.get_bot_env(i,row,env_prev,config,cache_bot)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 224, in get_bot_env
    tn.contract_boundary_from_bottom_(xrange=(i-1,i),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1235, in contract_boundary_from_bottom
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 857, in _contract_boundary_single
    compress_opts=compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 723, in compress_row
    cutoff=cutoff, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5038, in compress_between
    **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 4942, in _compress_between_tids
    tensor_compress_bond(ta, tb, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 974, in tensor_compress_bond
    absorb=absorb, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 815, in tensor_split
    left = reshape(left, (*left_dims, -1))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [0, -1] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 625, in pair_energies_deterministic
    env_bot,env_top = self.get_all_benvs(peps,config,cache_bot,cache_top)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 275, in get_all_benvs
    env_bot = self.get_all_bot_envs(peps,config,cache_bot,imax=imax)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 235, in get_all_bot_envs
    env_prev = self.get_bot_env(i,row,env_prev,config,cache_bot)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 224, in get_bot_env
    tn.contract_boundary_from_bottom_(xrange=(i-1,i),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1235, in contract_boundary_from_bottom
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 848, in _contract_boundary_single
    canonize_fn(i, equalize_norms=equalize_norms)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 579, in canonize_row
    self.canonize_between((i, j), (i, j + 1), **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5110, in canonize_between
    self._canonize_between_tids(tid1, tid2, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5068, in _canonize_between_tids
    tensor_canonize_bond(Tl, Tr, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 897, in tensor_canonize_bond
    new_T1, tRfact = T1.split(left_env_ix, get='tensors', **split_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 815, in tensor_split
    left = reshape(left, (*left_dims, -1))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [0, 8, -1] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 625, in pair_energies_deterministic
    env_bot,env_top = self.get_all_benvs(peps,config,cache_bot,cache_top)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 275, in get_all_benvs
    env_bot = self.get_all_bot_envs(peps,config,cache_bot,imax=imax)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 235, in get_all_bot_envs
    env_prev = self.get_bot_env(i,row,env_prev,config,cache_bot)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 224, in get_bot_env
    tn.contract_boundary_from_bottom_(xrange=(i-1,i),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1235, in contract_boundary_from_bottom
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 848, in _contract_boundary_single
    canonize_fn(i, equalize_norms=equalize_norms)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 579, in canonize_row
    self.canonize_between((i, j), (i, j + 1), **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5110, in canonize_between
    self._canonize_between_tids(tid1, tid2, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5068, in _canonize_between_tids
    tensor_canonize_bond(Tl, Tr, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 897, in tensor_canonize_bond
    new_T1, tRfact = T1.split(left_env_ix, get='tensors', **split_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 815, in tensor_split
    left = reshape(left, (*left_dims, -1))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [0, 8, -1] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 632, in pair_energies_deterministic
    ex[site1,site2] = self.pair_energy_deterministic(config,peps,site1,site2,cache_bot,cache_top,sign_fn) * sign
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 606, in pair_energy_deterministic
    bot_term = self.get_bot_env(i,row,bot_term,config_new,cache_bot)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 224, in get_bot_env
    tn.contract_boundary_from_bottom_(xrange=(i-1,i),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1235, in contract_boundary_from_bottom
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 857, in _contract_boundary_single
    compress_opts=compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 723, in compress_row
    cutoff=cutoff, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5038, in compress_between
    **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 4942, in _compress_between_tids
    tensor_compress_bond(ta, tb, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 974, in tensor_compress_bond
    absorb=absorb, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 815, in tensor_split
    left = reshape(left, (*left_dims, -1))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [0, -1] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 625, in pair_energies_deterministic
    env_bot,env_top = self.get_all_benvs(peps,config,cache_bot,cache_top)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 275, in get_all_benvs
    env_bot = self.get_all_bot_envs(peps,config,cache_bot,imax=imax)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 235, in get_all_bot_envs
    env_prev = self.get_bot_env(i,row,env_prev,config,cache_bot)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 224, in get_bot_env
    tn.contract_boundary_from_bottom_(xrange=(i-1,i),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1235, in contract_boundary_from_bottom
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 857, in _contract_boundary_single
    compress_opts=compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 723, in compress_row
    cutoff=cutoff, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5038, in compress_between
    **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 4942, in _compress_between_tids
    tensor_compress_bond(ta, tb, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 967, in tensor_compress_bond
    get='tensors', method='qr')
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 816, in tensor_split
    right = reshape(right, (-1, *right_dims))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [-1, 0] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 625, in pair_energies_deterministic
    env_bot,env_top = self.get_all_benvs(peps,config,cache_bot,cache_top)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 275, in get_all_benvs
    env_bot = self.get_all_bot_envs(peps,config,cache_bot,imax=imax)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 235, in get_all_bot_envs
    env_prev = self.get_bot_env(i,row,env_prev,config,cache_bot)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 224, in get_bot_env
    tn.contract_boundary_from_bottom_(xrange=(i-1,i),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1235, in contract_boundary_from_bottom
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 848, in _contract_boundary_single
    canonize_fn(i, equalize_norms=equalize_norms)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 579, in canonize_row
    self.canonize_between((i, j), (i, j + 1), **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5110, in canonize_between
    self._canonize_between_tids(tid1, tid2, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5068, in _canonize_between_tids
    tensor_canonize_bond(Tl, Tr, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 897, in tensor_canonize_bond
    new_T1, tRfact = T1.split(left_env_ix, get='tensors', **split_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 815, in tensor_split
    left = reshape(left, (*left_dims, -1))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [0, 8, -1] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 632, in pair_energies_deterministic
    ex[site1,site2] = self.pair_energy_deterministic(config,peps,site1,site2,cache_bot,cache_top,sign_fn) * sign
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 606, in pair_energy_deterministic
    bot_term = self.get_bot_env(i,row,bot_term,config_new,cache_bot)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 224, in get_bot_env
    tn.contract_boundary_from_bottom_(xrange=(i-1,i),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1235, in contract_boundary_from_bottom
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 857, in _contract_boundary_single
    compress_opts=compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 723, in compress_row
    cutoff=cutoff, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5038, in compress_between
    **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 4942, in _compress_between_tids
    tensor_compress_bond(ta, tb, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 967, in tensor_compress_bond
    get='tensors', method='qr')
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 816, in tensor_split
    right = reshape(right, (-1, *right_dims))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [-1, 0] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 632, in pair_energies_deterministic
    ex[site1,site2] = self.pair_energy_deterministic(config,peps,site1,site2,cache_bot,cache_top,sign_fn) * sign
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 606, in pair_energy_deterministic
    bot_term = self.get_bot_env(i,row,bot_term,config_new,cache_bot)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 224, in get_bot_env
    tn.contract_boundary_from_bottom_(xrange=(i-1,i),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1235, in contract_boundary_from_bottom
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 848, in _contract_boundary_single
    canonize_fn(i, equalize_norms=equalize_norms)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 579, in canonize_row
    self.canonize_between((i, j), (i, j + 1), **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5110, in canonize_between
    self._canonize_between_tids(tid1, tid2, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5068, in _canonize_between_tids
    tensor_canonize_bond(Tl, Tr, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 897, in tensor_canonize_bond
    new_T1, tRfact = T1.split(left_env_ix, get='tensors', **split_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 815, in tensor_split
    left = reshape(left, (*left_dims, -1))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [0, 8, -1] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 632, in pair_energies_deterministic
    ex[site1,site2] = self.pair_energy_deterministic(config,peps,site1,site2,cache_bot,cache_top,sign_fn) * sign
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 606, in pair_energy_deterministic
    bot_term = self.get_bot_env(i,row,bot_term,config_new,cache_bot)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 224, in get_bot_env
    tn.contract_boundary_from_bottom_(xrange=(i-1,i),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1235, in contract_boundary_from_bottom
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 848, in _contract_boundary_single
    canonize_fn(i, equalize_norms=equalize_norms)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 579, in canonize_row
    self.canonize_between((i, j), (i, j + 1), **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5110, in canonize_between
    self._canonize_between_tids(tid1, tid2, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5068, in _canonize_between_tids
    tensor_canonize_bond(Tl, Tr, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 897, in tensor_canonize_bond
    new_T1, tRfact = T1.split(left_env_ix, get='tensors', **split_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 815, in tensor_split
    left = reshape(left, (*left_dims, -1))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [0, 8, -1] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 632, in pair_energies_deterministic
    ex[site1,site2] = self.pair_energy_deterministic(config,peps,site1,site2,cache_bot,cache_top,sign_fn) * sign
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 606, in pair_energy_deterministic
    bot_term = self.get_bot_env(i,row,bot_term,config_new,cache_bot)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 224, in get_bot_env
    tn.contract_boundary_from_bottom_(xrange=(i-1,i),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1235, in contract_boundary_from_bottom
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 848, in _contract_boundary_single
    canonize_fn(i, equalize_norms=equalize_norms)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 579, in canonize_row
    self.canonize_between((i, j), (i, j + 1), **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5110, in canonize_between
    self._canonize_between_tids(tid1, tid2, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5068, in _canonize_between_tids
    tensor_canonize_bond(Tl, Tr, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 897, in tensor_canonize_bond
    new_T1, tRfact = T1.split(left_env_ix, get='tensors', **split_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 815, in tensor_split
    left = reshape(left, (*left_dims, -1))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [0, 8, -1] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 632, in pair_energies_deterministic
    ex[site1,site2] = self.pair_energy_deterministic(config,peps,site1,site2,cache_bot,cache_top,sign_fn) * sign
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 606, in pair_energy_deterministic
    bot_term = self.get_bot_env(i,row,bot_term,config_new,cache_bot)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 224, in get_bot_env
    tn.contract_boundary_from_bottom_(xrange=(i-1,i),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1235, in contract_boundary_from_bottom
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 857, in _contract_boundary_single
    compress_opts=compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 723, in compress_row
    cutoff=cutoff, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5038, in compress_between
    **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 4942, in _compress_between_tids
    tensor_compress_bond(ta, tb, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 974, in tensor_compress_bond
    absorb=absorb, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 815, in tensor_split
    left = reshape(left, (*left_dims, -1))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [0, -1] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 625, in pair_energies_deterministic
    env_bot,env_top = self.get_all_benvs(peps,config,cache_bot,cache_top)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 278, in get_all_benvs
    env_top = self.get_all_top_envs(peps,config,cache_top,imin=imin)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 268, in get_all_top_envs
    env_prev = self.get_top_env(i,row,env_prev,config,cache_top)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 258, in get_top_env
    tn.contract_boundary_from_top_(xrange=(i,i+1),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1351, in contract_boundary_from_top
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 848, in _contract_boundary_single
    canonize_fn(i, equalize_norms=equalize_norms)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 583, in canonize_row
    self.canonize_between((i, j), (i, j - 1), **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5110, in canonize_between
    self._canonize_between_tids(tid1, tid2, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5068, in _canonize_between_tids
    tensor_canonize_bond(Tl, Tr, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 897, in tensor_canonize_bond
    new_T1, tRfact = T1.split(left_env_ix, get='tensors', **split_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 815, in tensor_split
    left = reshape(left, (*left_dims, -1))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [0, 8, -1] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 625, in pair_energies_deterministic
    env_bot,env_top = self.get_all_benvs(peps,config,cache_bot,cache_top)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 275, in get_all_benvs
    env_bot = self.get_all_bot_envs(peps,config,cache_bot,imax=imax)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 235, in get_all_bot_envs
    env_prev = self.get_bot_env(i,row,env_prev,config,cache_bot)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 224, in get_bot_env
    tn.contract_boundary_from_bottom_(xrange=(i-1,i),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1235, in contract_boundary_from_bottom
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 857, in _contract_boundary_single
    compress_opts=compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 723, in compress_row
    cutoff=cutoff, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5038, in compress_between
    **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 4942, in _compress_between_tids
    tensor_compress_bond(ta, tb, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 967, in tensor_compress_bond
    get='tensors', method='qr')
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 816, in tensor_split
    right = reshape(right, (-1, *right_dims))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [-1, 0] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 625, in pair_energies_deterministic
    env_bot,env_top = self.get_all_benvs(peps,config,cache_bot,cache_top)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 275, in get_all_benvs
    env_bot = self.get_all_bot_envs(peps,config,cache_bot,imax=imax)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 235, in get_all_bot_envs
    env_prev = self.get_bot_env(i,row,env_prev,config,cache_bot)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 224, in get_bot_env
    tn.contract_boundary_from_bottom_(xrange=(i-1,i),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1235, in contract_boundary_from_bottom
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 848, in _contract_boundary_single
    canonize_fn(i, equalize_norms=equalize_norms)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 579, in canonize_row
    self.canonize_between((i, j), (i, j + 1), **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5110, in canonize_between
    self._canonize_between_tids(tid1, tid2, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5068, in _canonize_between_tids
    tensor_canonize_bond(Tl, Tr, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 897, in tensor_canonize_bond
    new_T1, tRfact = T1.split(left_env_ix, get='tensors', **split_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 815, in tensor_split
    left = reshape(left, (*left_dims, -1))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [0, 8, -1] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 632, in pair_energies_deterministic
    ex[site1,site2] = self.pair_energy_deterministic(config,peps,site1,site2,cache_bot,cache_top,sign_fn) * sign
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 606, in pair_energy_deterministic
    bot_term = self.get_bot_env(i,row,bot_term,config_new,cache_bot)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 224, in get_bot_env
    tn.contract_boundary_from_bottom_(xrange=(i-1,i),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1235, in contract_boundary_from_bottom
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 857, in _contract_boundary_single
    compress_opts=compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 723, in compress_row
    cutoff=cutoff, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5038, in compress_between
    **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 4942, in _compress_between_tids
    tensor_compress_bond(ta, tb, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 967, in tensor_compress_bond
    get='tensors', method='qr')
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 816, in tensor_split
    right = reshape(right, (-1, *right_dims))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [-1, 0] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 625, in pair_energies_deterministic
    env_bot,env_top = self.get_all_benvs(peps,config,cache_bot,cache_top)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 275, in get_all_benvs
    env_bot = self.get_all_bot_envs(peps,config,cache_bot,imax=imax)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 235, in get_all_bot_envs
    env_prev = self.get_bot_env(i,row,env_prev,config,cache_bot)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 224, in get_bot_env
    tn.contract_boundary_from_bottom_(xrange=(i-1,i),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1235, in contract_boundary_from_bottom
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 857, in _contract_boundary_single
    compress_opts=compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 723, in compress_row
    cutoff=cutoff, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5038, in compress_between
    **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 4942, in _compress_between_tids
    tensor_compress_bond(ta, tb, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 967, in tensor_compress_bond
    get='tensors', method='qr')
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 816, in tensor_split
    right = reshape(right, (-1, *right_dims))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [-1, 0] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 625, in pair_energies_deterministic
    env_bot,env_top = self.get_all_benvs(peps,config,cache_bot,cache_top)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 275, in get_all_benvs
    env_bot = self.get_all_bot_envs(peps,config,cache_bot,imax=imax)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 235, in get_all_bot_envs
    env_prev = self.get_bot_env(i,row,env_prev,config,cache_bot)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 224, in get_bot_env
    tn.contract_boundary_from_bottom_(xrange=(i-1,i),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1235, in contract_boundary_from_bottom
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 848, in _contract_boundary_single
    canonize_fn(i, equalize_norms=equalize_norms)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 579, in canonize_row
    self.canonize_between((i, j), (i, j + 1), **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5110, in canonize_between
    self._canonize_between_tids(tid1, tid2, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5068, in _canonize_between_tids
    tensor_canonize_bond(Tl, Tr, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 897, in tensor_canonize_bond
    new_T1, tRfact = T1.split(left_env_ix, get='tensors', **split_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 815, in tensor_split
    left = reshape(left, (*left_dims, -1))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [0, 8, -1] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 625, in pair_energies_deterministic
    env_bot,env_top = self.get_all_benvs(peps,config,cache_bot,cache_top)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 275, in get_all_benvs
    env_bot = self.get_all_bot_envs(peps,config,cache_bot,imax=imax)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 235, in get_all_bot_envs
    env_prev = self.get_bot_env(i,row,env_prev,config,cache_bot)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 224, in get_bot_env
    tn.contract_boundary_from_bottom_(xrange=(i-1,i),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1235, in contract_boundary_from_bottom
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 848, in _contract_boundary_single
    canonize_fn(i, equalize_norms=equalize_norms)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 579, in canonize_row
    self.canonize_between((i, j), (i, j + 1), **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5110, in canonize_between
    self._canonize_between_tids(tid1, tid2, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5068, in _canonize_between_tids
    tensor_canonize_bond(Tl, Tr, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 897, in tensor_canonize_bond
    new_T1, tRfact = T1.split(left_env_ix, get='tensors', **split_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 815, in tensor_split
    left = reshape(left, (*left_dims, -1))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [0, 8, -1] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 632, in pair_energies_deterministic
    ex[site1,site2] = self.pair_energy_deterministic(config,peps,site1,site2,cache_bot,cache_top,sign_fn) * sign
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 606, in pair_energy_deterministic
    bot_term = self.get_bot_env(i,row,bot_term,config_new,cache_bot)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 224, in get_bot_env
    tn.contract_boundary_from_bottom_(xrange=(i-1,i),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1235, in contract_boundary_from_bottom
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 848, in _contract_boundary_single
    canonize_fn(i, equalize_norms=equalize_norms)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 579, in canonize_row
    self.canonize_between((i, j), (i, j + 1), **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5110, in canonize_between
    self._canonize_between_tids(tid1, tid2, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5068, in _canonize_between_tids
    tensor_canonize_bond(Tl, Tr, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 897, in tensor_canonize_bond
    new_T1, tRfact = T1.split(left_env_ix, get='tensors', **split_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 815, in tensor_split
    left = reshape(left, (*left_dims, -1))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [0, 8, -1] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 625, in pair_energies_deterministic
    env_bot,env_top = self.get_all_benvs(peps,config,cache_bot,cache_top)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 278, in get_all_benvs
    env_top = self.get_all_top_envs(peps,config,cache_top,imin=imin)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 268, in get_all_top_envs
    env_prev = self.get_top_env(i,row,env_prev,config,cache_top)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 258, in get_top_env
    tn.contract_boundary_from_top_(xrange=(i,i+1),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1351, in contract_boundary_from_top
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 848, in _contract_boundary_single
    canonize_fn(i, equalize_norms=equalize_norms)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 583, in canonize_row
    self.canonize_between((i, j), (i, j - 1), **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5110, in canonize_between
    self._canonize_between_tids(tid1, tid2, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5068, in _canonize_between_tids
    tensor_canonize_bond(Tl, Tr, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 897, in tensor_canonize_bond
    new_T1, tRfact = T1.split(left_env_ix, get='tensors', **split_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 815, in tensor_split
    left = reshape(left, (*left_dims, -1))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [0, 8, -1] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 625, in pair_energies_deterministic
    env_bot,env_top = self.get_all_benvs(peps,config,cache_bot,cache_top)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 278, in get_all_benvs
    env_top = self.get_all_top_envs(peps,config,cache_top,imin=imin)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 268, in get_all_top_envs
    env_prev = self.get_top_env(i,row,env_prev,config,cache_top)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 258, in get_top_env
    tn.contract_boundary_from_top_(xrange=(i,i+1),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1351, in contract_boundary_from_top
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 848, in _contract_boundary_single
    canonize_fn(i, equalize_norms=equalize_norms)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 583, in canonize_row
    self.canonize_between((i, j), (i, j - 1), **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5110, in canonize_between
    self._canonize_between_tids(tid1, tid2, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5068, in _canonize_between_tids
    tensor_canonize_bond(Tl, Tr, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 897, in tensor_canonize_bond
    new_T1, tRfact = T1.split(left_env_ix, get='tensors', **split_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 815, in tensor_split
    left = reshape(left, (*left_dims, -1))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [0, 8, -1] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 632, in pair_energies_deterministic
    ex[site1,site2] = self.pair_energy_deterministic(config,peps,site1,site2,cache_bot,cache_top,sign_fn) * sign
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 606, in pair_energy_deterministic
    bot_term = self.get_bot_env(i,row,bot_term,config_new,cache_bot)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 224, in get_bot_env
    tn.contract_boundary_from_bottom_(xrange=(i-1,i),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1235, in contract_boundary_from_bottom
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 857, in _contract_boundary_single
    compress_opts=compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 723, in compress_row
    cutoff=cutoff, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5038, in compress_between
    **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 4942, in _compress_between_tids
    tensor_compress_bond(ta, tb, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 974, in tensor_compress_bond
    absorb=absorb, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 815, in tensor_split
    left = reshape(left, (*left_dims, -1))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [0, -1] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 625, in pair_energies_deterministic
    env_bot,env_top = self.get_all_benvs(peps,config,cache_bot,cache_top)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 275, in get_all_benvs
    env_bot = self.get_all_bot_envs(peps,config,cache_bot,imax=imax)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 235, in get_all_bot_envs
    env_prev = self.get_bot_env(i,row,env_prev,config,cache_bot)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 224, in get_bot_env
    tn.contract_boundary_from_bottom_(xrange=(i-1,i),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1235, in contract_boundary_from_bottom
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 848, in _contract_boundary_single
    canonize_fn(i, equalize_norms=equalize_norms)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 579, in canonize_row
    self.canonize_between((i, j), (i, j + 1), **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5110, in canonize_between
    self._canonize_between_tids(tid1, tid2, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5068, in _canonize_between_tids
    tensor_canonize_bond(Tl, Tr, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 897, in tensor_canonize_bond
    new_T1, tRfact = T1.split(left_env_ix, get='tensors', **split_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 815, in tensor_split
    left = reshape(left, (*left_dims, -1))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [0, 8, -1] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 625, in pair_energies_deterministic
    env_bot,env_top = self.get_all_benvs(peps,config,cache_bot,cache_top)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 275, in get_all_benvs
    env_bot = self.get_all_bot_envs(peps,config,cache_bot,imax=imax)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 235, in get_all_bot_envs
    env_prev = self.get_bot_env(i,row,env_prev,config,cache_bot)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 224, in get_bot_env
    tn.contract_boundary_from_bottom_(xrange=(i-1,i),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1235, in contract_boundary_from_bottom
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 857, in _contract_boundary_single
    compress_opts=compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 723, in compress_row
    cutoff=cutoff, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5038, in compress_between
    **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 4942, in _compress_between_tids
    tensor_compress_bond(ta, tb, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 974, in tensor_compress_bond
    absorb=absorb, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 815, in tensor_split
    left = reshape(left, (*left_dims, -1))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [0, -1] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 632, in pair_energies_deterministic
    ex[site1,site2] = self.pair_energy_deterministic(config,peps,site1,site2,cache_bot,cache_top,sign_fn) * sign
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 606, in pair_energy_deterministic
    bot_term = self.get_bot_env(i,row,bot_term,config_new,cache_bot)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 224, in get_bot_env
    tn.contract_boundary_from_bottom_(xrange=(i-1,i),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1235, in contract_boundary_from_bottom
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 848, in _contract_boundary_single
    canonize_fn(i, equalize_norms=equalize_norms)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 579, in canonize_row
    self.canonize_between((i, j), (i, j + 1), **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5110, in canonize_between
    self._canonize_between_tids(tid1, tid2, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5068, in _canonize_between_tids
    tensor_canonize_bond(Tl, Tr, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 897, in tensor_canonize_bond
    new_T1, tRfact = T1.split(left_env_ix, get='tensors', **split_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 815, in tensor_split
    left = reshape(left, (*left_dims, -1))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [0, 8, -1] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 632, in pair_energies_deterministic
    ex[site1,site2] = self.pair_energy_deterministic(config,peps,site1,site2,cache_bot,cache_top,sign_fn) * sign
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 606, in pair_energy_deterministic
    bot_term = self.get_bot_env(i,row,bot_term,config_new,cache_bot)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 224, in get_bot_env
    tn.contract_boundary_from_bottom_(xrange=(i-1,i),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1235, in contract_boundary_from_bottom
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 848, in _contract_boundary_single
    canonize_fn(i, equalize_norms=equalize_norms)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 579, in canonize_row
    self.canonize_between((i, j), (i, j + 1), **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5110, in canonize_between
    self._canonize_between_tids(tid1, tid2, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5068, in _canonize_between_tids
    tensor_canonize_bond(Tl, Tr, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 897, in tensor_canonize_bond
    new_T1, tRfact = T1.split(left_env_ix, get='tensors', **split_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 815, in tensor_split
    left = reshape(left, (*left_dims, -1))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [0, 8, -1] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 632, in pair_energies_deterministic
    ex[site1,site2] = self.pair_energy_deterministic(config,peps,site1,site2,cache_bot,cache_top,sign_fn) * sign
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 606, in pair_energy_deterministic
    bot_term = self.get_bot_env(i,row,bot_term,config_new,cache_bot)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 224, in get_bot_env
    tn.contract_boundary_from_bottom_(xrange=(i-1,i),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1235, in contract_boundary_from_bottom
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 857, in _contract_boundary_single
    compress_opts=compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 723, in compress_row
    cutoff=cutoff, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5038, in compress_between
    **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 4942, in _compress_between_tids
    tensor_compress_bond(ta, tb, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 967, in tensor_compress_bond
    get='tensors', method='qr')
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 816, in tensor_split
    right = reshape(right, (-1, *right_dims))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [-1, 0] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 632, in pair_energies_deterministic
    ex[site1,site2] = self.pair_energy_deterministic(config,peps,site1,site2,cache_bot,cache_top,sign_fn) * sign
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 606, in pair_energy_deterministic
    bot_term = self.get_bot_env(i,row,bot_term,config_new,cache_bot)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 224, in get_bot_env
    tn.contract_boundary_from_bottom_(xrange=(i-1,i),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1235, in contract_boundary_from_bottom
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 857, in _contract_boundary_single
    compress_opts=compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 723, in compress_row
    cutoff=cutoff, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5038, in compress_between
    **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 4942, in _compress_between_tids
    tensor_compress_bond(ta, tb, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 967, in tensor_compress_bond
    get='tensors', method='qr')
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 816, in tensor_split
    right = reshape(right, (-1, *right_dims))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [-1, 0] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 632, in pair_energies_deterministic
    ex[site1,site2] = self.pair_energy_deterministic(config,peps,site1,site2,cache_bot,cache_top,sign_fn) * sign
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 606, in pair_energy_deterministic
    bot_term = self.get_bot_env(i,row,bot_term,config_new,cache_bot)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 224, in get_bot_env
    tn.contract_boundary_from_bottom_(xrange=(i-1,i),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1235, in contract_boundary_from_bottom
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 848, in _contract_boundary_single
    canonize_fn(i, equalize_norms=equalize_norms)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 579, in canonize_row
    self.canonize_between((i, j), (i, j + 1), **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5110, in canonize_between
    self._canonize_between_tids(tid1, tid2, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5068, in _canonize_between_tids
    tensor_canonize_bond(Tl, Tr, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 897, in tensor_canonize_bond
    new_T1, tRfact = T1.split(left_env_ix, get='tensors', **split_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 815, in tensor_split
    left = reshape(left, (*left_dims, -1))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [0, 8, -1] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 632, in pair_energies_deterministic
    ex[site1,site2] = self.pair_energy_deterministic(config,peps,site1,site2,cache_bot,cache_top,sign_fn) * sign
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 606, in pair_energy_deterministic
    bot_term = self.get_bot_env(i,row,bot_term,config_new,cache_bot)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 224, in get_bot_env
    tn.contract_boundary_from_bottom_(xrange=(i-1,i),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1235, in contract_boundary_from_bottom
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 857, in _contract_boundary_single
    compress_opts=compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 723, in compress_row
    cutoff=cutoff, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5038, in compress_between
    **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 4942, in _compress_between_tids
    tensor_compress_bond(ta, tb, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 967, in tensor_compress_bond
    get='tensors', method='qr')
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 816, in tensor_split
    right = reshape(right, (-1, *right_dims))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [-1, 0] because the unspecified dimension size -1 can be any value and is ambiguous
/home/rppeng/code/quimb-refactor/quimb/tensor/decomp.py:214: UserWarning: TN SVD failed, trying again with alternate driver.
  warnings.warn("TN SVD failed, trying again with alternate driver.")
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 625, in pair_energies_deterministic
    env_bot,env_top = self.get_all_benvs(peps,config,cache_bot,cache_top)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 275, in get_all_benvs
    env_bot = self.get_all_bot_envs(peps,config,cache_bot,imax=imax)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 235, in get_all_bot_envs
    env_prev = self.get_bot_env(i,row,env_prev,config,cache_bot)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 224, in get_bot_env
    tn.contract_boundary_from_bottom_(xrange=(i-1,i),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1235, in contract_boundary_from_bottom
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 848, in _contract_boundary_single
    canonize_fn(i, equalize_norms=equalize_norms)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 579, in canonize_row
    self.canonize_between((i, j), (i, j + 1), **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5110, in canonize_between
    self._canonize_between_tids(tid1, tid2, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5068, in _canonize_between_tids
    tensor_canonize_bond(Tl, Tr, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 897, in tensor_canonize_bond
    new_T1, tRfact = T1.split(left_env_ix, get='tensors', **split_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 815, in tensor_split
    left = reshape(left, (*left_dims, -1))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [0, 8, -1] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 632, in pair_energies_deterministic
    ex[site1,site2] = self.pair_energy_deterministic(config,peps,site1,site2,cache_bot,cache_top,sign_fn) * sign
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 606, in pair_energy_deterministic
    bot_term = self.get_bot_env(i,row,bot_term,config_new,cache_bot)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 224, in get_bot_env
    tn.contract_boundary_from_bottom_(xrange=(i-1,i),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1235, in contract_boundary_from_bottom
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 848, in _contract_boundary_single
    canonize_fn(i, equalize_norms=equalize_norms)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 579, in canonize_row
    self.canonize_between((i, j), (i, j + 1), **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5110, in canonize_between
    self._canonize_between_tids(tid1, tid2, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5068, in _canonize_between_tids
    tensor_canonize_bond(Tl, Tr, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 897, in tensor_canonize_bond
    new_T1, tRfact = T1.split(left_env_ix, get='tensors', **split_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 815, in tensor_split
    left = reshape(left, (*left_dims, -1))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [0, 8, -1] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 632, in pair_energies_deterministic
    ex[site1,site2] = self.pair_energy_deterministic(config,peps,site1,site2,cache_bot,cache_top,sign_fn) * sign
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 606, in pair_energy_deterministic
    bot_term = self.get_bot_env(i,row,bot_term,config_new,cache_bot)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 224, in get_bot_env
    tn.contract_boundary_from_bottom_(xrange=(i-1,i),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1235, in contract_boundary_from_bottom
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 848, in _contract_boundary_single
    canonize_fn(i, equalize_norms=equalize_norms)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 579, in canonize_row
    self.canonize_between((i, j), (i, j + 1), **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5110, in canonize_between
    self._canonize_between_tids(tid1, tid2, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5068, in _canonize_between_tids
    tensor_canonize_bond(Tl, Tr, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 897, in tensor_canonize_bond
    new_T1, tRfact = T1.split(left_env_ix, get='tensors', **split_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 815, in tensor_split
    left = reshape(left, (*left_dims, -1))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [0, 8, -1] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 632, in pair_energies_deterministic
    ex[site1,site2] = self.pair_energy_deterministic(config,peps,site1,site2,cache_bot,cache_top,sign_fn) * sign
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 606, in pair_energy_deterministic
    bot_term = self.get_bot_env(i,row,bot_term,config_new,cache_bot)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 224, in get_bot_env
    tn.contract_boundary_from_bottom_(xrange=(i-1,i),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1235, in contract_boundary_from_bottom
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 848, in _contract_boundary_single
    canonize_fn(i, equalize_norms=equalize_norms)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 579, in canonize_row
    self.canonize_between((i, j), (i, j + 1), **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5110, in canonize_between
    self._canonize_between_tids(tid1, tid2, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5068, in _canonize_between_tids
    tensor_canonize_bond(Tl, Tr, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 897, in tensor_canonize_bond
    new_T1, tRfact = T1.split(left_env_ix, get='tensors', **split_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 815, in tensor_split
    left = reshape(left, (*left_dims, -1))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [0, 8, -1] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 625, in pair_energies_deterministic
    env_bot,env_top = self.get_all_benvs(peps,config,cache_bot,cache_top)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 278, in get_all_benvs
    env_top = self.get_all_top_envs(peps,config,cache_top,imin=imin)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 268, in get_all_top_envs
    env_prev = self.get_top_env(i,row,env_prev,config,cache_top)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 258, in get_top_env
    tn.contract_boundary_from_top_(xrange=(i,i+1),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1351, in contract_boundary_from_top
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 848, in _contract_boundary_single
    canonize_fn(i, equalize_norms=equalize_norms)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 583, in canonize_row
    self.canonize_between((i, j), (i, j - 1), **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5110, in canonize_between
    self._canonize_between_tids(tid1, tid2, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5068, in _canonize_between_tids
    tensor_canonize_bond(Tl, Tr, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 897, in tensor_canonize_bond
    new_T1, tRfact = T1.split(left_env_ix, get='tensors', **split_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 815, in tensor_split
    left = reshape(left, (*left_dims, -1))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [0, 8, -1] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 625, in pair_energies_deterministic
    env_bot,env_top = self.get_all_benvs(peps,config,cache_bot,cache_top)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 275, in get_all_benvs
    env_bot = self.get_all_bot_envs(peps,config,cache_bot,imax=imax)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 235, in get_all_bot_envs
    env_prev = self.get_bot_env(i,row,env_prev,config,cache_bot)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 224, in get_bot_env
    tn.contract_boundary_from_bottom_(xrange=(i-1,i),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1235, in contract_boundary_from_bottom
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 857, in _contract_boundary_single
    compress_opts=compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 723, in compress_row
    cutoff=cutoff, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5038, in compress_between
    **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 4942, in _compress_between_tids
    tensor_compress_bond(ta, tb, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 974, in tensor_compress_bond
    absorb=absorb, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 815, in tensor_split
    left = reshape(left, (*left_dims, -1))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [0, -1] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 625, in pair_energies_deterministic
    env_bot,env_top = self.get_all_benvs(peps,config,cache_bot,cache_top)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 275, in get_all_benvs
    env_bot = self.get_all_bot_envs(peps,config,cache_bot,imax=imax)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 235, in get_all_bot_envs
    env_prev = self.get_bot_env(i,row,env_prev,config,cache_bot)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 224, in get_bot_env
    tn.contract_boundary_from_bottom_(xrange=(i-1,i),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1235, in contract_boundary_from_bottom
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 848, in _contract_boundary_single
    canonize_fn(i, equalize_norms=equalize_norms)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 579, in canonize_row
    self.canonize_between((i, j), (i, j + 1), **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5110, in canonize_between
    self._canonize_between_tids(tid1, tid2, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5068, in _canonize_between_tids
    tensor_canonize_bond(Tl, Tr, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 897, in tensor_canonize_bond
    new_T1, tRfact = T1.split(left_env_ix, get='tensors', **split_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 815, in tensor_split
    left = reshape(left, (*left_dims, -1))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [0, 8, -1] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 632, in pair_energies_deterministic
    ex[site1,site2] = self.pair_energy_deterministic(config,peps,site1,site2,cache_bot,cache_top,sign_fn) * sign
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 606, in pair_energy_deterministic
    bot_term = self.get_bot_env(i,row,bot_term,config_new,cache_bot)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 224, in get_bot_env
    tn.contract_boundary_from_bottom_(xrange=(i-1,i),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1235, in contract_boundary_from_bottom
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 848, in _contract_boundary_single
    canonize_fn(i, equalize_norms=equalize_norms)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 579, in canonize_row
    self.canonize_between((i, j), (i, j + 1), **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5110, in canonize_between
    self._canonize_between_tids(tid1, tid2, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5068, in _canonize_between_tids
    tensor_canonize_bond(Tl, Tr, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 897, in tensor_canonize_bond
    new_T1, tRfact = T1.split(left_env_ix, get='tensors', **split_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 815, in tensor_split
    left = reshape(left, (*left_dims, -1))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [0, 8, -1] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 632, in pair_energies_deterministic
    ex[site1,site2] = self.pair_energy_deterministic(config,peps,site1,site2,cache_bot,cache_top,sign_fn) * sign
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 606, in pair_energy_deterministic
    bot_term = self.get_bot_env(i,row,bot_term,config_new,cache_bot)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 224, in get_bot_env
    tn.contract_boundary_from_bottom_(xrange=(i-1,i),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1235, in contract_boundary_from_bottom
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 857, in _contract_boundary_single
    compress_opts=compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 723, in compress_row
    cutoff=cutoff, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5038, in compress_between
    **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 4942, in _compress_between_tids
    tensor_compress_bond(ta, tb, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 974, in tensor_compress_bond
    absorb=absorb, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 815, in tensor_split
    left = reshape(left, (*left_dims, -1))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [0, -1] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 625, in pair_energies_deterministic
    env_bot,env_top = self.get_all_benvs(peps,config,cache_bot,cache_top)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 275, in get_all_benvs
    env_bot = self.get_all_bot_envs(peps,config,cache_bot,imax=imax)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 235, in get_all_bot_envs
    env_prev = self.get_bot_env(i,row,env_prev,config,cache_bot)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 224, in get_bot_env
    tn.contract_boundary_from_bottom_(xrange=(i-1,i),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1235, in contract_boundary_from_bottom
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 857, in _contract_boundary_single
    compress_opts=compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 723, in compress_row
    cutoff=cutoff, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5038, in compress_between
    **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 4942, in _compress_between_tids
    tensor_compress_bond(ta, tb, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 967, in tensor_compress_bond
    get='tensors', method='qr')
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 816, in tensor_split
    right = reshape(right, (-1, *right_dims))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [-1, 0] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 632, in pair_energies_deterministic
    ex[site1,site2] = self.pair_energy_deterministic(config,peps,site1,site2,cache_bot,cache_top,sign_fn) * sign
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 606, in pair_energy_deterministic
    bot_term = self.get_bot_env(i,row,bot_term,config_new,cache_bot)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 224, in get_bot_env
    tn.contract_boundary_from_bottom_(xrange=(i-1,i),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1235, in contract_boundary_from_bottom
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 848, in _contract_boundary_single
    canonize_fn(i, equalize_norms=equalize_norms)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 579, in canonize_row
    self.canonize_between((i, j), (i, j + 1), **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5110, in canonize_between
    self._canonize_between_tids(tid1, tid2, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5068, in _canonize_between_tids
    tensor_canonize_bond(Tl, Tr, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 897, in tensor_canonize_bond
    new_T1, tRfact = T1.split(left_env_ix, get='tensors', **split_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 815, in tensor_split
    left = reshape(left, (*left_dims, -1))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [0, 8, -1] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 625, in pair_energies_deterministic
    env_bot,env_top = self.get_all_benvs(peps,config,cache_bot,cache_top)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 278, in get_all_benvs
    env_top = self.get_all_top_envs(peps,config,cache_top,imin=imin)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 268, in get_all_top_envs
    env_prev = self.get_top_env(i,row,env_prev,config,cache_top)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 258, in get_top_env
    tn.contract_boundary_from_top_(xrange=(i,i+1),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1351, in contract_boundary_from_top
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 848, in _contract_boundary_single
    canonize_fn(i, equalize_norms=equalize_norms)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 583, in canonize_row
    self.canonize_between((i, j), (i, j - 1), **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5110, in canonize_between
    self._canonize_between_tids(tid1, tid2, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5068, in _canonize_between_tids
    tensor_canonize_bond(Tl, Tr, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 897, in tensor_canonize_bond
    new_T1, tRfact = T1.split(left_env_ix, get='tensors', **split_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 815, in tensor_split
    left = reshape(left, (*left_dims, -1))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [0, 8, -1] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 632, in pair_energies_deterministic
    ex[site1,site2] = self.pair_energy_deterministic(config,peps,site1,site2,cache_bot,cache_top,sign_fn) * sign
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 606, in pair_energy_deterministic
    bot_term = self.get_bot_env(i,row,bot_term,config_new,cache_bot)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 224, in get_bot_env
    tn.contract_boundary_from_bottom_(xrange=(i-1,i),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1235, in contract_boundary_from_bottom
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 848, in _contract_boundary_single
    canonize_fn(i, equalize_norms=equalize_norms)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 579, in canonize_row
    self.canonize_between((i, j), (i, j + 1), **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5110, in canonize_between
    self._canonize_between_tids(tid1, tid2, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5068, in _canonize_between_tids
    tensor_canonize_bond(Tl, Tr, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 897, in tensor_canonize_bond
    new_T1, tRfact = T1.split(left_env_ix, get='tensors', **split_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 815, in tensor_split
    left = reshape(left, (*left_dims, -1))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [0, 8, -1] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 632, in pair_energies_deterministic
    ex[site1,site2] = self.pair_energy_deterministic(config,peps,site1,site2,cache_bot,cache_top,sign_fn) * sign
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 606, in pair_energy_deterministic
    bot_term = self.get_bot_env(i,row,bot_term,config_new,cache_bot)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 224, in get_bot_env
    tn.contract_boundary_from_bottom_(xrange=(i-1,i),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1235, in contract_boundary_from_bottom
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 857, in _contract_boundary_single
    compress_opts=compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 723, in compress_row
    cutoff=cutoff, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5038, in compress_between
    **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 4942, in _compress_between_tids
    tensor_compress_bond(ta, tb, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 967, in tensor_compress_bond
    get='tensors', method='qr')
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 816, in tensor_split
    right = reshape(right, (-1, *right_dims))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [-1, 0] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 625, in pair_energies_deterministic
    env_bot,env_top = self.get_all_benvs(peps,config,cache_bot,cache_top)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 275, in get_all_benvs
    env_bot = self.get_all_bot_envs(peps,config,cache_bot,imax=imax)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 235, in get_all_bot_envs
    env_prev = self.get_bot_env(i,row,env_prev,config,cache_bot)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 224, in get_bot_env
    tn.contract_boundary_from_bottom_(xrange=(i-1,i),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1235, in contract_boundary_from_bottom
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 848, in _contract_boundary_single
    canonize_fn(i, equalize_norms=equalize_norms)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 579, in canonize_row
    self.canonize_between((i, j), (i, j + 1), **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5110, in canonize_between
    self._canonize_between_tids(tid1, tid2, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5068, in _canonize_between_tids
    tensor_canonize_bond(Tl, Tr, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 897, in tensor_canonize_bond
    new_T1, tRfact = T1.split(left_env_ix, get='tensors', **split_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 815, in tensor_split
    left = reshape(left, (*left_dims, -1))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [0, 8, -1] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 632, in pair_energies_deterministic
    ex[site1,site2] = self.pair_energy_deterministic(config,peps,site1,site2,cache_bot,cache_top,sign_fn) * sign
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 606, in pair_energy_deterministic
    bot_term = self.get_bot_env(i,row,bot_term,config_new,cache_bot)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 224, in get_bot_env
    tn.contract_boundary_from_bottom_(xrange=(i-1,i),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1235, in contract_boundary_from_bottom
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 857, in _contract_boundary_single
    compress_opts=compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 723, in compress_row
    cutoff=cutoff, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5038, in compress_between
    **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 4942, in _compress_between_tids
    tensor_compress_bond(ta, tb, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 967, in tensor_compress_bond
    get='tensors', method='qr')
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 816, in tensor_split
    right = reshape(right, (-1, *right_dims))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [-1, 0] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 632, in pair_energies_deterministic
    ex[site1,site2] = self.pair_energy_deterministic(config,peps,site1,site2,cache_bot,cache_top,sign_fn) * sign
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 606, in pair_energy_deterministic
    bot_term = self.get_bot_env(i,row,bot_term,config_new,cache_bot)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 224, in get_bot_env
    tn.contract_boundary_from_bottom_(xrange=(i-1,i),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1235, in contract_boundary_from_bottom
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 848, in _contract_boundary_single
    canonize_fn(i, equalize_norms=equalize_norms)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 579, in canonize_row
    self.canonize_between((i, j), (i, j + 1), **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5110, in canonize_between
    self._canonize_between_tids(tid1, tid2, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5068, in _canonize_between_tids
    tensor_canonize_bond(Tl, Tr, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 897, in tensor_canonize_bond
    new_T1, tRfact = T1.split(left_env_ix, get='tensors', **split_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 815, in tensor_split
    left = reshape(left, (*left_dims, -1))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [0, 8, -1] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 632, in pair_energies_deterministic
    ex[site1,site2] = self.pair_energy_deterministic(config,peps,site1,site2,cache_bot,cache_top,sign_fn) * sign
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 606, in pair_energy_deterministic
    bot_term = self.get_bot_env(i,row,bot_term,config_new,cache_bot)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 224, in get_bot_env
    tn.contract_boundary_from_bottom_(xrange=(i-1,i),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1235, in contract_boundary_from_bottom
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 848, in _contract_boundary_single
    canonize_fn(i, equalize_norms=equalize_norms)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 579, in canonize_row
    self.canonize_between((i, j), (i, j + 1), **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5110, in canonize_between
    self._canonize_between_tids(tid1, tid2, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5068, in _canonize_between_tids
    tensor_canonize_bond(Tl, Tr, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 897, in tensor_canonize_bond
    new_T1, tRfact = T1.split(left_env_ix, get='tensors', **split_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 815, in tensor_split
    left = reshape(left, (*left_dims, -1))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [0, 8, -1] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 632, in pair_energies_deterministic
    ex[site1,site2] = self.pair_energy_deterministic(config,peps,site1,site2,cache_bot,cache_top,sign_fn) * sign
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 606, in pair_energy_deterministic
    bot_term = self.get_bot_env(i,row,bot_term,config_new,cache_bot)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 224, in get_bot_env
    tn.contract_boundary_from_bottom_(xrange=(i-1,i),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1235, in contract_boundary_from_bottom
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 857, in _contract_boundary_single
    compress_opts=compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 723, in compress_row
    cutoff=cutoff, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5038, in compress_between
    **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 4942, in _compress_between_tids
    tensor_compress_bond(ta, tb, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 974, in tensor_compress_bond
    absorb=absorb, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 815, in tensor_split
    left = reshape(left, (*left_dims, -1))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [0, -1] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 625, in pair_energies_deterministic
    env_bot,env_top = self.get_all_benvs(peps,config,cache_bot,cache_top)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 275, in get_all_benvs
    env_bot = self.get_all_bot_envs(peps,config,cache_bot,imax=imax)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 235, in get_all_bot_envs
    env_prev = self.get_bot_env(i,row,env_prev,config,cache_bot)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 224, in get_bot_env
    tn.contract_boundary_from_bottom_(xrange=(i-1,i),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1235, in contract_boundary_from_bottom
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 857, in _contract_boundary_single
    compress_opts=compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 723, in compress_row
    cutoff=cutoff, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5038, in compress_between
    **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 4942, in _compress_between_tids
    tensor_compress_bond(ta, tb, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 974, in tensor_compress_bond
    absorb=absorb, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 815, in tensor_split
    left = reshape(left, (*left_dims, -1))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [0, -1] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 625, in pair_energies_deterministic
    env_bot,env_top = self.get_all_benvs(peps,config,cache_bot,cache_top)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 275, in get_all_benvs
    env_bot = self.get_all_bot_envs(peps,config,cache_bot,imax=imax)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 235, in get_all_bot_envs
    env_prev = self.get_bot_env(i,row,env_prev,config,cache_bot)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 224, in get_bot_env
    tn.contract_boundary_from_bottom_(xrange=(i-1,i),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1235, in contract_boundary_from_bottom
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 848, in _contract_boundary_single
    canonize_fn(i, equalize_norms=equalize_norms)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 579, in canonize_row
    self.canonize_between((i, j), (i, j + 1), **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5110, in canonize_between
    self._canonize_between_tids(tid1, tid2, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5068, in _canonize_between_tids
    tensor_canonize_bond(Tl, Tr, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 897, in tensor_canonize_bond
    new_T1, tRfact = T1.split(left_env_ix, get='tensors', **split_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 815, in tensor_split
    left = reshape(left, (*left_dims, -1))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [0, 8, -1] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 632, in pair_energies_deterministic
    ex[site1,site2] = self.pair_energy_deterministic(config,peps,site1,site2,cache_bot,cache_top,sign_fn) * sign
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 606, in pair_energy_deterministic
    bot_term = self.get_bot_env(i,row,bot_term,config_new,cache_bot)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 224, in get_bot_env
    tn.contract_boundary_from_bottom_(xrange=(i-1,i),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1235, in contract_boundary_from_bottom
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 857, in _contract_boundary_single
    compress_opts=compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 723, in compress_row
    cutoff=cutoff, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5038, in compress_between
    **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 4942, in _compress_between_tids
    tensor_compress_bond(ta, tb, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 967, in tensor_compress_bond
    get='tensors', method='qr')
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 816, in tensor_split
    right = reshape(right, (-1, *right_dims))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [-1, 0] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 632, in pair_energies_deterministic
    ex[site1,site2] = self.pair_energy_deterministic(config,peps,site1,site2,cache_bot,cache_top,sign_fn) * sign
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 606, in pair_energy_deterministic
    bot_term = self.get_bot_env(i,row,bot_term,config_new,cache_bot)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 224, in get_bot_env
    tn.contract_boundary_from_bottom_(xrange=(i-1,i),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1235, in contract_boundary_from_bottom
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 848, in _contract_boundary_single
    canonize_fn(i, equalize_norms=equalize_norms)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 579, in canonize_row
    self.canonize_between((i, j), (i, j + 1), **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5110, in canonize_between
    self._canonize_between_tids(tid1, tid2, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5068, in _canonize_between_tids
    tensor_canonize_bond(Tl, Tr, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 897, in tensor_canonize_bond
    new_T1, tRfact = T1.split(left_env_ix, get='tensors', **split_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 815, in tensor_split
    left = reshape(left, (*left_dims, -1))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [0, 8, -1] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 625, in pair_energies_deterministic
    env_bot,env_top = self.get_all_benvs(peps,config,cache_bot,cache_top)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 275, in get_all_benvs
    env_bot = self.get_all_bot_envs(peps,config,cache_bot,imax=imax)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 235, in get_all_bot_envs
    env_prev = self.get_bot_env(i,row,env_prev,config,cache_bot)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 224, in get_bot_env
    tn.contract_boundary_from_bottom_(xrange=(i-1,i),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1235, in contract_boundary_from_bottom
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 848, in _contract_boundary_single
    canonize_fn(i, equalize_norms=equalize_norms)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 579, in canonize_row
    self.canonize_between((i, j), (i, j + 1), **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5110, in canonize_between
    self._canonize_between_tids(tid1, tid2, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5068, in _canonize_between_tids
    tensor_canonize_bond(Tl, Tr, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 897, in tensor_canonize_bond
    new_T1, tRfact = T1.split(left_env_ix, get='tensors', **split_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 815, in tensor_split
    left = reshape(left, (*left_dims, -1))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [0, 8, -1] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 632, in pair_energies_deterministic
    ex[site1,site2] = self.pair_energy_deterministic(config,peps,site1,site2,cache_bot,cache_top,sign_fn) * sign
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 606, in pair_energy_deterministic
    bot_term = self.get_bot_env(i,row,bot_term,config_new,cache_bot)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 224, in get_bot_env
    tn.contract_boundary_from_bottom_(xrange=(i-1,i),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1235, in contract_boundary_from_bottom
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 857, in _contract_boundary_single
    compress_opts=compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 723, in compress_row
    cutoff=cutoff, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5038, in compress_between
    **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 4942, in _compress_between_tids
    tensor_compress_bond(ta, tb, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 967, in tensor_compress_bond
    get='tensors', method='qr')
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 816, in tensor_split
    right = reshape(right, (-1, *right_dims))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [-1, 0] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 625, in pair_energies_deterministic
    env_bot,env_top = self.get_all_benvs(peps,config,cache_bot,cache_top)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 275, in get_all_benvs
    env_bot = self.get_all_bot_envs(peps,config,cache_bot,imax=imax)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 235, in get_all_bot_envs
    env_prev = self.get_bot_env(i,row,env_prev,config,cache_bot)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 224, in get_bot_env
    tn.contract_boundary_from_bottom_(xrange=(i-1,i),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1235, in contract_boundary_from_bottom
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 848, in _contract_boundary_single
    canonize_fn(i, equalize_norms=equalize_norms)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 579, in canonize_row
    self.canonize_between((i, j), (i, j + 1), **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5110, in canonize_between
    self._canonize_between_tids(tid1, tid2, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5068, in _canonize_between_tids
    tensor_canonize_bond(Tl, Tr, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 897, in tensor_canonize_bond
    new_T1, tRfact = T1.split(left_env_ix, get='tensors', **split_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 815, in tensor_split
    left = reshape(left, (*left_dims, -1))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [0, 8, -1] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 632, in pair_energies_deterministic
    ex[site1,site2] = self.pair_energy_deterministic(config,peps,site1,site2,cache_bot,cache_top,sign_fn) * sign
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 606, in pair_energy_deterministic
    bot_term = self.get_bot_env(i,row,bot_term,config_new,cache_bot)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 224, in get_bot_env
    tn.contract_boundary_from_bottom_(xrange=(i-1,i),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1235, in contract_boundary_from_bottom
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 848, in _contract_boundary_single
    canonize_fn(i, equalize_norms=equalize_norms)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 579, in canonize_row
    self.canonize_between((i, j), (i, j + 1), **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5110, in canonize_between
    self._canonize_between_tids(tid1, tid2, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5068, in _canonize_between_tids
    tensor_canonize_bond(Tl, Tr, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 897, in tensor_canonize_bond
    new_T1, tRfact = T1.split(left_env_ix, get='tensors', **split_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 815, in tensor_split
    left = reshape(left, (*left_dims, -1))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [0, 8, -1] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 625, in pair_energies_deterministic
    env_bot,env_top = self.get_all_benvs(peps,config,cache_bot,cache_top)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 278, in get_all_benvs
    env_top = self.get_all_top_envs(peps,config,cache_top,imin=imin)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 268, in get_all_top_envs
    env_prev = self.get_top_env(i,row,env_prev,config,cache_top)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 258, in get_top_env
    tn.contract_boundary_from_top_(xrange=(i,i+1),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1351, in contract_boundary_from_top
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 848, in _contract_boundary_single
    canonize_fn(i, equalize_norms=equalize_norms)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 583, in canonize_row
    self.canonize_between((i, j), (i, j - 1), **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5110, in canonize_between
    self._canonize_between_tids(tid1, tid2, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5068, in _canonize_between_tids
    tensor_canonize_bond(Tl, Tr, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 897, in tensor_canonize_bond
    new_T1, tRfact = T1.split(left_env_ix, get='tensors', **split_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 815, in tensor_split
    left = reshape(left, (*left_dims, -1))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [0, 8, -1] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 632, in pair_energies_deterministic
    ex[site1,site2] = self.pair_energy_deterministic(config,peps,site1,site2,cache_bot,cache_top,sign_fn) * sign
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 606, in pair_energy_deterministic
    bot_term = self.get_bot_env(i,row,bot_term,config_new,cache_bot)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 224, in get_bot_env
    tn.contract_boundary_from_bottom_(xrange=(i-1,i),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1235, in contract_boundary_from_bottom
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 848, in _contract_boundary_single
    canonize_fn(i, equalize_norms=equalize_norms)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 579, in canonize_row
    self.canonize_between((i, j), (i, j + 1), **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5110, in canonize_between
    self._canonize_between_tids(tid1, tid2, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5068, in _canonize_between_tids
    tensor_canonize_bond(Tl, Tr, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 897, in tensor_canonize_bond
    new_T1, tRfact = T1.split(left_env_ix, get='tensors', **split_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 815, in tensor_split
    left = reshape(left, (*left_dims, -1))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [0, 8, -1] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 632, in pair_energies_deterministic
    ex[site1,site2] = self.pair_energy_deterministic(config,peps,site1,site2,cache_bot,cache_top,sign_fn) * sign
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 606, in pair_energy_deterministic
    bot_term = self.get_bot_env(i,row,bot_term,config_new,cache_bot)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 224, in get_bot_env
    tn.contract_boundary_from_bottom_(xrange=(i-1,i),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1235, in contract_boundary_from_bottom
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 848, in _contract_boundary_single
    canonize_fn(i, equalize_norms=equalize_norms)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 579, in canonize_row
    self.canonize_between((i, j), (i, j + 1), **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5110, in canonize_between
    self._canonize_between_tids(tid1, tid2, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5068, in _canonize_between_tids
    tensor_canonize_bond(Tl, Tr, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 897, in tensor_canonize_bond
    new_T1, tRfact = T1.split(left_env_ix, get='tensors', **split_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 815, in tensor_split
    left = reshape(left, (*left_dims, -1))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [0, 8, -1] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 632, in pair_energies_deterministic
    ex[site1,site2] = self.pair_energy_deterministic(config,peps,site1,site2,cache_bot,cache_top,sign_fn) * sign
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 606, in pair_energy_deterministic
    bot_term = self.get_bot_env(i,row,bot_term,config_new,cache_bot)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 224, in get_bot_env
    tn.contract_boundary_from_bottom_(xrange=(i-1,i),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1235, in contract_boundary_from_bottom
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 857, in _contract_boundary_single
    compress_opts=compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 723, in compress_row
    cutoff=cutoff, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5038, in compress_between
    **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 4942, in _compress_between_tids
    tensor_compress_bond(ta, tb, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 967, in tensor_compress_bond
    get='tensors', method='qr')
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 816, in tensor_split
    right = reshape(right, (-1, *right_dims))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [-1, 0] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 625, in pair_energies_deterministic
    env_bot,env_top = self.get_all_benvs(peps,config,cache_bot,cache_top)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 278, in get_all_benvs
    env_top = self.get_all_top_envs(peps,config,cache_top,imin=imin)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 268, in get_all_top_envs
    env_prev = self.get_top_env(i,row,env_prev,config,cache_top)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 258, in get_top_env
    tn.contract_boundary_from_top_(xrange=(i,i+1),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1351, in contract_boundary_from_top
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 857, in _contract_boundary_single
    compress_opts=compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 719, in compress_row
    cutoff=cutoff, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5038, in compress_between
    **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 4942, in _compress_between_tids
    tensor_compress_bond(ta, tb, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 967, in tensor_compress_bond
    get='tensors', method='qr')
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 816, in tensor_split
    right = reshape(right, (-1, *right_dims))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [-1, 0] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 632, in pair_energies_deterministic
    ex[site1,site2] = self.pair_energy_deterministic(config,peps,site1,site2,cache_bot,cache_top,sign_fn) * sign
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 606, in pair_energy_deterministic
    bot_term = self.get_bot_env(i,row,bot_term,config_new,cache_bot)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 224, in get_bot_env
    tn.contract_boundary_from_bottom_(xrange=(i-1,i),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1235, in contract_boundary_from_bottom
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 857, in _contract_boundary_single
    compress_opts=compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 723, in compress_row
    cutoff=cutoff, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5038, in compress_between
    **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 4942, in _compress_between_tids
    tensor_compress_bond(ta, tb, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 967, in tensor_compress_bond
    get='tensors', method='qr')
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 816, in tensor_split
    right = reshape(right, (-1, *right_dims))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [-1, 0] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 625, in pair_energies_deterministic
    env_bot,env_top = self.get_all_benvs(peps,config,cache_bot,cache_top)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 278, in get_all_benvs
    env_top = self.get_all_top_envs(peps,config,cache_top,imin=imin)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 268, in get_all_top_envs
    env_prev = self.get_top_env(i,row,env_prev,config,cache_top)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 258, in get_top_env
    tn.contract_boundary_from_top_(xrange=(i,i+1),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1351, in contract_boundary_from_top
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 848, in _contract_boundary_single
    canonize_fn(i, equalize_norms=equalize_norms)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 583, in canonize_row
    self.canonize_between((i, j), (i, j - 1), **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5110, in canonize_between
    self._canonize_between_tids(tid1, tid2, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5068, in _canonize_between_tids
    tensor_canonize_bond(Tl, Tr, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 897, in tensor_canonize_bond
    new_T1, tRfact = T1.split(left_env_ix, get='tensors', **split_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 815, in tensor_split
    left = reshape(left, (*left_dims, -1))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [0, 8, -1] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 632, in pair_energies_deterministic
    ex[site1,site2] = self.pair_energy_deterministic(config,peps,site1,site2,cache_bot,cache_top,sign_fn) * sign
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 606, in pair_energy_deterministic
    bot_term = self.get_bot_env(i,row,bot_term,config_new,cache_bot)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 224, in get_bot_env
    tn.contract_boundary_from_bottom_(xrange=(i-1,i),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1235, in contract_boundary_from_bottom
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 848, in _contract_boundary_single
    canonize_fn(i, equalize_norms=equalize_norms)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 579, in canonize_row
    self.canonize_between((i, j), (i, j + 1), **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5110, in canonize_between
    self._canonize_between_tids(tid1, tid2, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5068, in _canonize_between_tids
    tensor_canonize_bond(Tl, Tr, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 897, in tensor_canonize_bond
    new_T1, tRfact = T1.split(left_env_ix, get='tensors', **split_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 815, in tensor_split
    left = reshape(left, (*left_dims, -1))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [0, 8, -1] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 625, in pair_energies_deterministic
    env_bot,env_top = self.get_all_benvs(peps,config,cache_bot,cache_top)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 278, in get_all_benvs
    env_top = self.get_all_top_envs(peps,config,cache_top,imin=imin)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 268, in get_all_top_envs
    env_prev = self.get_top_env(i,row,env_prev,config,cache_top)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 258, in get_top_env
    tn.contract_boundary_from_top_(xrange=(i,i+1),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1351, in contract_boundary_from_top
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 848, in _contract_boundary_single
    canonize_fn(i, equalize_norms=equalize_norms)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 583, in canonize_row
    self.canonize_between((i, j), (i, j - 1), **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5110, in canonize_between
    self._canonize_between_tids(tid1, tid2, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5068, in _canonize_between_tids
    tensor_canonize_bond(Tl, Tr, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 897, in tensor_canonize_bond
    new_T1, tRfact = T1.split(left_env_ix, get='tensors', **split_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 815, in tensor_split
    left = reshape(left, (*left_dims, -1))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [0, 8, -1] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 625, in pair_energies_deterministic
    env_bot,env_top = self.get_all_benvs(peps,config,cache_bot,cache_top)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 275, in get_all_benvs
    env_bot = self.get_all_bot_envs(peps,config,cache_bot,imax=imax)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 235, in get_all_bot_envs
    env_prev = self.get_bot_env(i,row,env_prev,config,cache_bot)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 224, in get_bot_env
    tn.contract_boundary_from_bottom_(xrange=(i-1,i),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1235, in contract_boundary_from_bottom
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 848, in _contract_boundary_single
    canonize_fn(i, equalize_norms=equalize_norms)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 579, in canonize_row
    self.canonize_between((i, j), (i, j + 1), **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5110, in canonize_between
    self._canonize_between_tids(tid1, tid2, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5068, in _canonize_between_tids
    tensor_canonize_bond(Tl, Tr, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 897, in tensor_canonize_bond
    new_T1, tRfact = T1.split(left_env_ix, get='tensors', **split_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 815, in tensor_split
    left = reshape(left, (*left_dims, -1))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [0, 8, -1] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 632, in pair_energies_deterministic
    ex[site1,site2] = self.pair_energy_deterministic(config,peps,site1,site2,cache_bot,cache_top,sign_fn) * sign
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 606, in pair_energy_deterministic
    bot_term = self.get_bot_env(i,row,bot_term,config_new,cache_bot)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 224, in get_bot_env
    tn.contract_boundary_from_bottom_(xrange=(i-1,i),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1235, in contract_boundary_from_bottom
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 848, in _contract_boundary_single
    canonize_fn(i, equalize_norms=equalize_norms)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 579, in canonize_row
    self.canonize_between((i, j), (i, j + 1), **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5110, in canonize_between
    self._canonize_between_tids(tid1, tid2, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5068, in _canonize_between_tids
    tensor_canonize_bond(Tl, Tr, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 897, in tensor_canonize_bond
    new_T1, tRfact = T1.split(left_env_ix, get='tensors', **split_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 815, in tensor_split
    left = reshape(left, (*left_dims, -1))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [0, 8, -1] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 632, in pair_energies_deterministic
    ex[site1,site2] = self.pair_energy_deterministic(config,peps,site1,site2,cache_bot,cache_top,sign_fn) * sign
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 606, in pair_energy_deterministic
    bot_term = self.get_bot_env(i,row,bot_term,config_new,cache_bot)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 224, in get_bot_env
    tn.contract_boundary_from_bottom_(xrange=(i-1,i),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1235, in contract_boundary_from_bottom
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 848, in _contract_boundary_single
    canonize_fn(i, equalize_norms=equalize_norms)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 579, in canonize_row
    self.canonize_between((i, j), (i, j + 1), **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5110, in canonize_between
    self._canonize_between_tids(tid1, tid2, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5068, in _canonize_between_tids
    tensor_canonize_bond(Tl, Tr, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 897, in tensor_canonize_bond
    new_T1, tRfact = T1.split(left_env_ix, get='tensors', **split_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 815, in tensor_split
    left = reshape(left, (*left_dims, -1))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [0, 8, -1] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 632, in pair_energies_deterministic
    ex[site1,site2] = self.pair_energy_deterministic(config,peps,site1,site2,cache_bot,cache_top,sign_fn) * sign
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 606, in pair_energy_deterministic
    bot_term = self.get_bot_env(i,row,bot_term,config_new,cache_bot)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 224, in get_bot_env
    tn.contract_boundary_from_bottom_(xrange=(i-1,i),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1235, in contract_boundary_from_bottom
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 848, in _contract_boundary_single
    canonize_fn(i, equalize_norms=equalize_norms)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 579, in canonize_row
    self.canonize_between((i, j), (i, j + 1), **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5110, in canonize_between
    self._canonize_between_tids(tid1, tid2, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5068, in _canonize_between_tids
    tensor_canonize_bond(Tl, Tr, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 897, in tensor_canonize_bond
    new_T1, tRfact = T1.split(left_env_ix, get='tensors', **split_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 815, in tensor_split
    left = reshape(left, (*left_dims, -1))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [0, 8, -1] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 632, in pair_energies_deterministic
    ex[site1,site2] = self.pair_energy_deterministic(config,peps,site1,site2,cache_bot,cache_top,sign_fn) * sign
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 606, in pair_energy_deterministic
    bot_term = self.get_bot_env(i,row,bot_term,config_new,cache_bot)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 224, in get_bot_env
    tn.contract_boundary_from_bottom_(xrange=(i-1,i),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1235, in contract_boundary_from_bottom
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 848, in _contract_boundary_single
    canonize_fn(i, equalize_norms=equalize_norms)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 579, in canonize_row
    self.canonize_between((i, j), (i, j + 1), **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5110, in canonize_between
    self._canonize_between_tids(tid1, tid2, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5068, in _canonize_between_tids
    tensor_canonize_bond(Tl, Tr, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 897, in tensor_canonize_bond
    new_T1, tRfact = T1.split(left_env_ix, get='tensors', **split_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 815, in tensor_split
    left = reshape(left, (*left_dims, -1))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [0, 8, -1] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 632, in pair_energies_deterministic
    ex[site1,site2] = self.pair_energy_deterministic(config,peps,site1,site2,cache_bot,cache_top,sign_fn) * sign
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 606, in pair_energy_deterministic
    bot_term = self.get_bot_env(i,row,bot_term,config_new,cache_bot)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 224, in get_bot_env
    tn.contract_boundary_from_bottom_(xrange=(i-1,i),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1235, in contract_boundary_from_bottom
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 857, in _contract_boundary_single
    compress_opts=compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 723, in compress_row
    cutoff=cutoff, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5038, in compress_between
    **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 4942, in _compress_between_tids
    tensor_compress_bond(ta, tb, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 974, in tensor_compress_bond
    absorb=absorb, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 815, in tensor_split
    left = reshape(left, (*left_dims, -1))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [0, -1] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 625, in pair_energies_deterministic
    env_bot,env_top = self.get_all_benvs(peps,config,cache_bot,cache_top)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 275, in get_all_benvs
    env_bot = self.get_all_bot_envs(peps,config,cache_bot,imax=imax)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 235, in get_all_bot_envs
    env_prev = self.get_bot_env(i,row,env_prev,config,cache_bot)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 224, in get_bot_env
    tn.contract_boundary_from_bottom_(xrange=(i-1,i),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1235, in contract_boundary_from_bottom
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 848, in _contract_boundary_single
    canonize_fn(i, equalize_norms=equalize_norms)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 579, in canonize_row
    self.canonize_between((i, j), (i, j + 1), **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5110, in canonize_between
    self._canonize_between_tids(tid1, tid2, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5068, in _canonize_between_tids
    tensor_canonize_bond(Tl, Tr, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 897, in tensor_canonize_bond
    new_T1, tRfact = T1.split(left_env_ix, get='tensors', **split_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 815, in tensor_split
    left = reshape(left, (*left_dims, -1))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [0, 8, -1] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 632, in pair_energies_deterministic
    ex[site1,site2] = self.pair_energy_deterministic(config,peps,site1,site2,cache_bot,cache_top,sign_fn) * sign
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 606, in pair_energy_deterministic
    bot_term = self.get_bot_env(i,row,bot_term,config_new,cache_bot)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 224, in get_bot_env
    tn.contract_boundary_from_bottom_(xrange=(i-1,i),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1235, in contract_boundary_from_bottom
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 857, in _contract_boundary_single
    compress_opts=compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 723, in compress_row
    cutoff=cutoff, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5038, in compress_between
    **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 4942, in _compress_between_tids
    tensor_compress_bond(ta, tb, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 967, in tensor_compress_bond
    get='tensors', method='qr')
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 816, in tensor_split
    right = reshape(right, (-1, *right_dims))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [-1, 0] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 625, in pair_energies_deterministic
    env_bot,env_top = self.get_all_benvs(peps,config,cache_bot,cache_top)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 278, in get_all_benvs
    env_top = self.get_all_top_envs(peps,config,cache_top,imin=imin)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 268, in get_all_top_envs
    env_prev = self.get_top_env(i,row,env_prev,config,cache_top)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 258, in get_top_env
    tn.contract_boundary_from_top_(xrange=(i,i+1),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1351, in contract_boundary_from_top
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 857, in _contract_boundary_single
    compress_opts=compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 719, in compress_row
    cutoff=cutoff, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5038, in compress_between
    **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 4942, in _compress_between_tids
    tensor_compress_bond(ta, tb, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 967, in tensor_compress_bond
    get='tensors', method='qr')
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 816, in tensor_split
    right = reshape(right, (-1, *right_dims))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [-1, 0] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 625, in pair_energies_deterministic
    env_bot,env_top = self.get_all_benvs(peps,config,cache_bot,cache_top)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 275, in get_all_benvs
    env_bot = self.get_all_bot_envs(peps,config,cache_bot,imax=imax)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 235, in get_all_bot_envs
    env_prev = self.get_bot_env(i,row,env_prev,config,cache_bot)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 224, in get_bot_env
    tn.contract_boundary_from_bottom_(xrange=(i-1,i),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1235, in contract_boundary_from_bottom
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 848, in _contract_boundary_single
    canonize_fn(i, equalize_norms=equalize_norms)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 579, in canonize_row
    self.canonize_between((i, j), (i, j + 1), **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5110, in canonize_between
    self._canonize_between_tids(tid1, tid2, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5068, in _canonize_between_tids
    tensor_canonize_bond(Tl, Tr, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 897, in tensor_canonize_bond
    new_T1, tRfact = T1.split(left_env_ix, get='tensors', **split_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 815, in tensor_split
    left = reshape(left, (*left_dims, -1))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [0, 8, -1] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 625, in pair_energies_deterministic
    env_bot,env_top = self.get_all_benvs(peps,config,cache_bot,cache_top)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 278, in get_all_benvs
    env_top = self.get_all_top_envs(peps,config,cache_top,imin=imin)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 268, in get_all_top_envs
    env_prev = self.get_top_env(i,row,env_prev,config,cache_top)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 258, in get_top_env
    tn.contract_boundary_from_top_(xrange=(i,i+1),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1351, in contract_boundary_from_top
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 848, in _contract_boundary_single
    canonize_fn(i, equalize_norms=equalize_norms)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 583, in canonize_row
    self.canonize_between((i, j), (i, j - 1), **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5110, in canonize_between
    self._canonize_between_tids(tid1, tid2, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5068, in _canonize_between_tids
    tensor_canonize_bond(Tl, Tr, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 897, in tensor_canonize_bond
    new_T1, tRfact = T1.split(left_env_ix, get='tensors', **split_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 815, in tensor_split
    left = reshape(left, (*left_dims, -1))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [0, 8, -1] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 632, in pair_energies_deterministic
    ex[site1,site2] = self.pair_energy_deterministic(config,peps,site1,site2,cache_bot,cache_top,sign_fn) * sign
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 606, in pair_energy_deterministic
    bot_term = self.get_bot_env(i,row,bot_term,config_new,cache_bot)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 224, in get_bot_env
    tn.contract_boundary_from_bottom_(xrange=(i-1,i),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1235, in contract_boundary_from_bottom
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 848, in _contract_boundary_single
    canonize_fn(i, equalize_norms=equalize_norms)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 579, in canonize_row
    self.canonize_between((i, j), (i, j + 1), **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5110, in canonize_between
    self._canonize_between_tids(tid1, tid2, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5068, in _canonize_between_tids
    tensor_canonize_bond(Tl, Tr, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 897, in tensor_canonize_bond
    new_T1, tRfact = T1.split(left_env_ix, get='tensors', **split_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 815, in tensor_split
    left = reshape(left, (*left_dims, -1))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [0, 8, -1] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 632, in pair_energies_deterministic
    ex[site1,site2] = self.pair_energy_deterministic(config,peps,site1,site2,cache_bot,cache_top,sign_fn) * sign
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 606, in pair_energy_deterministic
    bot_term = self.get_bot_env(i,row,bot_term,config_new,cache_bot)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 224, in get_bot_env
    tn.contract_boundary_from_bottom_(xrange=(i-1,i),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1235, in contract_boundary_from_bottom
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 848, in _contract_boundary_single
    canonize_fn(i, equalize_norms=equalize_norms)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 579, in canonize_row
    self.canonize_between((i, j), (i, j + 1), **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5110, in canonize_between
    self._canonize_between_tids(tid1, tid2, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5068, in _canonize_between_tids
    tensor_canonize_bond(Tl, Tr, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 897, in tensor_canonize_bond
    new_T1, tRfact = T1.split(left_env_ix, get='tensors', **split_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 815, in tensor_split
    left = reshape(left, (*left_dims, -1))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [0, 8, -1] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 625, in pair_energies_deterministic
    env_bot,env_top = self.get_all_benvs(peps,config,cache_bot,cache_top)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 275, in get_all_benvs
    env_bot = self.get_all_bot_envs(peps,config,cache_bot,imax=imax)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 235, in get_all_bot_envs
    env_prev = self.get_bot_env(i,row,env_prev,config,cache_bot)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 224, in get_bot_env
    tn.contract_boundary_from_bottom_(xrange=(i-1,i),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1235, in contract_boundary_from_bottom
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 848, in _contract_boundary_single
    canonize_fn(i, equalize_norms=equalize_norms)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 579, in canonize_row
    self.canonize_between((i, j), (i, j + 1), **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5110, in canonize_between
    self._canonize_between_tids(tid1, tid2, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5068, in _canonize_between_tids
    tensor_canonize_bond(Tl, Tr, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 897, in tensor_canonize_bond
    new_T1, tRfact = T1.split(left_env_ix, get='tensors', **split_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 815, in tensor_split
    left = reshape(left, (*left_dims, -1))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [0, 8, -1] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 625, in pair_energies_deterministic
    env_bot,env_top = self.get_all_benvs(peps,config,cache_bot,cache_top)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 278, in get_all_benvs
    env_top = self.get_all_top_envs(peps,config,cache_top,imin=imin)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 268, in get_all_top_envs
    env_prev = self.get_top_env(i,row,env_prev,config,cache_top)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 258, in get_top_env
    tn.contract_boundary_from_top_(xrange=(i,i+1),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1351, in contract_boundary_from_top
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 857, in _contract_boundary_single
    compress_opts=compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 719, in compress_row
    cutoff=cutoff, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5038, in compress_between
    **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 4942, in _compress_between_tids
    tensor_compress_bond(ta, tb, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 974, in tensor_compress_bond
    absorb=absorb, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 815, in tensor_split
    left = reshape(left, (*left_dims, -1))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [0, -1] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 632, in pair_energies_deterministic
    ex[site1,site2] = self.pair_energy_deterministic(config,peps,site1,site2,cache_bot,cache_top,sign_fn) * sign
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 606, in pair_energy_deterministic
    bot_term = self.get_bot_env(i,row,bot_term,config_new,cache_bot)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 224, in get_bot_env
    tn.contract_boundary_from_bottom_(xrange=(i-1,i),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1235, in contract_boundary_from_bottom
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 857, in _contract_boundary_single
    compress_opts=compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 723, in compress_row
    cutoff=cutoff, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5038, in compress_between
    **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 4942, in _compress_between_tids
    tensor_compress_bond(ta, tb, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 967, in tensor_compress_bond
    get='tensors', method='qr')
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 816, in tensor_split
    right = reshape(right, (-1, *right_dims))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [-1, 0] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 625, in pair_energies_deterministic
    env_bot,env_top = self.get_all_benvs(peps,config,cache_bot,cache_top)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 275, in get_all_benvs
    env_bot = self.get_all_bot_envs(peps,config,cache_bot,imax=imax)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 235, in get_all_bot_envs
    env_prev = self.get_bot_env(i,row,env_prev,config,cache_bot)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 224, in get_bot_env
    tn.contract_boundary_from_bottom_(xrange=(i-1,i),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1235, in contract_boundary_from_bottom
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 848, in _contract_boundary_single
    canonize_fn(i, equalize_norms=equalize_norms)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 579, in canonize_row
    self.canonize_between((i, j), (i, j + 1), **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5110, in canonize_between
    self._canonize_between_tids(tid1, tid2, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5068, in _canonize_between_tids
    tensor_canonize_bond(Tl, Tr, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 897, in tensor_canonize_bond
    new_T1, tRfact = T1.split(left_env_ix, get='tensors', **split_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 815, in tensor_split
    left = reshape(left, (*left_dims, -1))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [0, 8, -1] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 632, in pair_energies_deterministic
    ex[site1,site2] = self.pair_energy_deterministic(config,peps,site1,site2,cache_bot,cache_top,sign_fn) * sign
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 606, in pair_energy_deterministic
    bot_term = self.get_bot_env(i,row,bot_term,config_new,cache_bot)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 224, in get_bot_env
    tn.contract_boundary_from_bottom_(xrange=(i-1,i),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1235, in contract_boundary_from_bottom
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 848, in _contract_boundary_single
    canonize_fn(i, equalize_norms=equalize_norms)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 579, in canonize_row
    self.canonize_between((i, j), (i, j + 1), **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5110, in canonize_between
    self._canonize_between_tids(tid1, tid2, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5068, in _canonize_between_tids
    tensor_canonize_bond(Tl, Tr, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 897, in tensor_canonize_bond
    new_T1, tRfact = T1.split(left_env_ix, get='tensors', **split_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 815, in tensor_split
    left = reshape(left, (*left_dims, -1))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [0, 8, -1] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 632, in pair_energies_deterministic
    ex[site1,site2] = self.pair_energy_deterministic(config,peps,site1,site2,cache_bot,cache_top,sign_fn) * sign
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 606, in pair_energy_deterministic
    bot_term = self.get_bot_env(i,row,bot_term,config_new,cache_bot)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 224, in get_bot_env
    tn.contract_boundary_from_bottom_(xrange=(i-1,i),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1235, in contract_boundary_from_bottom
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 848, in _contract_boundary_single
    canonize_fn(i, equalize_norms=equalize_norms)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 579, in canonize_row
    self.canonize_between((i, j), (i, j + 1), **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5110, in canonize_between
    self._canonize_between_tids(tid1, tid2, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5068, in _canonize_between_tids
    tensor_canonize_bond(Tl, Tr, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 897, in tensor_canonize_bond
    new_T1, tRfact = T1.split(left_env_ix, get='tensors', **split_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 815, in tensor_split
    left = reshape(left, (*left_dims, -1))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [0, 8, -1] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 632, in pair_energies_deterministic
    ex[site1,site2] = self.pair_energy_deterministic(config,peps,site1,site2,cache_bot,cache_top,sign_fn) * sign
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 606, in pair_energy_deterministic
    bot_term = self.get_bot_env(i,row,bot_term,config_new,cache_bot)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 224, in get_bot_env
    tn.contract_boundary_from_bottom_(xrange=(i-1,i),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1235, in contract_boundary_from_bottom
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 857, in _contract_boundary_single
    compress_opts=compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 723, in compress_row
    cutoff=cutoff, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5038, in compress_between
    **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 4942, in _compress_between_tids
    tensor_compress_bond(ta, tb, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 967, in tensor_compress_bond
    get='tensors', method='qr')
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 816, in tensor_split
    right = reshape(right, (-1, *right_dims))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [-1, 0] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 625, in pair_energies_deterministic
    env_bot,env_top = self.get_all_benvs(peps,config,cache_bot,cache_top)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 275, in get_all_benvs
    env_bot = self.get_all_bot_envs(peps,config,cache_bot,imax=imax)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 235, in get_all_bot_envs
    env_prev = self.get_bot_env(i,row,env_prev,config,cache_bot)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 224, in get_bot_env
    tn.contract_boundary_from_bottom_(xrange=(i-1,i),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1235, in contract_boundary_from_bottom
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 848, in _contract_boundary_single
    canonize_fn(i, equalize_norms=equalize_norms)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 579, in canonize_row
    self.canonize_between((i, j), (i, j + 1), **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5110, in canonize_between
    self._canonize_between_tids(tid1, tid2, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5068, in _canonize_between_tids
    tensor_canonize_bond(Tl, Tr, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 897, in tensor_canonize_bond
    new_T1, tRfact = T1.split(left_env_ix, get='tensors', **split_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 815, in tensor_split
    left = reshape(left, (*left_dims, -1))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [0, 8, -1] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 632, in pair_energies_deterministic
    ex[site1,site2] = self.pair_energy_deterministic(config,peps,site1,site2,cache_bot,cache_top,sign_fn) * sign
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 606, in pair_energy_deterministic
    bot_term = self.get_bot_env(i,row,bot_term,config_new,cache_bot)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 224, in get_bot_env
    tn.contract_boundary_from_bottom_(xrange=(i-1,i),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1235, in contract_boundary_from_bottom
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 848, in _contract_boundary_single
    canonize_fn(i, equalize_norms=equalize_norms)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 579, in canonize_row
    self.canonize_between((i, j), (i, j + 1), **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5110, in canonize_between
    self._canonize_between_tids(tid1, tid2, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5068, in _canonize_between_tids
    tensor_canonize_bond(Tl, Tr, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 897, in tensor_canonize_bond
    new_T1, tRfact = T1.split(left_env_ix, get='tensors', **split_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 815, in tensor_split
    left = reshape(left, (*left_dims, -1))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [0, 8, -1] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 632, in pair_energies_deterministic
    ex[site1,site2] = self.pair_energy_deterministic(config,peps,site1,site2,cache_bot,cache_top,sign_fn) * sign
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 613, in pair_energy_deterministic
    top_term = self.get_top_env(i,row,top_term,config_new,cache_top)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 258, in get_top_env
    tn.contract_boundary_from_top_(xrange=(i,i+1),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1351, in contract_boundary_from_top
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 857, in _contract_boundary_single
    compress_opts=compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 719, in compress_row
    cutoff=cutoff, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5038, in compress_between
    **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 4942, in _compress_between_tids
    tensor_compress_bond(ta, tb, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 974, in tensor_compress_bond
    absorb=absorb, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 815, in tensor_split
    left = reshape(left, (*left_dims, -1))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [0, -1] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 632, in pair_energies_deterministic
    ex[site1,site2] = self.pair_energy_deterministic(config,peps,site1,site2,cache_bot,cache_top,sign_fn) * sign
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 606, in pair_energy_deterministic
    bot_term = self.get_bot_env(i,row,bot_term,config_new,cache_bot)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 224, in get_bot_env
    tn.contract_boundary_from_bottom_(xrange=(i-1,i),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1235, in contract_boundary_from_bottom
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 848, in _contract_boundary_single
    canonize_fn(i, equalize_norms=equalize_norms)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 579, in canonize_row
    self.canonize_between((i, j), (i, j + 1), **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5110, in canonize_between
    self._canonize_between_tids(tid1, tid2, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5068, in _canonize_between_tids
    tensor_canonize_bond(Tl, Tr, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 897, in tensor_canonize_bond
    new_T1, tRfact = T1.split(left_env_ix, get='tensors', **split_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 815, in tensor_split
    left = reshape(left, (*left_dims, -1))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [0, 8, -1] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 632, in pair_energies_deterministic
    ex[site1,site2] = self.pair_energy_deterministic(config,peps,site1,site2,cache_bot,cache_top,sign_fn) * sign
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 606, in pair_energy_deterministic
    bot_term = self.get_bot_env(i,row,bot_term,config_new,cache_bot)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 224, in get_bot_env
    tn.contract_boundary_from_bottom_(xrange=(i-1,i),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1235, in contract_boundary_from_bottom
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 848, in _contract_boundary_single
    canonize_fn(i, equalize_norms=equalize_norms)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 579, in canonize_row
    self.canonize_between((i, j), (i, j + 1), **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5110, in canonize_between
    self._canonize_between_tids(tid1, tid2, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5068, in _canonize_between_tids
    tensor_canonize_bond(Tl, Tr, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 897, in tensor_canonize_bond
    new_T1, tRfact = T1.split(left_env_ix, get='tensors', **split_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 815, in tensor_split
    left = reshape(left, (*left_dims, -1))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [0, 8, -1] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 632, in pair_energies_deterministic
    ex[site1,site2] = self.pair_energy_deterministic(config,peps,site1,site2,cache_bot,cache_top,sign_fn) * sign
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 606, in pair_energy_deterministic
    bot_term = self.get_bot_env(i,row,bot_term,config_new,cache_bot)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 224, in get_bot_env
    tn.contract_boundary_from_bottom_(xrange=(i-1,i),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1235, in contract_boundary_from_bottom
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 848, in _contract_boundary_single
    canonize_fn(i, equalize_norms=equalize_norms)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 579, in canonize_row
    self.canonize_between((i, j), (i, j + 1), **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5110, in canonize_between
    self._canonize_between_tids(tid1, tid2, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5068, in _canonize_between_tids
    tensor_canonize_bond(Tl, Tr, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 897, in tensor_canonize_bond
    new_T1, tRfact = T1.split(left_env_ix, get='tensors', **split_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 815, in tensor_split
    left = reshape(left, (*left_dims, -1))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [0, 8, -1] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 632, in pair_energies_deterministic
    ex[site1,site2] = self.pair_energy_deterministic(config,peps,site1,site2,cache_bot,cache_top,sign_fn) * sign
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 606, in pair_energy_deterministic
    bot_term = self.get_bot_env(i,row,bot_term,config_new,cache_bot)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 224, in get_bot_env
    tn.contract_boundary_from_bottom_(xrange=(i-1,i),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1235, in contract_boundary_from_bottom
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 848, in _contract_boundary_single
    canonize_fn(i, equalize_norms=equalize_norms)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 579, in canonize_row
    self.canonize_between((i, j), (i, j + 1), **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5110, in canonize_between
    self._canonize_between_tids(tid1, tid2, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5068, in _canonize_between_tids
    tensor_canonize_bond(Tl, Tr, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 897, in tensor_canonize_bond
    new_T1, tRfact = T1.split(left_env_ix, get='tensors', **split_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 815, in tensor_split
    left = reshape(left, (*left_dims, -1))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [0, 8, -1] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 632, in pair_energies_deterministic
    ex[site1,site2] = self.pair_energy_deterministic(config,peps,site1,site2,cache_bot,cache_top,sign_fn) * sign
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 606, in pair_energy_deterministic
    bot_term = self.get_bot_env(i,row,bot_term,config_new,cache_bot)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 224, in get_bot_env
    tn.contract_boundary_from_bottom_(xrange=(i-1,i),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1235, in contract_boundary_from_bottom
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 848, in _contract_boundary_single
    canonize_fn(i, equalize_norms=equalize_norms)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 579, in canonize_row
    self.canonize_between((i, j), (i, j + 1), **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5110, in canonize_between
    self._canonize_between_tids(tid1, tid2, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5068, in _canonize_between_tids
    tensor_canonize_bond(Tl, Tr, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 897, in tensor_canonize_bond
    new_T1, tRfact = T1.split(left_env_ix, get='tensors', **split_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 815, in tensor_split
    left = reshape(left, (*left_dims, -1))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [0, 8, -1] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 632, in pair_energies_deterministic
    ex[site1,site2] = self.pair_energy_deterministic(config,peps,site1,site2,cache_bot,cache_top,sign_fn) * sign
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 606, in pair_energy_deterministic
    bot_term = self.get_bot_env(i,row,bot_term,config_new,cache_bot)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 224, in get_bot_env
    tn.contract_boundary_from_bottom_(xrange=(i-1,i),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1235, in contract_boundary_from_bottom
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 848, in _contract_boundary_single
    canonize_fn(i, equalize_norms=equalize_norms)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 579, in canonize_row
    self.canonize_between((i, j), (i, j + 1), **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5110, in canonize_between
    self._canonize_between_tids(tid1, tid2, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5068, in _canonize_between_tids
    tensor_canonize_bond(Tl, Tr, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 897, in tensor_canonize_bond
    new_T1, tRfact = T1.split(left_env_ix, get='tensors', **split_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 815, in tensor_split
    left = reshape(left, (*left_dims, -1))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [0, 8, -1] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 625, in pair_energies_deterministic
    env_bot,env_top = self.get_all_benvs(peps,config,cache_bot,cache_top)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 275, in get_all_benvs
    env_bot = self.get_all_bot_envs(peps,config,cache_bot,imax=imax)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 235, in get_all_bot_envs
    env_prev = self.get_bot_env(i,row,env_prev,config,cache_bot)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 224, in get_bot_env
    tn.contract_boundary_from_bottom_(xrange=(i-1,i),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1235, in contract_boundary_from_bottom
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 848, in _contract_boundary_single
    canonize_fn(i, equalize_norms=equalize_norms)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 579, in canonize_row
    self.canonize_between((i, j), (i, j + 1), **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5110, in canonize_between
    self._canonize_between_tids(tid1, tid2, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5068, in _canonize_between_tids
    tensor_canonize_bond(Tl, Tr, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 897, in tensor_canonize_bond
    new_T1, tRfact = T1.split(left_env_ix, get='tensors', **split_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 815, in tensor_split
    left = reshape(left, (*left_dims, -1))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [0, 8, -1] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 632, in pair_energies_deterministic
    ex[site1,site2] = self.pair_energy_deterministic(config,peps,site1,site2,cache_bot,cache_top,sign_fn) * sign
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 606, in pair_energy_deterministic
    bot_term = self.get_bot_env(i,row,bot_term,config_new,cache_bot)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 224, in get_bot_env
    tn.contract_boundary_from_bottom_(xrange=(i-1,i),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1235, in contract_boundary_from_bottom
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 857, in _contract_boundary_single
    compress_opts=compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 723, in compress_row
    cutoff=cutoff, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5038, in compress_between
    **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 4942, in _compress_between_tids
    tensor_compress_bond(ta, tb, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 967, in tensor_compress_bond
    get='tensors', method='qr')
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 816, in tensor_split
    right = reshape(right, (-1, *right_dims))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [-1, 0] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 625, in pair_energies_deterministic
    env_bot,env_top = self.get_all_benvs(peps,config,cache_bot,cache_top)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 278, in get_all_benvs
    env_top = self.get_all_top_envs(peps,config,cache_top,imin=imin)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 268, in get_all_top_envs
    env_prev = self.get_top_env(i,row,env_prev,config,cache_top)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 258, in get_top_env
    tn.contract_boundary_from_top_(xrange=(i,i+1),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1351, in contract_boundary_from_top
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 848, in _contract_boundary_single
    canonize_fn(i, equalize_norms=equalize_norms)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 583, in canonize_row
    self.canonize_between((i, j), (i, j - 1), **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5110, in canonize_between
    self._canonize_between_tids(tid1, tid2, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5068, in _canonize_between_tids
    tensor_canonize_bond(Tl, Tr, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 897, in tensor_canonize_bond
    new_T1, tRfact = T1.split(left_env_ix, get='tensors', **split_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 815, in tensor_split
    left = reshape(left, (*left_dims, -1))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [0, 8, -1] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 632, in pair_energies_deterministic
    ex[site1,site2] = self.pair_energy_deterministic(config,peps,site1,site2,cache_bot,cache_top,sign_fn) * sign
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 606, in pair_energy_deterministic
    bot_term = self.get_bot_env(i,row,bot_term,config_new,cache_bot)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 224, in get_bot_env
    tn.contract_boundary_from_bottom_(xrange=(i-1,i),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1235, in contract_boundary_from_bottom
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 848, in _contract_boundary_single
    canonize_fn(i, equalize_norms=equalize_norms)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 579, in canonize_row
    self.canonize_between((i, j), (i, j + 1), **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5110, in canonize_between
    self._canonize_between_tids(tid1, tid2, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5068, in _canonize_between_tids
    tensor_canonize_bond(Tl, Tr, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 897, in tensor_canonize_bond
    new_T1, tRfact = T1.split(left_env_ix, get='tensors', **split_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 815, in tensor_split
    left = reshape(left, (*left_dims, -1))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [0, 8, -1] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 632, in pair_energies_deterministic
    ex[site1,site2] = self.pair_energy_deterministic(config,peps,site1,site2,cache_bot,cache_top,sign_fn) * sign
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 606, in pair_energy_deterministic
    bot_term = self.get_bot_env(i,row,bot_term,config_new,cache_bot)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 224, in get_bot_env
    tn.contract_boundary_from_bottom_(xrange=(i-1,i),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1235, in contract_boundary_from_bottom
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 857, in _contract_boundary_single
    compress_opts=compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 723, in compress_row
    cutoff=cutoff, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5038, in compress_between
    **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 4942, in _compress_between_tids
    tensor_compress_bond(ta, tb, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 967, in tensor_compress_bond
    get='tensors', method='qr')
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 816, in tensor_split
    right = reshape(right, (-1, *right_dims))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [-1, 0] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 632, in pair_energies_deterministic
    ex[site1,site2] = self.pair_energy_deterministic(config,peps,site1,site2,cache_bot,cache_top,sign_fn) * sign
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 606, in pair_energy_deterministic
    bot_term = self.get_bot_env(i,row,bot_term,config_new,cache_bot)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 224, in get_bot_env
    tn.contract_boundary_from_bottom_(xrange=(i-1,i),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1235, in contract_boundary_from_bottom
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 857, in _contract_boundary_single
    compress_opts=compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 723, in compress_row
    cutoff=cutoff, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5038, in compress_between
    **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 4942, in _compress_between_tids
    tensor_compress_bond(ta, tb, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 974, in tensor_compress_bond
    absorb=absorb, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 815, in tensor_split
    left = reshape(left, (*left_dims, -1))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [0, -1] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 632, in pair_energies_deterministic
    ex[site1,site2] = self.pair_energy_deterministic(config,peps,site1,site2,cache_bot,cache_top,sign_fn) * sign
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 606, in pair_energy_deterministic
    bot_term = self.get_bot_env(i,row,bot_term,config_new,cache_bot)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 224, in get_bot_env
    tn.contract_boundary_from_bottom_(xrange=(i-1,i),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1235, in contract_boundary_from_bottom
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 857, in _contract_boundary_single
    compress_opts=compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 723, in compress_row
    cutoff=cutoff, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5038, in compress_between
    **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 4942, in _compress_between_tids
    tensor_compress_bond(ta, tb, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 967, in tensor_compress_bond
    get='tensors', method='qr')
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 816, in tensor_split
    right = reshape(right, (-1, *right_dims))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [-1, 0] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 632, in pair_energies_deterministic
    ex[site1,site2] = self.pair_energy_deterministic(config,peps,site1,site2,cache_bot,cache_top,sign_fn) * sign
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 613, in pair_energy_deterministic
    top_term = self.get_top_env(i,row,top_term,config_new,cache_top)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 258, in get_top_env
    tn.contract_boundary_from_top_(xrange=(i,i+1),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1351, in contract_boundary_from_top
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 857, in _contract_boundary_single
    compress_opts=compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 719, in compress_row
    cutoff=cutoff, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5038, in compress_between
    **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 4942, in _compress_between_tids
    tensor_compress_bond(ta, tb, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 974, in tensor_compress_bond
    absorb=absorb, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 815, in tensor_split
    left = reshape(left, (*left_dims, -1))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [0, -1] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 632, in pair_energies_deterministic
    ex[site1,site2] = self.pair_energy_deterministic(config,peps,site1,site2,cache_bot,cache_top,sign_fn) * sign
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 613, in pair_energy_deterministic
    top_term = self.get_top_env(i,row,top_term,config_new,cache_top)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 258, in get_top_env
    tn.contract_boundary_from_top_(xrange=(i,i+1),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1351, in contract_boundary_from_top
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 857, in _contract_boundary_single
    compress_opts=compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 719, in compress_row
    cutoff=cutoff, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5038, in compress_between
    **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 4942, in _compress_between_tids
    tensor_compress_bond(ta, tb, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 974, in tensor_compress_bond
    absorb=absorb, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 815, in tensor_split
    left = reshape(left, (*left_dims, -1))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [0, -1] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 632, in pair_energies_deterministic
    ex[site1,site2] = self.pair_energy_deterministic(config,peps,site1,site2,cache_bot,cache_top,sign_fn) * sign
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 606, in pair_energy_deterministic
    bot_term = self.get_bot_env(i,row,bot_term,config_new,cache_bot)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 224, in get_bot_env
    tn.contract_boundary_from_bottom_(xrange=(i-1,i),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1235, in contract_boundary_from_bottom
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 848, in _contract_boundary_single
    canonize_fn(i, equalize_norms=equalize_norms)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 579, in canonize_row
    self.canonize_between((i, j), (i, j + 1), **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5110, in canonize_between
    self._canonize_between_tids(tid1, tid2, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5068, in _canonize_between_tids
    tensor_canonize_bond(Tl, Tr, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 897, in tensor_canonize_bond
    new_T1, tRfact = T1.split(left_env_ix, get='tensors', **split_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 815, in tensor_split
    left = reshape(left, (*left_dims, -1))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [0, 8, -1] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 632, in pair_energies_deterministic
    ex[site1,site2] = self.pair_energy_deterministic(config,peps,site1,site2,cache_bot,cache_top,sign_fn) * sign
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 606, in pair_energy_deterministic
    bot_term = self.get_bot_env(i,row,bot_term,config_new,cache_bot)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 224, in get_bot_env
    tn.contract_boundary_from_bottom_(xrange=(i-1,i),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1235, in contract_boundary_from_bottom
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 848, in _contract_boundary_single
    canonize_fn(i, equalize_norms=equalize_norms)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 579, in canonize_row
    self.canonize_between((i, j), (i, j + 1), **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5110, in canonize_between
    self._canonize_between_tids(tid1, tid2, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5068, in _canonize_between_tids
    tensor_canonize_bond(Tl, Tr, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 897, in tensor_canonize_bond
    new_T1, tRfact = T1.split(left_env_ix, get='tensors', **split_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 815, in tensor_split
    left = reshape(left, (*left_dims, -1))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [0, 8, -1] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 632, in pair_energies_deterministic
    ex[site1,site2] = self.pair_energy_deterministic(config,peps,site1,site2,cache_bot,cache_top,sign_fn) * sign
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 613, in pair_energy_deterministic
    top_term = self.get_top_env(i,row,top_term,config_new,cache_top)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 258, in get_top_env
    tn.contract_boundary_from_top_(xrange=(i,i+1),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1351, in contract_boundary_from_top
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 848, in _contract_boundary_single
    canonize_fn(i, equalize_norms=equalize_norms)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 583, in canonize_row
    self.canonize_between((i, j), (i, j - 1), **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5110, in canonize_between
    self._canonize_between_tids(tid1, tid2, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5068, in _canonize_between_tids
    tensor_canonize_bond(Tl, Tr, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 897, in tensor_canonize_bond
    new_T1, tRfact = T1.split(left_env_ix, get='tensors', **split_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 815, in tensor_split
    left = reshape(left, (*left_dims, -1))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [0, 8, -1] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 632, in pair_energies_deterministic
    ex[site1,site2] = self.pair_energy_deterministic(config,peps,site1,site2,cache_bot,cache_top,sign_fn) * sign
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 606, in pair_energy_deterministic
    bot_term = self.get_bot_env(i,row,bot_term,config_new,cache_bot)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 224, in get_bot_env
    tn.contract_boundary_from_bottom_(xrange=(i-1,i),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1235, in contract_boundary_from_bottom
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 848, in _contract_boundary_single
    canonize_fn(i, equalize_norms=equalize_norms)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 579, in canonize_row
    self.canonize_between((i, j), (i, j + 1), **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5110, in canonize_between
    self._canonize_between_tids(tid1, tid2, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5068, in _canonize_between_tids
    tensor_canonize_bond(Tl, Tr, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 897, in tensor_canonize_bond
    new_T1, tRfact = T1.split(left_env_ix, get='tensors', **split_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 815, in tensor_split
    left = reshape(left, (*left_dims, -1))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [0, 8, -1] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 632, in pair_energies_deterministic
    ex[site1,site2] = self.pair_energy_deterministic(config,peps,site1,site2,cache_bot,cache_top,sign_fn) * sign
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 606, in pair_energy_deterministic
    bot_term = self.get_bot_env(i,row,bot_term,config_new,cache_bot)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 224, in get_bot_env
    tn.contract_boundary_from_bottom_(xrange=(i-1,i),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1235, in contract_boundary_from_bottom
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 857, in _contract_boundary_single
    compress_opts=compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 723, in compress_row
    cutoff=cutoff, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5038, in compress_between
    **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 4942, in _compress_between_tids
    tensor_compress_bond(ta, tb, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 967, in tensor_compress_bond
    get='tensors', method='qr')
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 816, in tensor_split
    right = reshape(right, (-1, *right_dims))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [-1, 0] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 632, in pair_energies_deterministic
    ex[site1,site2] = self.pair_energy_deterministic(config,peps,site1,site2,cache_bot,cache_top,sign_fn) * sign
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 613, in pair_energy_deterministic
    top_term = self.get_top_env(i,row,top_term,config_new,cache_top)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 258, in get_top_env
    tn.contract_boundary_from_top_(xrange=(i,i+1),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1351, in contract_boundary_from_top
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 857, in _contract_boundary_single
    compress_opts=compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 719, in compress_row
    cutoff=cutoff, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5038, in compress_between
    **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 4942, in _compress_between_tids
    tensor_compress_bond(ta, tb, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 974, in tensor_compress_bond
    absorb=absorb, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 815, in tensor_split
    left = reshape(left, (*left_dims, -1))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [0, -1] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 632, in pair_energies_deterministic
    ex[site1,site2] = self.pair_energy_deterministic(config,peps,site1,site2,cache_bot,cache_top,sign_fn) * sign
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 606, in pair_energy_deterministic
    bot_term = self.get_bot_env(i,row,bot_term,config_new,cache_bot)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 224, in get_bot_env
    tn.contract_boundary_from_bottom_(xrange=(i-1,i),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1235, in contract_boundary_from_bottom
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 857, in _contract_boundary_single
    compress_opts=compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 723, in compress_row
    cutoff=cutoff, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5038, in compress_between
    **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 4942, in _compress_between_tids
    tensor_compress_bond(ta, tb, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 974, in tensor_compress_bond
    absorb=absorb, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 815, in tensor_split
    left = reshape(left, (*left_dims, -1))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [0, -1] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 632, in pair_energies_deterministic
    ex[site1,site2] = self.pair_energy_deterministic(config,peps,site1,site2,cache_bot,cache_top,sign_fn) * sign
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 613, in pair_energy_deterministic
    top_term = self.get_top_env(i,row,top_term,config_new,cache_top)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 258, in get_top_env
    tn.contract_boundary_from_top_(xrange=(i,i+1),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1351, in contract_boundary_from_top
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 857, in _contract_boundary_single
    compress_opts=compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 719, in compress_row
    cutoff=cutoff, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5038, in compress_between
    **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 4942, in _compress_between_tids
    tensor_compress_bond(ta, tb, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 974, in tensor_compress_bond
    absorb=absorb, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 815, in tensor_split
    left = reshape(left, (*left_dims, -1))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [0, -1] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 632, in pair_energies_deterministic
    ex[site1,site2] = self.pair_energy_deterministic(config,peps,site1,site2,cache_bot,cache_top,sign_fn) * sign
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 613, in pair_energy_deterministic
    top_term = self.get_top_env(i,row,top_term,config_new,cache_top)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 258, in get_top_env
    tn.contract_boundary_from_top_(xrange=(i,i+1),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1351, in contract_boundary_from_top
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 857, in _contract_boundary_single
    compress_opts=compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 719, in compress_row
    cutoff=cutoff, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5038, in compress_between
    **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 4942, in _compress_between_tids
    tensor_compress_bond(ta, tb, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 974, in tensor_compress_bond
    absorb=absorb, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 815, in tensor_split
    left = reshape(left, (*left_dims, -1))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [0, -1] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 632, in pair_energies_deterministic
    ex[site1,site2] = self.pair_energy_deterministic(config,peps,site1,site2,cache_bot,cache_top,sign_fn) * sign
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 613, in pair_energy_deterministic
    top_term = self.get_top_env(i,row,top_term,config_new,cache_top)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 258, in get_top_env
    tn.contract_boundary_from_top_(xrange=(i,i+1),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1351, in contract_boundary_from_top
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 857, in _contract_boundary_single
    compress_opts=compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 719, in compress_row
    cutoff=cutoff, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5038, in compress_between
    **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 4942, in _compress_between_tids
    tensor_compress_bond(ta, tb, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 967, in tensor_compress_bond
    get='tensors', method='qr')
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 816, in tensor_split
    right = reshape(right, (-1, *right_dims))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [-1, 0] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 632, in pair_energies_deterministic
    ex[site1,site2] = self.pair_energy_deterministic(config,peps,site1,site2,cache_bot,cache_top,sign_fn) * sign
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 613, in pair_energy_deterministic
    top_term = self.get_top_env(i,row,top_term,config_new,cache_top)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 258, in get_top_env
    tn.contract_boundary_from_top_(xrange=(i,i+1),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1351, in contract_boundary_from_top
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 848, in _contract_boundary_single
    canonize_fn(i, equalize_norms=equalize_norms)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 583, in canonize_row
    self.canonize_between((i, j), (i, j - 1), **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5110, in canonize_between
    self._canonize_between_tids(tid1, tid2, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5068, in _canonize_between_tids
    tensor_canonize_bond(Tl, Tr, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 897, in tensor_canonize_bond
    new_T1, tRfact = T1.split(left_env_ix, get='tensors', **split_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 815, in tensor_split
    left = reshape(left, (*left_dims, -1))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [0, 8, -1] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 632, in pair_energies_deterministic
    ex[site1,site2] = self.pair_energy_deterministic(config,peps,site1,site2,cache_bot,cache_top,sign_fn) * sign
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 613, in pair_energy_deterministic
    top_term = self.get_top_env(i,row,top_term,config_new,cache_top)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 258, in get_top_env
    tn.contract_boundary_from_top_(xrange=(i,i+1),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1351, in contract_boundary_from_top
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 857, in _contract_boundary_single
    compress_opts=compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 719, in compress_row
    cutoff=cutoff, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5038, in compress_between
    **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 4942, in _compress_between_tids
    tensor_compress_bond(ta, tb, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 974, in tensor_compress_bond
    absorb=absorb, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 815, in tensor_split
    left = reshape(left, (*left_dims, -1))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [0, -1] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 632, in pair_energies_deterministic
    ex[site1,site2] = self.pair_energy_deterministic(config,peps,site1,site2,cache_bot,cache_top,sign_fn) * sign
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 613, in pair_energy_deterministic
    top_term = self.get_top_env(i,row,top_term,config_new,cache_top)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 258, in get_top_env
    tn.contract_boundary_from_top_(xrange=(i,i+1),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1351, in contract_boundary_from_top
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 857, in _contract_boundary_single
    compress_opts=compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 719, in compress_row
    cutoff=cutoff, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5038, in compress_between
    **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 4942, in _compress_between_tids
    tensor_compress_bond(ta, tb, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 974, in tensor_compress_bond
    absorb=absorb, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 815, in tensor_split
    left = reshape(left, (*left_dims, -1))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [0, -1] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 632, in pair_energies_deterministic
    ex[site1,site2] = self.pair_energy_deterministic(config,peps,site1,site2,cache_bot,cache_top,sign_fn) * sign
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 613, in pair_energy_deterministic
    top_term = self.get_top_env(i,row,top_term,config_new,cache_top)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 258, in get_top_env
    tn.contract_boundary_from_top_(xrange=(i,i+1),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1351, in contract_boundary_from_top
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 857, in _contract_boundary_single
    compress_opts=compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 719, in compress_row
    cutoff=cutoff, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5038, in compress_between
    **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 4942, in _compress_between_tids
    tensor_compress_bond(ta, tb, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 974, in tensor_compress_bond
    absorb=absorb, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 815, in tensor_split
    left = reshape(left, (*left_dims, -1))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [0, -1] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 632, in pair_energies_deterministic
    ex[site1,site2] = self.pair_energy_deterministic(config,peps,site1,site2,cache_bot,cache_top,sign_fn) * sign
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 613, in pair_energy_deterministic
    top_term = self.get_top_env(i,row,top_term,config_new,cache_top)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 258, in get_top_env
    tn.contract_boundary_from_top_(xrange=(i,i+1),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1351, in contract_boundary_from_top
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 857, in _contract_boundary_single
    compress_opts=compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 719, in compress_row
    cutoff=cutoff, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5038, in compress_between
    **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 4942, in _compress_between_tids
    tensor_compress_bond(ta, tb, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 967, in tensor_compress_bond
    get='tensors', method='qr')
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 816, in tensor_split
    right = reshape(right, (-1, *right_dims))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [-1, 0] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 632, in pair_energies_deterministic
    ex[site1,site2] = self.pair_energy_deterministic(config,peps,site1,site2,cache_bot,cache_top,sign_fn) * sign
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 613, in pair_energy_deterministic
    top_term = self.get_top_env(i,row,top_term,config_new,cache_top)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 258, in get_top_env
    tn.contract_boundary_from_top_(xrange=(i,i+1),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1351, in contract_boundary_from_top
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 857, in _contract_boundary_single
    compress_opts=compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 719, in compress_row
    cutoff=cutoff, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5038, in compress_between
    **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 4942, in _compress_between_tids
    tensor_compress_bond(ta, tb, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 974, in tensor_compress_bond
    absorb=absorb, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 815, in tensor_split
    left = reshape(left, (*left_dims, -1))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [0, -1] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 632, in pair_energies_deterministic
    ex[site1,site2] = self.pair_energy_deterministic(config,peps,site1,site2,cache_bot,cache_top,sign_fn) * sign
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 613, in pair_energy_deterministic
    top_term = self.get_top_env(i,row,top_term,config_new,cache_top)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 258, in get_top_env
    tn.contract_boundary_from_top_(xrange=(i,i+1),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1351, in contract_boundary_from_top
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 857, in _contract_boundary_single
    compress_opts=compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 719, in compress_row
    cutoff=cutoff, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5038, in compress_between
    **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 4942, in _compress_between_tids
    tensor_compress_bond(ta, tb, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 974, in tensor_compress_bond
    absorb=absorb, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 815, in tensor_split
    left = reshape(left, (*left_dims, -1))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [0, -1] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 632, in pair_energies_deterministic
    ex[site1,site2] = self.pair_energy_deterministic(config,peps,site1,site2,cache_bot,cache_top,sign_fn) * sign
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 606, in pair_energy_deterministic
    bot_term = self.get_bot_env(i,row,bot_term,config_new,cache_bot)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 224, in get_bot_env
    tn.contract_boundary_from_bottom_(xrange=(i-1,i),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1235, in contract_boundary_from_bottom
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 857, in _contract_boundary_single
    compress_opts=compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 723, in compress_row
    cutoff=cutoff, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5038, in compress_between
    **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 4942, in _compress_between_tids
    tensor_compress_bond(ta, tb, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 974, in tensor_compress_bond
    absorb=absorb, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 815, in tensor_split
    left = reshape(left, (*left_dims, -1))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [0, -1] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 632, in pair_energies_deterministic
    ex[site1,site2] = self.pair_energy_deterministic(config,peps,site1,site2,cache_bot,cache_top,sign_fn) * sign
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 613, in pair_energy_deterministic
    top_term = self.get_top_env(i,row,top_term,config_new,cache_top)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 258, in get_top_env
    tn.contract_boundary_from_top_(xrange=(i,i+1),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1351, in contract_boundary_from_top
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 848, in _contract_boundary_single
    canonize_fn(i, equalize_norms=equalize_norms)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 583, in canonize_row
    self.canonize_between((i, j), (i, j - 1), **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5110, in canonize_between
    self._canonize_between_tids(tid1, tid2, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5068, in _canonize_between_tids
    tensor_canonize_bond(Tl, Tr, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 897, in tensor_canonize_bond
    new_T1, tRfact = T1.split(left_env_ix, get='tensors', **split_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 815, in tensor_split
    left = reshape(left, (*left_dims, -1))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [0, 8, -1] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 632, in pair_energies_deterministic
    ex[site1,site2] = self.pair_energy_deterministic(config,peps,site1,site2,cache_bot,cache_top,sign_fn) * sign
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 613, in pair_energy_deterministic
    top_term = self.get_top_env(i,row,top_term,config_new,cache_top)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 258, in get_top_env
    tn.contract_boundary_from_top_(xrange=(i,i+1),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1351, in contract_boundary_from_top
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 857, in _contract_boundary_single
    compress_opts=compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 719, in compress_row
    cutoff=cutoff, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5038, in compress_between
    **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 4942, in _compress_between_tids
    tensor_compress_bond(ta, tb, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 967, in tensor_compress_bond
    get='tensors', method='qr')
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 816, in tensor_split
    right = reshape(right, (-1, *right_dims))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [-1, 0] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 632, in pair_energies_deterministic
    ex[site1,site2] = self.pair_energy_deterministic(config,peps,site1,site2,cache_bot,cache_top,sign_fn) * sign
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 613, in pair_energy_deterministic
    top_term = self.get_top_env(i,row,top_term,config_new,cache_top)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 258, in get_top_env
    tn.contract_boundary_from_top_(xrange=(i,i+1),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1351, in contract_boundary_from_top
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 857, in _contract_boundary_single
    compress_opts=compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 719, in compress_row
    cutoff=cutoff, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5038, in compress_between
    **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 4942, in _compress_between_tids
    tensor_compress_bond(ta, tb, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 967, in tensor_compress_bond
    get='tensors', method='qr')
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 816, in tensor_split
    right = reshape(right, (-1, *right_dims))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [-1, 0] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 632, in pair_energies_deterministic
    ex[site1,site2] = self.pair_energy_deterministic(config,peps,site1,site2,cache_bot,cache_top,sign_fn) * sign
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 613, in pair_energy_deterministic
    top_term = self.get_top_env(i,row,top_term,config_new,cache_top)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 258, in get_top_env
    tn.contract_boundary_from_top_(xrange=(i,i+1),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1351, in contract_boundary_from_top
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 857, in _contract_boundary_single
    compress_opts=compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 719, in compress_row
    cutoff=cutoff, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5038, in compress_between
    **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 4942, in _compress_between_tids
    tensor_compress_bond(ta, tb, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 974, in tensor_compress_bond
    absorb=absorb, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 815, in tensor_split
    left = reshape(left, (*left_dims, -1))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [0, -1] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 632, in pair_energies_deterministic
    ex[site1,site2] = self.pair_energy_deterministic(config,peps,site1,site2,cache_bot,cache_top,sign_fn) * sign
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 606, in pair_energy_deterministic
    bot_term = self.get_bot_env(i,row,bot_term,config_new,cache_bot)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 224, in get_bot_env
    tn.contract_boundary_from_bottom_(xrange=(i-1,i),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1235, in contract_boundary_from_bottom
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 848, in _contract_boundary_single
    canonize_fn(i, equalize_norms=equalize_norms)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 579, in canonize_row
    self.canonize_between((i, j), (i, j + 1), **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5110, in canonize_between
    self._canonize_between_tids(tid1, tid2, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5068, in _canonize_between_tids
    tensor_canonize_bond(Tl, Tr, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 897, in tensor_canonize_bond
    new_T1, tRfact = T1.split(left_env_ix, get='tensors', **split_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 815, in tensor_split
    left = reshape(left, (*left_dims, -1))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [0, 8, -1] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 632, in pair_energies_deterministic
    ex[site1,site2] = self.pair_energy_deterministic(config,peps,site1,site2,cache_bot,cache_top,sign_fn) * sign
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 613, in pair_energy_deterministic
    top_term = self.get_top_env(i,row,top_term,config_new,cache_top)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 258, in get_top_env
    tn.contract_boundary_from_top_(xrange=(i,i+1),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1351, in contract_boundary_from_top
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 848, in _contract_boundary_single
    canonize_fn(i, equalize_norms=equalize_norms)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 583, in canonize_row
    self.canonize_between((i, j), (i, j - 1), **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5110, in canonize_between
    self._canonize_between_tids(tid1, tid2, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5068, in _canonize_between_tids
    tensor_canonize_bond(Tl, Tr, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 897, in tensor_canonize_bond
    new_T1, tRfact = T1.split(left_env_ix, get='tensors', **split_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 815, in tensor_split
    left = reshape(left, (*left_dims, -1))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [0, 8, -1] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 632, in pair_energies_deterministic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex[site1,site2] = self.pair_energy_deterministic(config,peps,site1,site2,cache_bot,cache_top,sign_fn) * sign
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 613, in pair_energy_deterministic
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 632, in pair_energies_deterministic
    top_term = self.get_top_env(i,row,top_term,config_new,cache_top)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 258, in get_top_env
    ex[site1,site2] = self.pair_energy_deterministic(config,peps,site1,site2,cache_bot,cache_top,sign_fn) * sign
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 613, in pair_energy_deterministic
    tn.contract_boundary_from_top_(xrange=(i,i+1),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1351, in contract_boundary_from_top
    top_term = self.get_top_env(i,row,top_term,config_new,cache_top)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 258, in get_top_env
    tn.contract_boundary_from_top_(xrange=(i,i+1),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1351, in contract_boundary_from_top
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 848, in _contract_boundary_single
    canonize_fn(i, equalize_norms=equalize_norms)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 583, in canonize_row
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 857, in _contract_boundary_single
    self.canonize_between((i, j), (i, j - 1), **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5110, in canonize_between
    compress_opts=compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 719, in compress_row
    cutoff=cutoff, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5038, in compress_between
    self._canonize_between_tids(tid1, tid2, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5068, in _canonize_between_tids
    **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 4942, in _compress_between_tids
    tensor_canonize_bond(Tl, Tr, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 897, in tensor_canonize_bond
    tensor_compress_bond(ta, tb, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 974, in tensor_compress_bond
    new_T1, tRfact = T1.split(left_env_ix, get='tensors', **split_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    absorb=absorb, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 815, in tensor_split
    left = reshape(left, (*left_dims, -1))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 815, in tensor_split
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [0, 8, -1] because the unspecified dimension size -1 can be any value and is ambiguous
    left = reshape(left, (*left_dims, -1))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [0, -1] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 632, in pair_energies_deterministic
    ex[site1,site2] = self.pair_energy_deterministic(config,peps,site1,site2,cache_bot,cache_top,sign_fn) * sign
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 606, in pair_energy_deterministic
    bot_term = self.get_bot_env(i,row,bot_term,config_new,cache_bot)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 224, in get_bot_env
    tn.contract_boundary_from_bottom_(xrange=(i-1,i),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1235, in contract_boundary_from_bottom
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 848, in _contract_boundary_single
    canonize_fn(i, equalize_norms=equalize_norms)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 579, in canonize_row
    self.canonize_between((i, j), (i, j + 1), **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5110, in canonize_between
    self._canonize_between_tids(tid1, tid2, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5068, in _canonize_between_tids
    tensor_canonize_bond(Tl, Tr, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 897, in tensor_canonize_bond
    new_T1, tRfact = T1.split(left_env_ix, get='tensors', **split_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 815, in tensor_split
    left = reshape(left, (*left_dims, -1))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [0, 8, -1] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 632, in pair_energies_deterministic
    ex[site1,site2] = self.pair_energy_deterministic(config,peps,site1,site2,cache_bot,cache_top,sign_fn) * sign
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 606, in pair_energy_deterministic
    bot_term = self.get_bot_env(i,row,bot_term,config_new,cache_bot)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 224, in get_bot_env
    tn.contract_boundary_from_bottom_(xrange=(i-1,i),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1235, in contract_boundary_from_bottom
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 848, in _contract_boundary_single
    canonize_fn(i, equalize_norms=equalize_norms)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 579, in canonize_row
    self.canonize_between((i, j), (i, j + 1), **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5110, in canonize_between
    self._canonize_between_tids(tid1, tid2, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5068, in _canonize_between_tids
    tensor_canonize_bond(Tl, Tr, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 897, in tensor_canonize_bond
    new_T1, tRfact = T1.split(left_env_ix, get='tensors', **split_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 815, in tensor_split
    left = reshape(left, (*left_dims, -1))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [0, 8, -1] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 632, in pair_energies_deterministic
    ex[site1,site2] = self.pair_energy_deterministic(config,peps,site1,site2,cache_bot,cache_top,sign_fn) * sign
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 606, in pair_energy_deterministic
    bot_term = self.get_bot_env(i,row,bot_term,config_new,cache_bot)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 224, in get_bot_env
    tn.contract_boundary_from_bottom_(xrange=(i-1,i),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1235, in contract_boundary_from_bottom
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 857, in _contract_boundary_single
    compress_opts=compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 723, in compress_row
    cutoff=cutoff, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5038, in compress_between
    **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 4942, in _compress_between_tids
    tensor_compress_bond(ta, tb, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 967, in tensor_compress_bond
    get='tensors', method='qr')
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 816, in tensor_split
    right = reshape(right, (-1, *right_dims))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [-1, 0] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 632, in pair_energies_deterministic
    ex[site1,site2] = self.pair_energy_deterministic(config,peps,site1,site2,cache_bot,cache_top,sign_fn) * sign
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 606, in pair_energy_deterministic
    bot_term = self.get_bot_env(i,row,bot_term,config_new,cache_bot)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 224, in get_bot_env
    tn.contract_boundary_from_bottom_(xrange=(i-1,i),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1235, in contract_boundary_from_bottom
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 857, in _contract_boundary_single
    compress_opts=compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 723, in compress_row
    cutoff=cutoff, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5038, in compress_between
    **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 4942, in _compress_between_tids
    tensor_compress_bond(ta, tb, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 974, in tensor_compress_bond
    absorb=absorb, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 815, in tensor_split
    left = reshape(left, (*left_dims, -1))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [0, -1] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 632, in pair_energies_deterministic
    ex[site1,site2] = self.pair_energy_deterministic(config,peps,site1,site2,cache_bot,cache_top,sign_fn) * sign
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 613, in pair_energy_deterministic
    top_term = self.get_top_env(i,row,top_term,config_new,cache_top)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 258, in get_top_env
    tn.contract_boundary_from_top_(xrange=(i,i+1),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1351, in contract_boundary_from_top
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 848, in _contract_boundary_single
    canonize_fn(i, equalize_norms=equalize_norms)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 583, in canonize_row
    self.canonize_between((i, j), (i, j - 1), **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5110, in canonize_between
    self._canonize_between_tids(tid1, tid2, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5068, in _canonize_between_tids
    tensor_canonize_bond(Tl, Tr, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 897, in tensor_canonize_bond
    new_T1, tRfact = T1.split(left_env_ix, get='tensors', **split_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 815, in tensor_split
    left = reshape(left, (*left_dims, -1))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [0, 8, -1] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 632, in pair_energies_deterministic
    ex[site1,site2] = self.pair_energy_deterministic(config,peps,site1,site2,cache_bot,cache_top,sign_fn) * sign
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 613, in pair_energy_deterministic
    top_term = self.get_top_env(i,row,top_term,config_new,cache_top)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 258, in get_top_env
    tn.contract_boundary_from_top_(xrange=(i,i+1),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1351, in contract_boundary_from_top
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 857, in _contract_boundary_single
    compress_opts=compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 719, in compress_row
    cutoff=cutoff, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5038, in compress_between
    **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 4942, in _compress_between_tids
    tensor_compress_bond(ta, tb, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 974, in tensor_compress_bond
    absorb=absorb, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 815, in tensor_split
    left = reshape(left, (*left_dims, -1))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [0, -1] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 632, in pair_energies_deterministic
    ex[site1,site2] = self.pair_energy_deterministic(config,peps,site1,site2,cache_bot,cache_top,sign_fn) * sign
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 606, in pair_energy_deterministic
    bot_term = self.get_bot_env(i,row,bot_term,config_new,cache_bot)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 224, in get_bot_env
    tn.contract_boundary_from_bottom_(xrange=(i-1,i),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1235, in contract_boundary_from_bottom
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 848, in _contract_boundary_single
    canonize_fn(i, equalize_norms=equalize_norms)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 579, in canonize_row
    self.canonize_between((i, j), (i, j + 1), **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5110, in canonize_between
    self._canonize_between_tids(tid1, tid2, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5068, in _canonize_between_tids
    tensor_canonize_bond(Tl, Tr, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 897, in tensor_canonize_bond
    new_T1, tRfact = T1.split(left_env_ix, get='tensors', **split_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 815, in tensor_split
    left = reshape(left, (*left_dims, -1))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [0, 8, -1] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 632, in pair_energies_deterministic
    ex[site1,site2] = self.pair_energy_deterministic(config,peps,site1,site2,cache_bot,cache_top,sign_fn) * sign
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 613, in pair_energy_deterministic
    top_term = self.get_top_env(i,row,top_term,config_new,cache_top)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 258, in get_top_env
    tn.contract_boundary_from_top_(xrange=(i,i+1),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1351, in contract_boundary_from_top
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 848, in _contract_boundary_single
    canonize_fn(i, equalize_norms=equalize_norms)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 583, in canonize_row
    self.canonize_between((i, j), (i, j - 1), **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5110, in canonize_between
    self._canonize_between_tids(tid1, tid2, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5068, in _canonize_between_tids
    tensor_canonize_bond(Tl, Tr, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 897, in tensor_canonize_bond
    new_T1, tRfact = T1.split(left_env_ix, get='tensors', **split_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 815, in tensor_split
    left = reshape(left, (*left_dims, -1))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [0, 8, -1] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 632, in pair_energies_deterministic
    ex[site1,site2] = self.pair_energy_deterministic(config,peps,site1,site2,cache_bot,cache_top,sign_fn) * sign
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 606, in pair_energy_deterministic
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    bot_term = self.get_bot_env(i,row,bot_term,config_new,cache_bot)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 224, in get_bot_env
    tn.contract_boundary_from_bottom_(xrange=(i-1,i),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1235, in contract_boundary_from_bottom
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 632, in pair_energies_deterministic
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 848, in _contract_boundary_single
    ex[site1,site2] = self.pair_energy_deterministic(config,peps,site1,site2,cache_bot,cache_top,sign_fn) * sign
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 613, in pair_energy_deterministic
    top_term = self.get_top_env(i,row,top_term,config_new,cache_top)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 258, in get_top_env
    canonize_fn(i, equalize_norms=equalize_norms)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 579, in canonize_row
    tn.contract_boundary_from_top_(xrange=(i,i+1),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1351, in contract_boundary_from_top
    self.canonize_between((i, j), (i, j + 1), **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5110, in canonize_between
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 848, in _contract_boundary_single
    canonize_fn(i, equalize_norms=equalize_norms)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 583, in canonize_row
    self.canonize_between((i, j), (i, j - 1), **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5110, in canonize_between
    self._canonize_between_tids(tid1, tid2, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5068, in _canonize_between_tids
    tensor_canonize_bond(Tl, Tr, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 897, in tensor_canonize_bond
    self._canonize_between_tids(tid1, tid2, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5068, in _canonize_between_tids
    new_T1, tRfact = T1.split(left_env_ix, get='tensors', **split_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 815, in tensor_split
    left = reshape(left, (*left_dims, -1))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    tensor_canonize_bond(Tl, Tr, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 897, in tensor_canonize_bond
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [0, 8, -1] because the unspecified dimension size -1 can be any value and is ambiguous
    new_T1, tRfact = T1.split(left_env_ix, get='tensors', **split_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 815, in tensor_split
    left = reshape(left, (*left_dims, -1))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [0, 8, -1] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 632, in pair_energies_deterministic
    ex[site1,site2] = self.pair_energy_deterministic(config,peps,site1,site2,cache_bot,cache_top,sign_fn) * sign
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 606, in pair_energy_deterministic
    bot_term = self.get_bot_env(i,row,bot_term,config_new,cache_bot)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 224, in get_bot_env
    tn.contract_boundary_from_bottom_(xrange=(i-1,i),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1235, in contract_boundary_from_bottom
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 857, in _contract_boundary_single
    compress_opts=compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 723, in compress_row
    cutoff=cutoff, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5038, in compress_between
    **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 4942, in _compress_between_tids
    tensor_compress_bond(ta, tb, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 967, in tensor_compress_bond
    get='tensors', method='qr')
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 816, in tensor_split
    right = reshape(right, (-1, *right_dims))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [-1, 0] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 632, in pair_energies_deterministic
    ex[site1,site2] = self.pair_energy_deterministic(config,peps,site1,site2,cache_bot,cache_top,sign_fn) * sign
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 606, in pair_energy_deterministic
    bot_term = self.get_bot_env(i,row,bot_term,config_new,cache_bot)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 224, in get_bot_env
    tn.contract_boundary_from_bottom_(xrange=(i-1,i),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1235, in contract_boundary_from_bottom
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 848, in _contract_boundary_single
    canonize_fn(i, equalize_norms=equalize_norms)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 579, in canonize_row
    self.canonize_between((i, j), (i, j + 1), **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5110, in canonize_between
    self._canonize_between_tids(tid1, tid2, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5068, in _canonize_between_tids
    tensor_canonize_bond(Tl, Tr, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 897, in tensor_canonize_bond
    new_T1, tRfact = T1.split(left_env_ix, get='tensors', **split_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 815, in tensor_split
    left = reshape(left, (*left_dims, -1))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [0, 8, -1] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 632, in pair_energies_deterministic
    ex[site1,site2] = self.pair_energy_deterministic(config,peps,site1,site2,cache_bot,cache_top,sign_fn) * sign
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 606, in pair_energy_deterministic
    bot_term = self.get_bot_env(i,row,bot_term,config_new,cache_bot)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 224, in get_bot_env
    tn.contract_boundary_from_bottom_(xrange=(i-1,i),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1235, in contract_boundary_from_bottom
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 857, in _contract_boundary_single
    compress_opts=compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 723, in compress_row
    cutoff=cutoff, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5038, in compress_between
    **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 4942, in _compress_between_tids
    tensor_compress_bond(ta, tb, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 967, in tensor_compress_bond
    get='tensors', method='qr')
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 816, in tensor_split
    right = reshape(right, (-1, *right_dims))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [-1, 0] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 632, in pair_energies_deterministic
    ex[site1,site2] = self.pair_energy_deterministic(config,peps,site1,site2,cache_bot,cache_top,sign_fn) * sign
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 613, in pair_energy_deterministic
    top_term = self.get_top_env(i,row,top_term,config_new,cache_top)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 258, in get_top_env
    tn.contract_boundary_from_top_(xrange=(i,i+1),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1351, in contract_boundary_from_top
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 848, in _contract_boundary_single
    canonize_fn(i, equalize_norms=equalize_norms)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 583, in canonize_row
    self.canonize_between((i, j), (i, j - 1), **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5110, in canonize_between
    self._canonize_between_tids(tid1, tid2, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5068, in _canonize_between_tids
    tensor_canonize_bond(Tl, Tr, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 897, in tensor_canonize_bond
    new_T1, tRfact = T1.split(left_env_ix, get='tensors', **split_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 815, in tensor_split
    left = reshape(left, (*left_dims, -1))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [0, 8, -1] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 632, in pair_energies_deterministic
    ex[site1,site2] = self.pair_energy_deterministic(config,peps,site1,site2,cache_bot,cache_top,sign_fn) * sign
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 606, in pair_energy_deterministic
    bot_term = self.get_bot_env(i,row,bot_term,config_new,cache_bot)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 224, in get_bot_env
    tn.contract_boundary_from_bottom_(xrange=(i-1,i),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1235, in contract_boundary_from_bottom
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 857, in _contract_boundary_single
    compress_opts=compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 723, in compress_row
    cutoff=cutoff, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5038, in compress_between
    **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 4942, in _compress_between_tids
    tensor_compress_bond(ta, tb, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 974, in tensor_compress_bond
    absorb=absorb, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 815, in tensor_split
    left = reshape(left, (*left_dims, -1))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [0, -1] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 632, in pair_energies_deterministic
    ex[site1,site2] = self.pair_energy_deterministic(config,peps,site1,site2,cache_bot,cache_top,sign_fn) * sign
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 606, in pair_energy_deterministic
    bot_term = self.get_bot_env(i,row,bot_term,config_new,cache_bot)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 224, in get_bot_env
    tn.contract_boundary_from_bottom_(xrange=(i-1,i),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1235, in contract_boundary_from_bottom
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 848, in _contract_boundary_single
    canonize_fn(i, equalize_norms=equalize_norms)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 579, in canonize_row
    self.canonize_between((i, j), (i, j + 1), **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5110, in canonize_between
    self._canonize_between_tids(tid1, tid2, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5068, in _canonize_between_tids
    tensor_canonize_bond(Tl, Tr, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 897, in tensor_canonize_bond
    new_T1, tRfact = T1.split(left_env_ix, get='tensors', **split_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 815, in tensor_split
    left = reshape(left, (*left_dims, -1))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [0, 8, -1] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 632, in pair_energies_deterministic
    ex[site1,site2] = self.pair_energy_deterministic(config,peps,site1,site2,cache_bot,cache_top,sign_fn) * sign
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 606, in pair_energy_deterministic
    bot_term = self.get_bot_env(i,row,bot_term,config_new,cache_bot)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 224, in get_bot_env
    tn.contract_boundary_from_bottom_(xrange=(i-1,i),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1235, in contract_boundary_from_bottom
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 848, in _contract_boundary_single
    canonize_fn(i, equalize_norms=equalize_norms)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 579, in canonize_row
    self.canonize_between((i, j), (i, j + 1), **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5110, in canonize_between
    self._canonize_between_tids(tid1, tid2, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5068, in _canonize_between_tids
    tensor_canonize_bond(Tl, Tr, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 897, in tensor_canonize_bond
    new_T1, tRfact = T1.split(left_env_ix, get='tensors', **split_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 815, in tensor_split
    left = reshape(left, (*left_dims, -1))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [0, 8, -1] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 632, in pair_energies_deterministic
    ex[site1,site2] = self.pair_energy_deterministic(config,peps,site1,site2,cache_bot,cache_top,sign_fn) * sign
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 613, in pair_energy_deterministic
    top_term = self.get_top_env(i,row,top_term,config_new,cache_top)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 258, in get_top_env
    tn.contract_boundary_from_top_(xrange=(i,i+1),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1351, in contract_boundary_from_top
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 848, in _contract_boundary_single
    canonize_fn(i, equalize_norms=equalize_norms)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 583, in canonize_row
    self.canonize_between((i, j), (i, j - 1), **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5110, in canonize_between
    self._canonize_between_tids(tid1, tid2, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5068, in _canonize_between_tids
    tensor_canonize_bond(Tl, Tr, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 897, in tensor_canonize_bond
    new_T1, tRfact = T1.split(left_env_ix, get='tensors', **split_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 815, in tensor_split
    left = reshape(left, (*left_dims, -1))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [0, 8, -1] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 632, in pair_energies_deterministic
    ex[site1,site2] = self.pair_energy_deterministic(config,peps,site1,site2,cache_bot,cache_top,sign_fn) * sign
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 613, in pair_energy_deterministic
    top_term = self.get_top_env(i,row,top_term,config_new,cache_top)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 258, in get_top_env
    tn.contract_boundary_from_top_(xrange=(i,i+1),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1351, in contract_boundary_from_top
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 857, in _contract_boundary_single
    compress_opts=compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 719, in compress_row
    cutoff=cutoff, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5038, in compress_between
    **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 4942, in _compress_between_tids
    tensor_compress_bond(ta, tb, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 967, in tensor_compress_bond
    get='tensors', method='qr')
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 816, in tensor_split
    right = reshape(right, (-1, *right_dims))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [-1, 0] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 632, in pair_energies_deterministic
    ex[site1,site2] = self.pair_energy_deterministic(config,peps,site1,site2,cache_bot,cache_top,sign_fn) * sign
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 613, in pair_energy_deterministic
    top_term = self.get_top_env(i,row,top_term,config_new,cache_top)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 258, in get_top_env
    tn.contract_boundary_from_top_(xrange=(i,i+1),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1351, in contract_boundary_from_top
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 857, in _contract_boundary_single
    compress_opts=compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 719, in compress_row
    cutoff=cutoff, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5038, in compress_between
    **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 4942, in _compress_between_tids
    tensor_compress_bond(ta, tb, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 974, in tensor_compress_bond
    absorb=absorb, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 815, in tensor_split
    left = reshape(left, (*left_dims, -1))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [0, -1] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 632, in pair_energies_deterministic
    ex[site1,site2] = self.pair_energy_deterministic(config,peps,site1,site2,cache_bot,cache_top,sign_fn) * sign
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 606, in pair_energy_deterministic
    bot_term = self.get_bot_env(i,row,bot_term,config_new,cache_bot)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 224, in get_bot_env
    tn.contract_boundary_from_bottom_(xrange=(i-1,i),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1235, in contract_boundary_from_bottom
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 857, in _contract_boundary_single
    compress_opts=compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 723, in compress_row
    cutoff=cutoff, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5038, in compress_between
    **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 4942, in _compress_between_tids
    tensor_compress_bond(ta, tb, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 974, in tensor_compress_bond
    absorb=absorb, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 815, in tensor_split
    left = reshape(left, (*left_dims, -1))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [0, -1] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 632, in pair_energies_deterministic
    ex[site1,site2] = self.pair_energy_deterministic(config,peps,site1,site2,cache_bot,cache_top,sign_fn) * sign
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 606, in pair_energy_deterministic
    bot_term = self.get_bot_env(i,row,bot_term,config_new,cache_bot)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 224, in get_bot_env
    tn.contract_boundary_from_bottom_(xrange=(i-1,i),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1235, in contract_boundary_from_bottom
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 848, in _contract_boundary_single
    canonize_fn(i, equalize_norms=equalize_norms)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 579, in canonize_row
    self.canonize_between((i, j), (i, j + 1), **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5110, in canonize_between
    self._canonize_between_tids(tid1, tid2, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5068, in _canonize_between_tids
    tensor_canonize_bond(Tl, Tr, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 897, in tensor_canonize_bond
    new_T1, tRfact = T1.split(left_env_ix, get='tensors', **split_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 815, in tensor_split
    left = reshape(left, (*left_dims, -1))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [0, 8, -1] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 632, in pair_energies_deterministic
    ex[site1,site2] = self.pair_energy_deterministic(config,peps,site1,site2,cache_bot,cache_top,sign_fn) * sign
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 606, in pair_energy_deterministic
    bot_term = self.get_bot_env(i,row,bot_term,config_new,cache_bot)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 224, in get_bot_env
    tn.contract_boundary_from_bottom_(xrange=(i-1,i),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1235, in contract_boundary_from_bottom
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 857, in _contract_boundary_single
    compress_opts=compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 723, in compress_row
    cutoff=cutoff, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5038, in compress_between
    **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 4942, in _compress_between_tids
    tensor_compress_bond(ta, tb, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 967, in tensor_compress_bond
    get='tensors', method='qr')
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 816, in tensor_split
    right = reshape(right, (-1, *right_dims))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [-1, 0] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 632, in pair_energies_deterministic
    ex[site1,site2] = self.pair_energy_deterministic(config,peps,site1,site2,cache_bot,cache_top,sign_fn) * sign
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 606, in pair_energy_deterministic
    bot_term = self.get_bot_env(i,row,bot_term,config_new,cache_bot)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 224, in get_bot_env
    tn.contract_boundary_from_bottom_(xrange=(i-1,i),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1235, in contract_boundary_from_bottom
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 857, in _contract_boundary_single
    compress_opts=compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 723, in compress_row
    cutoff=cutoff, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5038, in compress_between
    **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 4942, in _compress_between_tids
    tensor_compress_bond(ta, tb, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 967, in tensor_compress_bond
    get='tensors', method='qr')
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 816, in tensor_split
    right = reshape(right, (-1, *right_dims))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [-1, 0] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 632, in pair_energies_deterministic
    ex[site1,site2] = self.pair_energy_deterministic(config,peps,site1,site2,cache_bot,cache_top,sign_fn) * sign
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 613, in pair_energy_deterministic
    top_term = self.get_top_env(i,row,top_term,config_new,cache_top)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 258, in get_top_env
    tn.contract_boundary_from_top_(xrange=(i,i+1),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1351, in contract_boundary_from_top
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 857, in _contract_boundary_single
    compress_opts=compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 719, in compress_row
    cutoff=cutoff, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5038, in compress_between
    **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 4942, in _compress_between_tids
    tensor_compress_bond(ta, tb, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 967, in tensor_compress_bond
    get='tensors', method='qr')
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 816, in tensor_split
    right = reshape(right, (-1, *right_dims))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [-1, 0] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 632, in pair_energies_deterministic
    ex[site1,site2] = self.pair_energy_deterministic(config,peps,site1,site2,cache_bot,cache_top,sign_fn) * sign
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 606, in pair_energy_deterministic
    bot_term = self.get_bot_env(i,row,bot_term,config_new,cache_bot)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 224, in get_bot_env
    tn.contract_boundary_from_bottom_(xrange=(i-1,i),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1235, in contract_boundary_from_bottom
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 848, in _contract_boundary_single
    canonize_fn(i, equalize_norms=equalize_norms)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 579, in canonize_row
    self.canonize_between((i, j), (i, j + 1), **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5110, in canonize_between
    self._canonize_between_tids(tid1, tid2, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5068, in _canonize_between_tids
    tensor_canonize_bond(Tl, Tr, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 897, in tensor_canonize_bond
    new_T1, tRfact = T1.split(left_env_ix, get='tensors', **split_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 815, in tensor_split
    left = reshape(left, (*left_dims, -1))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [0, 8, -1] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 632, in pair_energies_deterministic
    ex[site1,site2] = self.pair_energy_deterministic(config,peps,site1,site2,cache_bot,cache_top,sign_fn) * sign
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 613, in pair_energy_deterministic
    top_term = self.get_top_env(i,row,top_term,config_new,cache_top)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 258, in get_top_env
    tn.contract_boundary_from_top_(xrange=(i,i+1),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1351, in contract_boundary_from_top
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 848, in _contract_boundary_single
    canonize_fn(i, equalize_norms=equalize_norms)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 583, in canonize_row
    self.canonize_between((i, j), (i, j - 1), **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5110, in canonize_between
    self._canonize_between_tids(tid1, tid2, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5068, in _canonize_between_tids
    tensor_canonize_bond(Tl, Tr, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 897, in tensor_canonize_bond
    new_T1, tRfact = T1.split(left_env_ix, get='tensors', **split_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 815, in tensor_split
    left = reshape(left, (*left_dims, -1))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [0, 8, -1] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 632, in pair_energies_deterministic
    ex[site1,site2] = self.pair_energy_deterministic(config,peps,site1,site2,cache_bot,cache_top,sign_fn) * sign
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 613, in pair_energy_deterministic
    top_term = self.get_top_env(i,row,top_term,config_new,cache_top)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 258, in get_top_env
    tn.contract_boundary_from_top_(xrange=(i,i+1),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1351, in contract_boundary_from_top
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 848, in _contract_boundary_single
    canonize_fn(i, equalize_norms=equalize_norms)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 583, in canonize_row
    self.canonize_between((i, j), (i, j - 1), **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5110, in canonize_between
    self._canonize_between_tids(tid1, tid2, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5068, in _canonize_between_tids
    tensor_canonize_bond(Tl, Tr, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 897, in tensor_canonize_bond
    new_T1, tRfact = T1.split(left_env_ix, get='tensors', **split_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 815, in tensor_split
    left = reshape(left, (*left_dims, -1))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [0, 8, -1] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 632, in pair_energies_deterministic
    ex[site1,site2] = self.pair_energy_deterministic(config,peps,site1,site2,cache_bot,cache_top,sign_fn) * sign
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 606, in pair_energy_deterministic
    bot_term = self.get_bot_env(i,row,bot_term,config_new,cache_bot)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 224, in get_bot_env
    tn.contract_boundary_from_bottom_(xrange=(i-1,i),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1235, in contract_boundary_from_bottom
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 857, in _contract_boundary_single
    compress_opts=compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 723, in compress_row
    cutoff=cutoff, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5038, in compress_between
    **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 4942, in _compress_between_tids
    tensor_compress_bond(ta, tb, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 967, in tensor_compress_bond
    get='tensors', method='qr')
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 816, in tensor_split
    right = reshape(right, (-1, *right_dims))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [-1, 0] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 632, in pair_energies_deterministic
    ex[site1,site2] = self.pair_energy_deterministic(config,peps,site1,site2,cache_bot,cache_top,sign_fn) * sign
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 606, in pair_energy_deterministic
    bot_term = self.get_bot_env(i,row,bot_term,config_new,cache_bot)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 224, in get_bot_env
    tn.contract_boundary_from_bottom_(xrange=(i-1,i),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1235, in contract_boundary_from_bottom
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 857, in _contract_boundary_single
    compress_opts=compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 723, in compress_row
    cutoff=cutoff, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5038, in compress_between
    **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 4942, in _compress_between_tids
    tensor_compress_bond(ta, tb, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 967, in tensor_compress_bond
    get='tensors', method='qr')
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 816, in tensor_split
    right = reshape(right, (-1, *right_dims))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [-1, 0] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 632, in pair_energies_deterministic
    ex[site1,site2] = self.pair_energy_deterministic(config,peps,site1,site2,cache_bot,cache_top,sign_fn) * sign
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 606, in pair_energy_deterministic
    bot_term = self.get_bot_env(i,row,bot_term,config_new,cache_bot)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 224, in get_bot_env
    tn.contract_boundary_from_bottom_(xrange=(i-1,i),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1235, in contract_boundary_from_bottom
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 848, in _contract_boundary_single
    canonize_fn(i, equalize_norms=equalize_norms)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 579, in canonize_row
    self.canonize_between((i, j), (i, j + 1), **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5110, in canonize_between
    self._canonize_between_tids(tid1, tid2, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5068, in _canonize_between_tids
    tensor_canonize_bond(Tl, Tr, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 897, in tensor_canonize_bond
    new_T1, tRfact = T1.split(left_env_ix, get='tensors', **split_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 815, in tensor_split
    left = reshape(left, (*left_dims, -1))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [0, 8, -1] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 632, in pair_energies_deterministic
    ex[site1,site2] = self.pair_energy_deterministic(config,peps,site1,site2,cache_bot,cache_top,sign_fn) * sign
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 606, in pair_energy_deterministic
    bot_term = self.get_bot_env(i,row,bot_term,config_new,cache_bot)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 224, in get_bot_env
    tn.contract_boundary_from_bottom_(xrange=(i-1,i),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1235, in contract_boundary_from_bottom
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 857, in _contract_boundary_single
    compress_opts=compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 723, in compress_row
    cutoff=cutoff, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5038, in compress_between
    **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 4942, in _compress_between_tids
    tensor_compress_bond(ta, tb, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 967, in tensor_compress_bond
    get='tensors', method='qr')
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 816, in tensor_split
    right = reshape(right, (-1, *right_dims))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [-1, 0] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 632, in pair_energies_deterministic
    ex[site1,site2] = self.pair_energy_deterministic(config,peps,site1,site2,cache_bot,cache_top,sign_fn) * sign
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 613, in pair_energy_deterministic
    top_term = self.get_top_env(i,row,top_term,config_new,cache_top)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 258, in get_top_env
    tn.contract_boundary_from_top_(xrange=(i,i+1),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1351, in contract_boundary_from_top
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 848, in _contract_boundary_single
    canonize_fn(i, equalize_norms=equalize_norms)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 583, in canonize_row
    self.canonize_between((i, j), (i, j - 1), **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5110, in canonize_between
    self._canonize_between_tids(tid1, tid2, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5068, in _canonize_between_tids
    tensor_canonize_bond(Tl, Tr, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 897, in tensor_canonize_bond
    new_T1, tRfact = T1.split(left_env_ix, get='tensors', **split_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 815, in tensor_split
    left = reshape(left, (*left_dims, -1))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [0, 8, -1] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 632, in pair_energies_deterministic
    ex[site1,site2] = self.pair_energy_deterministic(config,peps,site1,site2,cache_bot,cache_top,sign_fn) * sign
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 606, in pair_energy_deterministic
    bot_term = self.get_bot_env(i,row,bot_term,config_new,cache_bot)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 224, in get_bot_env
    tn.contract_boundary_from_bottom_(xrange=(i-1,i),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1235, in contract_boundary_from_bottom
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 848, in _contract_boundary_single
    canonize_fn(i, equalize_norms=equalize_norms)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 579, in canonize_row
    self.canonize_between((i, j), (i, j + 1), **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5110, in canonize_between
    self._canonize_between_tids(tid1, tid2, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5068, in _canonize_between_tids
    tensor_canonize_bond(Tl, Tr, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 897, in tensor_canonize_bond
    new_T1, tRfact = T1.split(left_env_ix, get='tensors', **split_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 815, in tensor_split
    left = reshape(left, (*left_dims, -1))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [0, 8, -1] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 632, in pair_energies_deterministic
    ex[site1,site2] = self.pair_energy_deterministic(config,peps,site1,site2,cache_bot,cache_top,sign_fn) * sign
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 613, in pair_energy_deterministic
    top_term = self.get_top_env(i,row,top_term,config_new,cache_top)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 258, in get_top_env
    tn.contract_boundary_from_top_(xrange=(i,i+1),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1351, in contract_boundary_from_top
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 857, in _contract_boundary_single
    compress_opts=compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 719, in compress_row
    cutoff=cutoff, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5038, in compress_between
    **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 4942, in _compress_between_tids
    tensor_compress_bond(ta, tb, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 974, in tensor_compress_bond
    absorb=absorb, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 815, in tensor_split
    left = reshape(left, (*left_dims, -1))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [0, -1] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 632, in pair_energies_deterministic
    ex[site1,site2] = self.pair_energy_deterministic(config,peps,site1,site2,cache_bot,cache_top,sign_fn) * sign
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 606, in pair_energy_deterministic
    bot_term = self.get_bot_env(i,row,bot_term,config_new,cache_bot)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 224, in get_bot_env
    tn.contract_boundary_from_bottom_(xrange=(i-1,i),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1235, in contract_boundary_from_bottom
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 857, in _contract_boundary_single
    compress_opts=compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 723, in compress_row
    cutoff=cutoff, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5038, in compress_between
    **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 4942, in _compress_between_tids
    tensor_compress_bond(ta, tb, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 967, in tensor_compress_bond
    get='tensors', method='qr')
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 816, in tensor_split
    right = reshape(right, (-1, *right_dims))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [-1, 0] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 632, in pair_energies_deterministic
    ex[site1,site2] = self.pair_energy_deterministic(config,peps,site1,site2,cache_bot,cache_top,sign_fn) * sign
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 606, in pair_energy_deterministic
    bot_term = self.get_bot_env(i,row,bot_term,config_new,cache_bot)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 224, in get_bot_env
    tn.contract_boundary_from_bottom_(xrange=(i-1,i),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1235, in contract_boundary_from_bottom
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 848, in _contract_boundary_single
    canonize_fn(i, equalize_norms=equalize_norms)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 579, in canonize_row
    self.canonize_between((i, j), (i, j + 1), **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5110, in canonize_between
    self._canonize_between_tids(tid1, tid2, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5068, in _canonize_between_tids
    tensor_canonize_bond(Tl, Tr, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 897, in tensor_canonize_bond
    new_T1, tRfact = T1.split(left_env_ix, get='tensors', **split_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 815, in tensor_split
    left = reshape(left, (*left_dims, -1))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [0, 8, -1] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 632, in pair_energies_deterministic
    ex[site1,site2] = self.pair_energy_deterministic(config,peps,site1,site2,cache_bot,cache_top,sign_fn) * sign
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 606, in pair_energy_deterministic
    bot_term = self.get_bot_env(i,row,bot_term,config_new,cache_bot)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 224, in get_bot_env
    tn.contract_boundary_from_bottom_(xrange=(i-1,i),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1235, in contract_boundary_from_bottom
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 848, in _contract_boundary_single
    canonize_fn(i, equalize_norms=equalize_norms)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 579, in canonize_row
    self.canonize_between((i, j), (i, j + 1), **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5110, in canonize_between
    self._canonize_between_tids(tid1, tid2, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5068, in _canonize_between_tids
    tensor_canonize_bond(Tl, Tr, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 897, in tensor_canonize_bond
    new_T1, tRfact = T1.split(left_env_ix, get='tensors', **split_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 815, in tensor_split
    left = reshape(left, (*left_dims, -1))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [0, 8, -1] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 632, in pair_energies_deterministic
    ex[site1,site2] = self.pair_energy_deterministic(config,peps,site1,site2,cache_bot,cache_top,sign_fn) * sign
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 613, in pair_energy_deterministic
    top_term = self.get_top_env(i,row,top_term,config_new,cache_top)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 258, in get_top_env
    tn.contract_boundary_from_top_(xrange=(i,i+1),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1351, in contract_boundary_from_top
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 857, in _contract_boundary_single
    compress_opts=compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 719, in compress_row
    cutoff=cutoff, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5038, in compress_between
    **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 4942, in _compress_between_tids
    tensor_compress_bond(ta, tb, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 974, in tensor_compress_bond
    absorb=absorb, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 815, in tensor_split
    left = reshape(left, (*left_dims, -1))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [0, -1] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 632, in pair_energies_deterministic
    ex[site1,site2] = self.pair_energy_deterministic(config,peps,site1,site2,cache_bot,cache_top,sign_fn) * sign
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 606, in pair_energy_deterministic
    bot_term = self.get_bot_env(i,row,bot_term,config_new,cache_bot)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 224, in get_bot_env
    tn.contract_boundary_from_bottom_(xrange=(i-1,i),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1235, in contract_boundary_from_bottom
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 857, in _contract_boundary_single
    compress_opts=compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 723, in compress_row
    cutoff=cutoff, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5038, in compress_between
    **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 4942, in _compress_between_tids
    tensor_compress_bond(ta, tb, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 967, in tensor_compress_bond
    get='tensors', method='qr')
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 816, in tensor_split
    right = reshape(right, (-1, *right_dims))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [-1, 0] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 632, in pair_energies_deterministic
    ex[site1,site2] = self.pair_energy_deterministic(config,peps,site1,site2,cache_bot,cache_top,sign_fn) * sign
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 606, in pair_energy_deterministic
    bot_term = self.get_bot_env(i,row,bot_term,config_new,cache_bot)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 224, in get_bot_env
    tn.contract_boundary_from_bottom_(xrange=(i-1,i),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1235, in contract_boundary_from_bottom
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 848, in _contract_boundary_single
    canonize_fn(i, equalize_norms=equalize_norms)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 579, in canonize_row
    self.canonize_between((i, j), (i, j + 1), **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5110, in canonize_between
    self._canonize_between_tids(tid1, tid2, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5068, in _canonize_between_tids
    tensor_canonize_bond(Tl, Tr, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 897, in tensor_canonize_bond
    new_T1, tRfact = T1.split(left_env_ix, get='tensors', **split_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 815, in tensor_split
    left = reshape(left, (*left_dims, -1))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [0, 8, -1] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 632, in pair_energies_deterministic
    ex[site1,site2] = self.pair_energy_deterministic(config,peps,site1,site2,cache_bot,cache_top,sign_fn) * sign
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 606, in pair_energy_deterministic
    bot_term = self.get_bot_env(i,row,bot_term,config_new,cache_bot)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 224, in get_bot_env
    tn.contract_boundary_from_bottom_(xrange=(i-1,i),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1235, in contract_boundary_from_bottom
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 848, in _contract_boundary_single
    canonize_fn(i, equalize_norms=equalize_norms)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 579, in canonize_row
    self.canonize_between((i, j), (i, j + 1), **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5110, in canonize_between
    self._canonize_between_tids(tid1, tid2, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5068, in _canonize_between_tids
    tensor_canonize_bond(Tl, Tr, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 897, in tensor_canonize_bond
    new_T1, tRfact = T1.split(left_env_ix, get='tensors', **split_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 815, in tensor_split
    left = reshape(left, (*left_dims, -1))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [0, 8, -1] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 632, in pair_energies_deterministic
    ex[site1,site2] = self.pair_energy_deterministic(config,peps,site1,site2,cache_bot,cache_top,sign_fn) * sign
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 613, in pair_energy_deterministic
    top_term = self.get_top_env(i,row,top_term,config_new,cache_top)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 258, in get_top_env
    tn.contract_boundary_from_top_(xrange=(i,i+1),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1351, in contract_boundary_from_top
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 857, in _contract_boundary_single
    compress_opts=compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 719, in compress_row
    cutoff=cutoff, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5038, in compress_between
    **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 4942, in _compress_between_tids
    tensor_compress_bond(ta, tb, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 967, in tensor_compress_bond
    get='tensors', method='qr')
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 816, in tensor_split
    right = reshape(right, (-1, *right_dims))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [-1, 0] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 632, in pair_energies_deterministic
    ex[site1,site2] = self.pair_energy_deterministic(config,peps,site1,site2,cache_bot,cache_top,sign_fn) * sign
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 606, in pair_energy_deterministic
    bot_term = self.get_bot_env(i,row,bot_term,config_new,cache_bot)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 224, in get_bot_env
    tn.contract_boundary_from_bottom_(xrange=(i-1,i),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1235, in contract_boundary_from_bottom
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 848, in _contract_boundary_single
    canonize_fn(i, equalize_norms=equalize_norms)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 579, in canonize_row
    self.canonize_between((i, j), (i, j + 1), **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5110, in canonize_between
    self._canonize_between_tids(tid1, tid2, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5068, in _canonize_between_tids
    tensor_canonize_bond(Tl, Tr, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 897, in tensor_canonize_bond
    new_T1, tRfact = T1.split(left_env_ix, get='tensors', **split_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 815, in tensor_split
    left = reshape(left, (*left_dims, -1))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [0, 8, -1] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 632, in pair_energies_deterministic
    ex[site1,site2] = self.pair_energy_deterministic(config,peps,site1,site2,cache_bot,cache_top,sign_fn) * sign
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 606, in pair_energy_deterministic
    bot_term = self.get_bot_env(i,row,bot_term,config_new,cache_bot)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 224, in get_bot_env
    tn.contract_boundary_from_bottom_(xrange=(i-1,i),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1235, in contract_boundary_from_bottom
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 857, in _contract_boundary_single
    compress_opts=compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 723, in compress_row
    cutoff=cutoff, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5038, in compress_between
    **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 4942, in _compress_between_tids
    tensor_compress_bond(ta, tb, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 967, in tensor_compress_bond
    get='tensors', method='qr')
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 816, in tensor_split
    right = reshape(right, (-1, *right_dims))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [-1, 0] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 632, in pair_energies_deterministic
    ex[site1,site2] = self.pair_energy_deterministic(config,peps,site1,site2,cache_bot,cache_top,sign_fn) * sign
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 613, in pair_energy_deterministic
    top_term = self.get_top_env(i,row,top_term,config_new,cache_top)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 258, in get_top_env
    tn.contract_boundary_from_top_(xrange=(i,i+1),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1351, in contract_boundary_from_top
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 848, in _contract_boundary_single
    canonize_fn(i, equalize_norms=equalize_norms)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 583, in canonize_row
    self.canonize_between((i, j), (i, j - 1), **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5110, in canonize_between
    self._canonize_between_tids(tid1, tid2, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5068, in _canonize_between_tids
    tensor_canonize_bond(Tl, Tr, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 897, in tensor_canonize_bond
    new_T1, tRfact = T1.split(left_env_ix, get='tensors', **split_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 815, in tensor_split
    left = reshape(left, (*left_dims, -1))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [0, 8, -1] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 632, in pair_energies_deterministic
    ex[site1,site2] = self.pair_energy_deterministic(config,peps,site1,site2,cache_bot,cache_top,sign_fn) * sign
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 606, in pair_energy_deterministic
    bot_term = self.get_bot_env(i,row,bot_term,config_new,cache_bot)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 224, in get_bot_env
    tn.contract_boundary_from_bottom_(xrange=(i-1,i),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1235, in contract_boundary_from_bottom
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 848, in _contract_boundary_single
    canonize_fn(i, equalize_norms=equalize_norms)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 579, in canonize_row
    self.canonize_between((i, j), (i, j + 1), **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5110, in canonize_between
    self._canonize_between_tids(tid1, tid2, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5068, in _canonize_between_tids
    tensor_canonize_bond(Tl, Tr, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 897, in tensor_canonize_bond
    new_T1, tRfact = T1.split(left_env_ix, get='tensors', **split_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 815, in tensor_split
    left = reshape(left, (*left_dims, -1))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [0, 8, -1] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 632, in pair_energies_deterministic
    ex[site1,site2] = self.pair_energy_deterministic(config,peps,site1,site2,cache_bot,cache_top,sign_fn) * sign
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 613, in pair_energy_deterministic
    top_term = self.get_top_env(i,row,top_term,config_new,cache_top)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 258, in get_top_env
    tn.contract_boundary_from_top_(xrange=(i,i+1),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1351, in contract_boundary_from_top
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 848, in _contract_boundary_single
    canonize_fn(i, equalize_norms=equalize_norms)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 583, in canonize_row
    self.canonize_between((i, j), (i, j - 1), **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5110, in canonize_between
    self._canonize_between_tids(tid1, tid2, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5068, in _canonize_between_tids
    tensor_canonize_bond(Tl, Tr, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 897, in tensor_canonize_bond
    new_T1, tRfact = T1.split(left_env_ix, get='tensors', **split_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 815, in tensor_split
    left = reshape(left, (*left_dims, -1))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [0, 8, -1] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 632, in pair_energies_deterministic
    ex[site1,site2] = self.pair_energy_deterministic(config,peps,site1,site2,cache_bot,cache_top,sign_fn) * sign
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 606, in pair_energy_deterministic
    bot_term = self.get_bot_env(i,row,bot_term,config_new,cache_bot)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 224, in get_bot_env
    tn.contract_boundary_from_bottom_(xrange=(i-1,i),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1235, in contract_boundary_from_bottom
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 857, in _contract_boundary_single
    compress_opts=compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 723, in compress_row
    cutoff=cutoff, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5038, in compress_between
    **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 4942, in _compress_between_tids
    tensor_compress_bond(ta, tb, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 974, in tensor_compress_bond
    absorb=absorb, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 815, in tensor_split
    left = reshape(left, (*left_dims, -1))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [0, -1] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 632, in pair_energies_deterministic
    ex[site1,site2] = self.pair_energy_deterministic(config,peps,site1,site2,cache_bot,cache_top,sign_fn) * sign
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 613, in pair_energy_deterministic
    top_term = self.get_top_env(i,row,top_term,config_new,cache_top)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 258, in get_top_env
    tn.contract_boundary_from_top_(xrange=(i,i+1),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1351, in contract_boundary_from_top
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 848, in _contract_boundary_single
    canonize_fn(i, equalize_norms=equalize_norms)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 583, in canonize_row
    self.canonize_between((i, j), (i, j - 1), **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5110, in canonize_between
    self._canonize_between_tids(tid1, tid2, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5068, in _canonize_between_tids
    tensor_canonize_bond(Tl, Tr, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 897, in tensor_canonize_bond
    new_T1, tRfact = T1.split(left_env_ix, get='tensors', **split_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 815, in tensor_split
    left = reshape(left, (*left_dims, -1))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [0, 8, -1] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 632, in pair_energies_deterministic
    ex[site1,site2] = self.pair_energy_deterministic(config,peps,site1,site2,cache_bot,cache_top,sign_fn) * sign
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 606, in pair_energy_deterministic
    bot_term = self.get_bot_env(i,row,bot_term,config_new,cache_bot)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 224, in get_bot_env
    tn.contract_boundary_from_bottom_(xrange=(i-1,i),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1235, in contract_boundary_from_bottom
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 857, in _contract_boundary_single
    compress_opts=compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 723, in compress_row
    cutoff=cutoff, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5038, in compress_between
    **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 4942, in _compress_between_tids
    tensor_compress_bond(ta, tb, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 967, in tensor_compress_bond
    get='tensors', method='qr')
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 816, in tensor_split
    right = reshape(right, (-1, *right_dims))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [-1, 0] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 632, in pair_energies_deterministic
    ex[site1,site2] = self.pair_energy_deterministic(config,peps,site1,site2,cache_bot,cache_top,sign_fn) * sign
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 606, in pair_energy_deterministic
    bot_term = self.get_bot_env(i,row,bot_term,config_new,cache_bot)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 224, in get_bot_env
    tn.contract_boundary_from_bottom_(xrange=(i-1,i),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1235, in contract_boundary_from_bottom
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 848, in _contract_boundary_single
    canonize_fn(i, equalize_norms=equalize_norms)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 579, in canonize_row
    self.canonize_between((i, j), (i, j + 1), **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5110, in canonize_between
    self._canonize_between_tids(tid1, tid2, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5068, in _canonize_between_tids
    tensor_canonize_bond(Tl, Tr, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 897, in tensor_canonize_bond
    new_T1, tRfact = T1.split(left_env_ix, get='tensors', **split_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 815, in tensor_split
    left = reshape(left, (*left_dims, -1))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [0, 8, -1] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 632, in pair_energies_deterministic
    ex[site1,site2] = self.pair_energy_deterministic(config,peps,site1,site2,cache_bot,cache_top,sign_fn) * sign
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 613, in pair_energy_deterministic
    top_term = self.get_top_env(i,row,top_term,config_new,cache_top)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 258, in get_top_env
    tn.contract_boundary_from_top_(xrange=(i,i+1),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1351, in contract_boundary_from_top
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 848, in _contract_boundary_single
    canonize_fn(i, equalize_norms=equalize_norms)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 583, in canonize_row
    self.canonize_between((i, j), (i, j - 1), **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5110, in canonize_between
    self._canonize_between_tids(tid1, tid2, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5068, in _canonize_between_tids
    tensor_canonize_bond(Tl, Tr, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 897, in tensor_canonize_bond
    new_T1, tRfact = T1.split(left_env_ix, get='tensors', **split_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 815, in tensor_split
    left = reshape(left, (*left_dims, -1))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [0, 8, -1] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 632, in pair_energies_deterministic
    ex[site1,site2] = self.pair_energy_deterministic(config,peps,site1,site2,cache_bot,cache_top,sign_fn) * sign
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 606, in pair_energy_deterministic
    bot_term = self.get_bot_env(i,row,bot_term,config_new,cache_bot)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 224, in get_bot_env
    tn.contract_boundary_from_bottom_(xrange=(i-1,i),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1235, in contract_boundary_from_bottom
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 857, in _contract_boundary_single
    compress_opts=compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 723, in compress_row
    cutoff=cutoff, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5038, in compress_between
    **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 4942, in _compress_between_tids
    tensor_compress_bond(ta, tb, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 967, in tensor_compress_bond
    get='tensors', method='qr')
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 816, in tensor_split
    right = reshape(right, (-1, *right_dims))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [-1, 0] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 632, in pair_energies_deterministic
    ex[site1,site2] = self.pair_energy_deterministic(config,peps,site1,site2,cache_bot,cache_top,sign_fn) * sign
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 613, in pair_energy_deterministic
    top_term = self.get_top_env(i,row,top_term,config_new,cache_top)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 258, in get_top_env
    tn.contract_boundary_from_top_(xrange=(i,i+1),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1351, in contract_boundary_from_top
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 857, in _contract_boundary_single
    compress_opts=compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 719, in compress_row
    cutoff=cutoff, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5038, in compress_between
    **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 4942, in _compress_between_tids
    tensor_compress_bond(ta, tb, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 974, in tensor_compress_bond
    absorb=absorb, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 815, in tensor_split
    left = reshape(left, (*left_dims, -1))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [0, -1] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 632, in pair_energies_deterministic
    ex[site1,site2] = self.pair_energy_deterministic(config,peps,site1,site2,cache_bot,cache_top,sign_fn) * sign
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 613, in pair_energy_deterministic
    top_term = self.get_top_env(i,row,top_term,config_new,cache_top)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 258, in get_top_env
    tn.contract_boundary_from_top_(xrange=(i,i+1),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1351, in contract_boundary_from_top
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 857, in _contract_boundary_single
    compress_opts=compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 719, in compress_row
    cutoff=cutoff, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5038, in compress_between
    **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 4942, in _compress_between_tids
    tensor_compress_bond(ta, tb, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 974, in tensor_compress_bond
    absorb=absorb, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 815, in tensor_split
    left = reshape(left, (*left_dims, -1))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [0, -1] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 632, in pair_energies_deterministic
    ex[site1,site2] = self.pair_energy_deterministic(config,peps,site1,site2,cache_bot,cache_top,sign_fn) * sign
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 613, in pair_energy_deterministic
    top_term = self.get_top_env(i,row,top_term,config_new,cache_top)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 258, in get_top_env
    tn.contract_boundary_from_top_(xrange=(i,i+1),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1351, in contract_boundary_from_top
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 848, in _contract_boundary_single
    canonize_fn(i, equalize_norms=equalize_norms)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 583, in canonize_row
    self.canonize_between((i, j), (i, j - 1), **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5110, in canonize_between
    self._canonize_between_tids(tid1, tid2, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5068, in _canonize_between_tids
    tensor_canonize_bond(Tl, Tr, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 897, in tensor_canonize_bond
    new_T1, tRfact = T1.split(left_env_ix, get='tensors', **split_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 815, in tensor_split
    left = reshape(left, (*left_dims, -1))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [0, 8, -1] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 632, in pair_energies_deterministic
    ex[site1,site2] = self.pair_energy_deterministic(config,peps,site1,site2,cache_bot,cache_top,sign_fn) * sign
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 613, in pair_energy_deterministic
    top_term = self.get_top_env(i,row,top_term,config_new,cache_top)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 258, in get_top_env
    tn.contract_boundary_from_top_(xrange=(i,i+1),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1351, in contract_boundary_from_top
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 848, in _contract_boundary_single
    canonize_fn(i, equalize_norms=equalize_norms)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 583, in canonize_row
    self.canonize_between((i, j), (i, j - 1), **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5110, in canonize_between
    self._canonize_between_tids(tid1, tid2, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5068, in _canonize_between_tids
    tensor_canonize_bond(Tl, Tr, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 897, in tensor_canonize_bond
    new_T1, tRfact = T1.split(left_env_ix, get='tensors', **split_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 815, in tensor_split
    left = reshape(left, (*left_dims, -1))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [0, 8, -1] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 632, in pair_energies_deterministic
    ex[site1,site2] = self.pair_energy_deterministic(config,peps,site1,site2,cache_bot,cache_top,sign_fn) * sign
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 606, in pair_energy_deterministic
    bot_term = self.get_bot_env(i,row,bot_term,config_new,cache_bot)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 224, in get_bot_env
    tn.contract_boundary_from_bottom_(xrange=(i-1,i),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1235, in contract_boundary_from_bottom
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 848, in _contract_boundary_single
    canonize_fn(i, equalize_norms=equalize_norms)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 579, in canonize_row
    self.canonize_between((i, j), (i, j + 1), **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5110, in canonize_between
    self._canonize_between_tids(tid1, tid2, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5068, in _canonize_between_tids
    tensor_canonize_bond(Tl, Tr, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 897, in tensor_canonize_bond
    new_T1, tRfact = T1.split(left_env_ix, get='tensors', **split_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 815, in tensor_split
    left = reshape(left, (*left_dims, -1))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [0, 8, -1] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 632, in pair_energies_deterministic
    ex[site1,site2] = self.pair_energy_deterministic(config,peps,site1,site2,cache_bot,cache_top,sign_fn) * sign
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 613, in pair_energy_deterministic
    top_term = self.get_top_env(i,row,top_term,config_new,cache_top)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 258, in get_top_env
    tn.contract_boundary_from_top_(xrange=(i,i+1),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1351, in contract_boundary_from_top
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 848, in _contract_boundary_single
    canonize_fn(i, equalize_norms=equalize_norms)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 583, in canonize_row
    self.canonize_between((i, j), (i, j - 1), **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5110, in canonize_between
    self._canonize_between_tids(tid1, tid2, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5068, in _canonize_between_tids
    tensor_canonize_bond(Tl, Tr, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 897, in tensor_canonize_bond
    new_T1, tRfact = T1.split(left_env_ix, get='tensors', **split_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 815, in tensor_split
    left = reshape(left, (*left_dims, -1))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [0, 8, -1] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 632, in pair_energies_deterministic
    ex[site1,site2] = self.pair_energy_deterministic(config,peps,site1,site2,cache_bot,cache_top,sign_fn) * sign
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 613, in pair_energy_deterministic
    top_term = self.get_top_env(i,row,top_term,config_new,cache_top)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 258, in get_top_env
    tn.contract_boundary_from_top_(xrange=(i,i+1),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1351, in contract_boundary_from_top
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 857, in _contract_boundary_single
    compress_opts=compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 719, in compress_row
    cutoff=cutoff, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5038, in compress_between
    **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 4942, in _compress_between_tids
    tensor_compress_bond(ta, tb, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 967, in tensor_compress_bond
    get='tensors', method='qr')
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 816, in tensor_split
    right = reshape(right, (-1, *right_dims))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [-1, 0] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 632, in pair_energies_deterministic
    ex[site1,site2] = self.pair_energy_deterministic(config,peps,site1,site2,cache_bot,cache_top,sign_fn) * sign
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 613, in pair_energy_deterministic
    top_term = self.get_top_env(i,row,top_term,config_new,cache_top)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 258, in get_top_env
    tn.contract_boundary_from_top_(xrange=(i,i+1),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1351, in contract_boundary_from_top
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 857, in _contract_boundary_single
    compress_opts=compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 719, in compress_row
    cutoff=cutoff, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5038, in compress_between
    **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 4942, in _compress_between_tids
    tensor_compress_bond(ta, tb, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 967, in tensor_compress_bond
    get='tensors', method='qr')
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 816, in tensor_split
    right = reshape(right, (-1, *right_dims))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [-1, 0] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 632, in pair_energies_deterministic
    ex[site1,site2] = self.pair_energy_deterministic(config,peps,site1,site2,cache_bot,cache_top,sign_fn) * sign
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 613, in pair_energy_deterministic
    top_term = self.get_top_env(i,row,top_term,config_new,cache_top)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 258, in get_top_env
    tn.contract_boundary_from_top_(xrange=(i,i+1),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1351, in contract_boundary_from_top
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 857, in _contract_boundary_single
    compress_opts=compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 719, in compress_row
    cutoff=cutoff, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5038, in compress_between
    **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 4942, in _compress_between_tids
    tensor_compress_bond(ta, tb, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 967, in tensor_compress_bond
    get='tensors', method='qr')
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 816, in tensor_split
    right = reshape(right, (-1, *right_dims))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [-1, 0] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 632, in pair_energies_deterministic
    ex[site1,site2] = self.pair_energy_deterministic(config,peps,site1,site2,cache_bot,cache_top,sign_fn) * sign
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 613, in pair_energy_deterministic
    top_term = self.get_top_env(i,row,top_term,config_new,cache_top)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 258, in get_top_env
    tn.contract_boundary_from_top_(xrange=(i,i+1),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1351, in contract_boundary_from_top
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 848, in _contract_boundary_single
    canonize_fn(i, equalize_norms=equalize_norms)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 583, in canonize_row
    self.canonize_between((i, j), (i, j - 1), **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5110, in canonize_between
    self._canonize_between_tids(tid1, tid2, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5068, in _canonize_between_tids
    tensor_canonize_bond(Tl, Tr, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 897, in tensor_canonize_bond
    new_T1, tRfact = T1.split(left_env_ix, get='tensors', **split_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 815, in tensor_split
    left = reshape(left, (*left_dims, -1))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [0, 8, -1] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 632, in pair_energies_deterministic
    ex[site1,site2] = self.pair_energy_deterministic(config,peps,site1,site2,cache_bot,cache_top,sign_fn) * sign
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 606, in pair_energy_deterministic
    bot_term = self.get_bot_env(i,row,bot_term,config_new,cache_bot)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 224, in get_bot_env
    tn.contract_boundary_from_bottom_(xrange=(i-1,i),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1235, in contract_boundary_from_bottom
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 857, in _contract_boundary_single
    compress_opts=compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 723, in compress_row
    cutoff=cutoff, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5038, in compress_between
    **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 4942, in _compress_between_tids
    tensor_compress_bond(ta, tb, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 967, in tensor_compress_bond
    get='tensors', method='qr')
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 816, in tensor_split
    right = reshape(right, (-1, *right_dims))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [-1, 0] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 632, in pair_energies_deterministic
    ex[site1,site2] = self.pair_energy_deterministic(config,peps,site1,site2,cache_bot,cache_top,sign_fn) * sign
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 613, in pair_energy_deterministic
    top_term = self.get_top_env(i,row,top_term,config_new,cache_top)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 258, in get_top_env
    tn.contract_boundary_from_top_(xrange=(i,i+1),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1351, in contract_boundary_from_top
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 848, in _contract_boundary_single
    canonize_fn(i, equalize_norms=equalize_norms)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 583, in canonize_row
    self.canonize_between((i, j), (i, j - 1), **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5110, in canonize_between
    self._canonize_between_tids(tid1, tid2, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5068, in _canonize_between_tids
    tensor_canonize_bond(Tl, Tr, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 897, in tensor_canonize_bond
    new_T1, tRfact = T1.split(left_env_ix, get='tensors', **split_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 815, in tensor_split
    left = reshape(left, (*left_dims, -1))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [0, 8, -1] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 632, in pair_energies_deterministic
    ex[site1,site2] = self.pair_energy_deterministic(config,peps,site1,site2,cache_bot,cache_top,sign_fn) * sign
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 613, in pair_energy_deterministic
    top_term = self.get_top_env(i,row,top_term,config_new,cache_top)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 258, in get_top_env
    tn.contract_boundary_from_top_(xrange=(i,i+1),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1351, in contract_boundary_from_top
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 848, in _contract_boundary_single
    canonize_fn(i, equalize_norms=equalize_norms)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 583, in canonize_row
    self.canonize_between((i, j), (i, j - 1), **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5110, in canonize_between
    self._canonize_between_tids(tid1, tid2, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5068, in _canonize_between_tids
    tensor_canonize_bond(Tl, Tr, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 897, in tensor_canonize_bond
    new_T1, tRfact = T1.split(left_env_ix, get='tensors', **split_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 815, in tensor_split
    left = reshape(left, (*left_dims, -1))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [0, 8, -1] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 632, in pair_energies_deterministic
    ex[site1,site2] = self.pair_energy_deterministic(config,peps,site1,site2,cache_bot,cache_top,sign_fn) * sign
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 613, in pair_energy_deterministic
    top_term = self.get_top_env(i,row,top_term,config_new,cache_top)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 258, in get_top_env
    tn.contract_boundary_from_top_(xrange=(i,i+1),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1351, in contract_boundary_from_top
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 848, in _contract_boundary_single
    canonize_fn(i, equalize_norms=equalize_norms)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 583, in canonize_row
    self.canonize_between((i, j), (i, j - 1), **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5110, in canonize_between
    self._canonize_between_tids(tid1, tid2, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5068, in _canonize_between_tids
    tensor_canonize_bond(Tl, Tr, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 897, in tensor_canonize_bond
    new_T1, tRfact = T1.split(left_env_ix, get='tensors', **split_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 815, in tensor_split
    left = reshape(left, (*left_dims, -1))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [0, 8, -1] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 632, in pair_energies_deterministic
    ex[site1,site2] = self.pair_energy_deterministic(config,peps,site1,site2,cache_bot,cache_top,sign_fn) * sign
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 613, in pair_energy_deterministic
    top_term = self.get_top_env(i,row,top_term,config_new,cache_top)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 258, in get_top_env
    tn.contract_boundary_from_top_(xrange=(i,i+1),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1351, in contract_boundary_from_top
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 857, in _contract_boundary_single
    compress_opts=compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 719, in compress_row
    cutoff=cutoff, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5038, in compress_between
    **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 4942, in _compress_between_tids
    tensor_compress_bond(ta, tb, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 974, in tensor_compress_bond
    absorb=absorb, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 815, in tensor_split
    left = reshape(left, (*left_dims, -1))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [0, -1] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 632, in pair_energies_deterministic
    ex[site1,site2] = self.pair_energy_deterministic(config,peps,site1,site2,cache_bot,cache_top,sign_fn) * sign
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 613, in pair_energy_deterministic
    top_term = self.get_top_env(i,row,top_term,config_new,cache_top)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 258, in get_top_env
    tn.contract_boundary_from_top_(xrange=(i,i+1),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1351, in contract_boundary_from_top
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 857, in _contract_boundary_single
    compress_opts=compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 719, in compress_row
    cutoff=cutoff, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5038, in compress_between
    **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 4942, in _compress_between_tids
    tensor_compress_bond(ta, tb, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 967, in tensor_compress_bond
    get='tensors', method='qr')
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 816, in tensor_split
    right = reshape(right, (-1, *right_dims))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [-1, 0] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 632, in pair_energies_deterministic
    ex[site1,site2] = self.pair_energy_deterministic(config,peps,site1,site2,cache_bot,cache_top,sign_fn) * sign
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 613, in pair_energy_deterministic
    top_term = self.get_top_env(i,row,top_term,config_new,cache_top)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 258, in get_top_env
    tn.contract_boundary_from_top_(xrange=(i,i+1),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1351, in contract_boundary_from_top
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 848, in _contract_boundary_single
    canonize_fn(i, equalize_norms=equalize_norms)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 583, in canonize_row
    self.canonize_between((i, j), (i, j - 1), **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5110, in canonize_between
    self._canonize_between_tids(tid1, tid2, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5068, in _canonize_between_tids
    tensor_canonize_bond(Tl, Tr, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 897, in tensor_canonize_bond
    new_T1, tRfact = T1.split(left_env_ix, get='tensors', **split_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 815, in tensor_split
    left = reshape(left, (*left_dims, -1))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [0, 8, -1] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 632, in pair_energies_deterministic
    ex[site1,site2] = self.pair_energy_deterministic(config,peps,site1,site2,cache_bot,cache_top,sign_fn) * sign
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 606, in pair_energy_deterministic
    bot_term = self.get_bot_env(i,row,bot_term,config_new,cache_bot)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 224, in get_bot_env
    tn.contract_boundary_from_bottom_(xrange=(i-1,i),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1235, in contract_boundary_from_bottom
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 857, in _contract_boundary_single
    compress_opts=compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 723, in compress_row
    cutoff=cutoff, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5038, in compress_between
    **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 4942, in _compress_between_tids
    tensor_compress_bond(ta, tb, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 967, in tensor_compress_bond
    get='tensors', method='qr')
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 816, in tensor_split
    right = reshape(right, (-1, *right_dims))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [-1, 0] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 632, in pair_energies_deterministic
    ex[site1,site2] = self.pair_energy_deterministic(config,peps,site1,site2,cache_bot,cache_top,sign_fn) * sign
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 613, in pair_energy_deterministic
    top_term = self.get_top_env(i,row,top_term,config_new,cache_top)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 258, in get_top_env
    tn.contract_boundary_from_top_(xrange=(i,i+1),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1351, in contract_boundary_from_top
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 857, in _contract_boundary_single
    compress_opts=compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 719, in compress_row
    cutoff=cutoff, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5038, in compress_between
    **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 4942, in _compress_between_tids
    tensor_compress_bond(ta, tb, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 967, in tensor_compress_bond
    get='tensors', method='qr')
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 816, in tensor_split
    right = reshape(right, (-1, *right_dims))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [-1, 0] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 625, in pair_energies_deterministic
    env_bot,env_top = self.get_all_benvs(peps,config,cache_bot,cache_top)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 275, in get_all_benvs
    env_bot = self.get_all_bot_envs(peps,config,cache_bot,imax=imax)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 235, in get_all_bot_envs
    env_prev = self.get_bot_env(i,row,env_prev,config,cache_bot)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 224, in get_bot_env
    tn.contract_boundary_from_bottom_(xrange=(i-1,i),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1235, in contract_boundary_from_bottom
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 848, in _contract_boundary_single
    canonize_fn(i, equalize_norms=equalize_norms)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 579, in canonize_row
    self.canonize_between((i, j), (i, j + 1), **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5110, in canonize_between
    self._canonize_between_tids(tid1, tid2, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5068, in _canonize_between_tids
    tensor_canonize_bond(Tl, Tr, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 897, in tensor_canonize_bond
    new_T1, tRfact = T1.split(left_env_ix, get='tensors', **split_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 815, in tensor_split
    left = reshape(left, (*left_dims, -1))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [0, 8, -1] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 632, in pair_energies_deterministic
    ex[site1,site2] = self.pair_energy_deterministic(config,peps,site1,site2,cache_bot,cache_top,sign_fn) * sign
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 613, in pair_energy_deterministic
    top_term = self.get_top_env(i,row,top_term,config_new,cache_top)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 258, in get_top_env
    tn.contract_boundary_from_top_(xrange=(i,i+1),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1351, in contract_boundary_from_top
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 857, in _contract_boundary_single
    compress_opts=compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 719, in compress_row
    cutoff=cutoff, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5038, in compress_between
    **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 4942, in _compress_between_tids
    tensor_compress_bond(ta, tb, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 974, in tensor_compress_bond
    absorb=absorb, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 815, in tensor_split
    left = reshape(left, (*left_dims, -1))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [0, -1] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 632, in pair_energies_deterministic
    ex[site1,site2] = self.pair_energy_deterministic(config,peps,site1,site2,cache_bot,cache_top,sign_fn) * sign
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 606, in pair_energy_deterministic
    bot_term = self.get_bot_env(i,row,bot_term,config_new,cache_bot)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 224, in get_bot_env
    tn.contract_boundary_from_bottom_(xrange=(i-1,i),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1235, in contract_boundary_from_bottom
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 848, in _contract_boundary_single
    canonize_fn(i, equalize_norms=equalize_norms)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 579, in canonize_row
    self.canonize_between((i, j), (i, j + 1), **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5110, in canonize_between
    self._canonize_between_tids(tid1, tid2, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5068, in _canonize_between_tids
    tensor_canonize_bond(Tl, Tr, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 897, in tensor_canonize_bond
    new_T1, tRfact = T1.split(left_env_ix, get='tensors', **split_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 815, in tensor_split
    left = reshape(left, (*left_dims, -1))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [0, 8, -1] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 632, in pair_energies_deterministic
    ex[site1,site2] = self.pair_energy_deterministic(config,peps,site1,site2,cache_bot,cache_top,sign_fn) * sign
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 613, in pair_energy_deterministic
    top_term = self.get_top_env(i,row,top_term,config_new,cache_top)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 258, in get_top_env
    tn.contract_boundary_from_top_(xrange=(i,i+1),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1351, in contract_boundary_from_top
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 848, in _contract_boundary_single
    canonize_fn(i, equalize_norms=equalize_norms)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 583, in canonize_row
    self.canonize_between((i, j), (i, j - 1), **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5110, in canonize_between
    self._canonize_between_tids(tid1, tid2, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5068, in _canonize_between_tids
    tensor_canonize_bond(Tl, Tr, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 897, in tensor_canonize_bond
    new_T1, tRfact = T1.split(left_env_ix, get='tensors', **split_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 815, in tensor_split
    left = reshape(left, (*left_dims, -1))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [0, 8, -1] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 632, in pair_energies_deterministic
    ex[site1,site2] = self.pair_energy_deterministic(config,peps,site1,site2,cache_bot,cache_top,sign_fn) * sign
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 613, in pair_energy_deterministic
    top_term = self.get_top_env(i,row,top_term,config_new,cache_top)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 258, in get_top_env
    tn.contract_boundary_from_top_(xrange=(i,i+1),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1351, in contract_boundary_from_top
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 857, in _contract_boundary_single
    compress_opts=compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 719, in compress_row
    cutoff=cutoff, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5038, in compress_between
    **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 4942, in _compress_between_tids
    tensor_compress_bond(ta, tb, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 974, in tensor_compress_bond
    absorb=absorb, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 815, in tensor_split
    left = reshape(left, (*left_dims, -1))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [0, -1] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 632, in pair_energies_deterministic
    ex[site1,site2] = self.pair_energy_deterministic(config,peps,site1,site2,cache_bot,cache_top,sign_fn) * sign
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 613, in pair_energy_deterministic
    top_term = self.get_top_env(i,row,top_term,config_new,cache_top)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 258, in get_top_env
    tn.contract_boundary_from_top_(xrange=(i,i+1),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1351, in contract_boundary_from_top
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 848, in _contract_boundary_single
    canonize_fn(i, equalize_norms=equalize_norms)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 583, in canonize_row
    self.canonize_between((i, j), (i, j - 1), **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5110, in canonize_between
    self._canonize_between_tids(tid1, tid2, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5068, in _canonize_between_tids
    tensor_canonize_bond(Tl, Tr, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 897, in tensor_canonize_bond
    new_T1, tRfact = T1.split(left_env_ix, get='tensors', **split_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 815, in tensor_split
    left = reshape(left, (*left_dims, -1))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [0, 8, -1] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 632, in pair_energies_deterministic
    ex[site1,site2] = self.pair_energy_deterministic(config,peps,site1,site2,cache_bot,cache_top,sign_fn) * sign
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 613, in pair_energy_deterministic
    top_term = self.get_top_env(i,row,top_term,config_new,cache_top)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 258, in get_top_env
    tn.contract_boundary_from_top_(xrange=(i,i+1),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1351, in contract_boundary_from_top
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 848, in _contract_boundary_single
    canonize_fn(i, equalize_norms=equalize_norms)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 583, in canonize_row
    self.canonize_between((i, j), (i, j - 1), **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5110, in canonize_between
    self._canonize_between_tids(tid1, tid2, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5068, in _canonize_between_tids
    tensor_canonize_bond(Tl, Tr, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 897, in tensor_canonize_bond
    new_T1, tRfact = T1.split(left_env_ix, get='tensors', **split_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 815, in tensor_split
    left = reshape(left, (*left_dims, -1))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [0, 8, -1] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 632, in pair_energies_deterministic
    ex[site1,site2] = self.pair_energy_deterministic(config,peps,site1,site2,cache_bot,cache_top,sign_fn) * sign
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 606, in pair_energy_deterministic
    bot_term = self.get_bot_env(i,row,bot_term,config_new,cache_bot)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 224, in get_bot_env
    tn.contract_boundary_from_bottom_(xrange=(i-1,i),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1235, in contract_boundary_from_bottom
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 848, in _contract_boundary_single
    canonize_fn(i, equalize_norms=equalize_norms)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 579, in canonize_row
    self.canonize_between((i, j), (i, j + 1), **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5110, in canonize_between
    self._canonize_between_tids(tid1, tid2, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5068, in _canonize_between_tids
    tensor_canonize_bond(Tl, Tr, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 897, in tensor_canonize_bond
    new_T1, tRfact = T1.split(left_env_ix, get='tensors', **split_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 815, in tensor_split
    left = reshape(left, (*left_dims, -1))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [0, 8, -1] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 625, in pair_energies_deterministic
    env_bot,env_top = self.get_all_benvs(peps,config,cache_bot,cache_top)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 275, in get_all_benvs
    env_bot = self.get_all_bot_envs(peps,config,cache_bot,imax=imax)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 235, in get_all_bot_envs
    env_prev = self.get_bot_env(i,row,env_prev,config,cache_bot)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 224, in get_bot_env
    tn.contract_boundary_from_bottom_(xrange=(i-1,i),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1235, in contract_boundary_from_bottom
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 848, in _contract_boundary_single
    canonize_fn(i, equalize_norms=equalize_norms)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 579, in canonize_row
    self.canonize_between((i, j), (i, j + 1), **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5110, in canonize_between
    self._canonize_between_tids(tid1, tid2, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5068, in _canonize_between_tids
    tensor_canonize_bond(Tl, Tr, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 897, in tensor_canonize_bond
    new_T1, tRfact = T1.split(left_env_ix, get='tensors', **split_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 815, in tensor_split
    left = reshape(left, (*left_dims, -1))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [0, 8, -1] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 625, in pair_energies_deterministic
    env_bot,env_top = self.get_all_benvs(peps,config,cache_bot,cache_top)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 275, in get_all_benvs
    env_bot = self.get_all_bot_envs(peps,config,cache_bot,imax=imax)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 235, in get_all_bot_envs
    env_prev = self.get_bot_env(i,row,env_prev,config,cache_bot)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 224, in get_bot_env
    tn.contract_boundary_from_bottom_(xrange=(i-1,i),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1235, in contract_boundary_from_bottom
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 857, in _contract_boundary_single
    compress_opts=compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 723, in compress_row
    cutoff=cutoff, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5038, in compress_between
    **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 4942, in _compress_between_tids
    tensor_compress_bond(ta, tb, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 974, in tensor_compress_bond
    absorb=absorb, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 815, in tensor_split
    left = reshape(left, (*left_dims, -1))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [0, -1] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 625, in pair_energies_deterministic
    env_bot,env_top = self.get_all_benvs(peps,config,cache_bot,cache_top)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 275, in get_all_benvs
    env_bot = self.get_all_bot_envs(peps,config,cache_bot,imax=imax)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 235, in get_all_bot_envs
    env_prev = self.get_bot_env(i,row,env_prev,config,cache_bot)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 224, in get_bot_env
    tn.contract_boundary_from_bottom_(xrange=(i-1,i),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1235, in contract_boundary_from_bottom
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 857, in _contract_boundary_single
    compress_opts=compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 723, in compress_row
    cutoff=cutoff, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5038, in compress_between
    **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 4942, in _compress_between_tids
    tensor_compress_bond(ta, tb, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 967, in tensor_compress_bond
    get='tensors', method='qr')
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 816, in tensor_split
    right = reshape(right, (-1, *right_dims))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [-1, 0] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 632, in pair_energies_deterministic
    ex[site1,site2] = self.pair_energy_deterministic(config,peps,site1,site2,cache_bot,cache_top,sign_fn) * sign
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 606, in pair_energy_deterministic
    bot_term = self.get_bot_env(i,row,bot_term,config_new,cache_bot)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 224, in get_bot_env
    tn.contract_boundary_from_bottom_(xrange=(i-1,i),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1235, in contract_boundary_from_bottom
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 848, in _contract_boundary_single
    canonize_fn(i, equalize_norms=equalize_norms)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 579, in canonize_row
    self.canonize_between((i, j), (i, j + 1), **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5110, in canonize_between
    self._canonize_between_tids(tid1, tid2, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5068, in _canonize_between_tids
    tensor_canonize_bond(Tl, Tr, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 897, in tensor_canonize_bond
    new_T1, tRfact = T1.split(left_env_ix, get='tensors', **split_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 815, in tensor_split
    left = reshape(left, (*left_dims, -1))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [0, 8, -1] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 632, in pair_energies_deterministic
    ex[site1,site2] = self.pair_energy_deterministic(config,peps,site1,site2,cache_bot,cache_top,sign_fn) * sign
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 606, in pair_energy_deterministic
    bot_term = self.get_bot_env(i,row,bot_term,config_new,cache_bot)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 224, in get_bot_env
    tn.contract_boundary_from_bottom_(xrange=(i-1,i),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1235, in contract_boundary_from_bottom
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 848, in _contract_boundary_single
    canonize_fn(i, equalize_norms=equalize_norms)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 579, in canonize_row
    self.canonize_between((i, j), (i, j + 1), **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5110, in canonize_between
    self._canonize_between_tids(tid1, tid2, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5068, in _canonize_between_tids
    tensor_canonize_bond(Tl, Tr, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 897, in tensor_canonize_bond
    new_T1, tRfact = T1.split(left_env_ix, get='tensors', **split_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 815, in tensor_split
    left = reshape(left, (*left_dims, -1))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [0, 8, -1] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 632, in pair_energies_deterministic
    ex[site1,site2] = self.pair_energy_deterministic(config,peps,site1,site2,cache_bot,cache_top,sign_fn) * sign
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 606, in pair_energy_deterministic
    bot_term = self.get_bot_env(i,row,bot_term,config_new,cache_bot)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 224, in get_bot_env
    tn.contract_boundary_from_bottom_(xrange=(i-1,i),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1235, in contract_boundary_from_bottom
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 848, in _contract_boundary_single
    canonize_fn(i, equalize_norms=equalize_norms)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 579, in canonize_row
    self.canonize_between((i, j), (i, j + 1), **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5110, in canonize_between
    self._canonize_between_tids(tid1, tid2, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5068, in _canonize_between_tids
    tensor_canonize_bond(Tl, Tr, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 897, in tensor_canonize_bond
    new_T1, tRfact = T1.split(left_env_ix, get='tensors', **split_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 815, in tensor_split
    left = reshape(left, (*left_dims, -1))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [0, 8, -1] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 625, in pair_energies_deterministic
    env_bot,env_top = self.get_all_benvs(peps,config,cache_bot,cache_top)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 278, in get_all_benvs
    env_top = self.get_all_top_envs(peps,config,cache_top,imin=imin)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 268, in get_all_top_envs
    env_prev = self.get_top_env(i,row,env_prev,config,cache_top)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 258, in get_top_env
    tn.contract_boundary_from_top_(xrange=(i,i+1),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1351, in contract_boundary_from_top
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 848, in _contract_boundary_single
    canonize_fn(i, equalize_norms=equalize_norms)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 583, in canonize_row
    self.canonize_between((i, j), (i, j - 1), **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5110, in canonize_between
    self._canonize_between_tids(tid1, tid2, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5068, in _canonize_between_tids
    tensor_canonize_bond(Tl, Tr, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 897, in tensor_canonize_bond
    new_T1, tRfact = T1.split(left_env_ix, get='tensors', **split_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 815, in tensor_split
    left = reshape(left, (*left_dims, -1))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [0, 8, -1] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 632, in pair_energies_deterministic
    ex[site1,site2] = self.pair_energy_deterministic(config,peps,site1,site2,cache_bot,cache_top,sign_fn) * sign
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 606, in pair_energy_deterministic
    bot_term = self.get_bot_env(i,row,bot_term,config_new,cache_bot)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 224, in get_bot_env
    tn.contract_boundary_from_bottom_(xrange=(i-1,i),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1235, in contract_boundary_from_bottom
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 848, in _contract_boundary_single
    canonize_fn(i, equalize_norms=equalize_norms)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 579, in canonize_row
    self.canonize_between((i, j), (i, j + 1), **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5110, in canonize_between
    self._canonize_between_tids(tid1, tid2, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5068, in _canonize_between_tids
    tensor_canonize_bond(Tl, Tr, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 897, in tensor_canonize_bond
    new_T1, tRfact = T1.split(left_env_ix, get='tensors', **split_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 815, in tensor_split
    left = reshape(left, (*left_dims, -1))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [0, 8, -1] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 625, in pair_energies_deterministic
    env_bot,env_top = self.get_all_benvs(peps,config,cache_bot,cache_top)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 275, in get_all_benvs
    env_bot = self.get_all_bot_envs(peps,config,cache_bot,imax=imax)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 235, in get_all_bot_envs
    env_prev = self.get_bot_env(i,row,env_prev,config,cache_bot)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 224, in get_bot_env
    tn.contract_boundary_from_bottom_(xrange=(i-1,i),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1235, in contract_boundary_from_bottom
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 848, in _contract_boundary_single
    canonize_fn(i, equalize_norms=equalize_norms)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 579, in canonize_row
    self.canonize_between((i, j), (i, j + 1), **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5110, in canonize_between
    self._canonize_between_tids(tid1, tid2, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5068, in _canonize_between_tids
    tensor_canonize_bond(Tl, Tr, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 897, in tensor_canonize_bond
    new_T1, tRfact = T1.split(left_env_ix, get='tensors', **split_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 815, in tensor_split
    left = reshape(left, (*left_dims, -1))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [0, 8, -1] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 625, in pair_energies_deterministic
    env_bot,env_top = self.get_all_benvs(peps,config,cache_bot,cache_top)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 278, in get_all_benvs
    env_top = self.get_all_top_envs(peps,config,cache_top,imin=imin)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 268, in get_all_top_envs
    env_prev = self.get_top_env(i,row,env_prev,config,cache_top)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 258, in get_top_env
    tn.contract_boundary_from_top_(xrange=(i,i+1),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1351, in contract_boundary_from_top
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 848, in _contract_boundary_single
    canonize_fn(i, equalize_norms=equalize_norms)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 583, in canonize_row
    self.canonize_between((i, j), (i, j - 1), **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5110, in canonize_between
    self._canonize_between_tids(tid1, tid2, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5068, in _canonize_between_tids
    tensor_canonize_bond(Tl, Tr, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 897, in tensor_canonize_bond
    new_T1, tRfact = T1.split(left_env_ix, get='tensors', **split_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 815, in tensor_split
    left = reshape(left, (*left_dims, -1))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [0, 8, -1] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 625, in pair_energies_deterministic
    env_bot,env_top = self.get_all_benvs(peps,config,cache_bot,cache_top)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 275, in get_all_benvs
    env_bot = self.get_all_bot_envs(peps,config,cache_bot,imax=imax)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 235, in get_all_bot_envs
    env_prev = self.get_bot_env(i,row,env_prev,config,cache_bot)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 224, in get_bot_env
    tn.contract_boundary_from_bottom_(xrange=(i-1,i),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1235, in contract_boundary_from_bottom
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 857, in _contract_boundary_single
    compress_opts=compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 723, in compress_row
    cutoff=cutoff, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5038, in compress_between
    **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 4942, in _compress_between_tids
    tensor_compress_bond(ta, tb, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 974, in tensor_compress_bond
    absorb=absorb, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 815, in tensor_split
    left = reshape(left, (*left_dims, -1))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [0, -1] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 625, in pair_energies_deterministic
    env_bot,env_top = self.get_all_benvs(peps,config,cache_bot,cache_top)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 275, in get_all_benvs
    env_bot = self.get_all_bot_envs(peps,config,cache_bot,imax=imax)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 235, in get_all_bot_envs
    env_prev = self.get_bot_env(i,row,env_prev,config,cache_bot)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 224, in get_bot_env
    tn.contract_boundary_from_bottom_(xrange=(i-1,i),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1235, in contract_boundary_from_bottom
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 857, in _contract_boundary_single
    compress_opts=compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 723, in compress_row
    cutoff=cutoff, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5038, in compress_between
    **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 4942, in _compress_between_tids
    tensor_compress_bond(ta, tb, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 967, in tensor_compress_bond
    get='tensors', method='qr')
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 816, in tensor_split
    right = reshape(right, (-1, *right_dims))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [-1, 0] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 632, in pair_energies_deterministic
    ex[site1,site2] = self.pair_energy_deterministic(config,peps,site1,site2,cache_bot,cache_top,sign_fn) * sign
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 606, in pair_energy_deterministic
    bot_term = self.get_bot_env(i,row,bot_term,config_new,cache_bot)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 224, in get_bot_env
    tn.contract_boundary_from_bottom_(xrange=(i-1,i),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1235, in contract_boundary_from_bottom
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 848, in _contract_boundary_single
    canonize_fn(i, equalize_norms=equalize_norms)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 579, in canonize_row
    self.canonize_between((i, j), (i, j + 1), **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5110, in canonize_between
    self._canonize_between_tids(tid1, tid2, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5068, in _canonize_between_tids
    tensor_canonize_bond(Tl, Tr, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 897, in tensor_canonize_bond
    new_T1, tRfact = T1.split(left_env_ix, get='tensors', **split_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 815, in tensor_split
    left = reshape(left, (*left_dims, -1))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [0, 8, -1] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 632, in pair_energies_deterministic
    ex[site1,site2] = self.pair_energy_deterministic(config,peps,site1,site2,cache_bot,cache_top,sign_fn) * sign
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 606, in pair_energy_deterministic
    bot_term = self.get_bot_env(i,row,bot_term,config_new,cache_bot)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 224, in get_bot_env
    tn.contract_boundary_from_bottom_(xrange=(i-1,i),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1235, in contract_boundary_from_bottom
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 857, in _contract_boundary_single
    compress_opts=compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 723, in compress_row
    cutoff=cutoff, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5038, in compress_between
    **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 4942, in _compress_between_tids
    tensor_compress_bond(ta, tb, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 967, in tensor_compress_bond
    get='tensors', method='qr')
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 816, in tensor_split
    right = reshape(right, (-1, *right_dims))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [-1, 0] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 632, in pair_energies_deterministic
    ex[site1,site2] = self.pair_energy_deterministic(config,peps,site1,site2,cache_bot,cache_top,sign_fn) * sign
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 606, in pair_energy_deterministic
    bot_term = self.get_bot_env(i,row,bot_term,config_new,cache_bot)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 224, in get_bot_env
    tn.contract_boundary_from_bottom_(xrange=(i-1,i),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1235, in contract_boundary_from_bottom
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 857, in _contract_boundary_single
    compress_opts=compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 723, in compress_row
    cutoff=cutoff, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5038, in compress_between
    **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 4942, in _compress_between_tids
    tensor_compress_bond(ta, tb, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 974, in tensor_compress_bond
    absorb=absorb, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 815, in tensor_split
    left = reshape(left, (*left_dims, -1))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [0, -1] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 632, in pair_energies_deterministic
    ex[site1,site2] = self.pair_energy_deterministic(config,peps,site1,site2,cache_bot,cache_top,sign_fn) * sign
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 606, in pair_energy_deterministic
    bot_term = self.get_bot_env(i,row,bot_term,config_new,cache_bot)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 224, in get_bot_env
    tn.contract_boundary_from_bottom_(xrange=(i-1,i),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1235, in contract_boundary_from_bottom
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 848, in _contract_boundary_single
    canonize_fn(i, equalize_norms=equalize_norms)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 579, in canonize_row
    self.canonize_between((i, j), (i, j + 1), **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5110, in canonize_between
    self._canonize_between_tids(tid1, tid2, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5068, in _canonize_between_tids
    tensor_canonize_bond(Tl, Tr, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 897, in tensor_canonize_bond
    new_T1, tRfact = T1.split(left_env_ix, get='tensors', **split_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 815, in tensor_split
    left = reshape(left, (*left_dims, -1))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [0, 8, -1] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 632, in pair_energies_deterministic
    ex[site1,site2] = self.pair_energy_deterministic(config,peps,site1,site2,cache_bot,cache_top,sign_fn) * sign
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 606, in pair_energy_deterministic
    bot_term = self.get_bot_env(i,row,bot_term,config_new,cache_bot)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 224, in get_bot_env
    tn.contract_boundary_from_bottom_(xrange=(i-1,i),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1235, in contract_boundary_from_bottom
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 857, in _contract_boundary_single
    compress_opts=compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 723, in compress_row
    cutoff=cutoff, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5038, in compress_between
    **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 4942, in _compress_between_tids
    tensor_compress_bond(ta, tb, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 967, in tensor_compress_bond
    get='tensors', method='qr')
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 816, in tensor_split
    right = reshape(right, (-1, *right_dims))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [-1, 0] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 632, in pair_energies_deterministic
    ex[site1,site2] = self.pair_energy_deterministic(config,peps,site1,site2,cache_bot,cache_top,sign_fn) * sign
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 606, in pair_energy_deterministic
    bot_term = self.get_bot_env(i,row,bot_term,config_new,cache_bot)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 224, in get_bot_env
    tn.contract_boundary_from_bottom_(xrange=(i-1,i),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1235, in contract_boundary_from_bottom
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 848, in _contract_boundary_single
    canonize_fn(i, equalize_norms=equalize_norms)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 579, in canonize_row
    self.canonize_between((i, j), (i, j + 1), **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5110, in canonize_between
    self._canonize_between_tids(tid1, tid2, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5068, in _canonize_between_tids
    tensor_canonize_bond(Tl, Tr, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 897, in tensor_canonize_bond
    new_T1, tRfact = T1.split(left_env_ix, get='tensors', **split_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 815, in tensor_split
    left = reshape(left, (*left_dims, -1))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [0, 8, -1] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 632, in pair_energies_deterministic
    ex[site1,site2] = self.pair_energy_deterministic(config,peps,site1,site2,cache_bot,cache_top,sign_fn) * sign
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 613, in pair_energy_deterministic
    top_term = self.get_top_env(i,row,top_term,config_new,cache_top)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 258, in get_top_env
    tn.contract_boundary_from_top_(xrange=(i,i+1),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1351, in contract_boundary_from_top
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 857, in _contract_boundary_single
    compress_opts=compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 719, in compress_row
    cutoff=cutoff, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5038, in compress_between
    **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 4942, in _compress_between_tids
    tensor_compress_bond(ta, tb, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 967, in tensor_compress_bond
    get='tensors', method='qr')
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 816, in tensor_split
    right = reshape(right, (-1, *right_dims))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [-1, 0] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 632, in pair_energies_deterministic
    ex[site1,site2] = self.pair_energy_deterministic(config,peps,site1,site2,cache_bot,cache_top,sign_fn) * sign
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 606, in pair_energy_deterministic
    bot_term = self.get_bot_env(i,row,bot_term,config_new,cache_bot)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 224, in get_bot_env
    tn.contract_boundary_from_bottom_(xrange=(i-1,i),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1235, in contract_boundary_from_bottom
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 848, in _contract_boundary_single
    canonize_fn(i, equalize_norms=equalize_norms)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 579, in canonize_row
    self.canonize_between((i, j), (i, j + 1), **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5110, in canonize_between
    self._canonize_between_tids(tid1, tid2, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5068, in _canonize_between_tids
    tensor_canonize_bond(Tl, Tr, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 897, in tensor_canonize_bond
    new_T1, tRfact = T1.split(left_env_ix, get='tensors', **split_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 815, in tensor_split
    left = reshape(left, (*left_dims, -1))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [0, 8, -1] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 632, in pair_energies_deterministic
    ex[site1,site2] = self.pair_energy_deterministic(config,peps,site1,site2,cache_bot,cache_top,sign_fn) * sign
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 606, in pair_energy_deterministic
    bot_term = self.get_bot_env(i,row,bot_term,config_new,cache_bot)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 224, in get_bot_env
    tn.contract_boundary_from_bottom_(xrange=(i-1,i),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1235, in contract_boundary_from_bottom
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 857, in _contract_boundary_single
    compress_opts=compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 723, in compress_row
    cutoff=cutoff, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5038, in compress_between
    **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 4942, in _compress_between_tids
    tensor_compress_bond(ta, tb, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 967, in tensor_compress_bond
    get='tensors', method='qr')
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 816, in tensor_split
    right = reshape(right, (-1, *right_dims))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [-1, 0] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 632, in pair_energies_deterministic
    ex[site1,site2] = self.pair_energy_deterministic(config,peps,site1,site2,cache_bot,cache_top,sign_fn) * sign
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 606, in pair_energy_deterministic
    bot_term = self.get_bot_env(i,row,bot_term,config_new,cache_bot)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 224, in get_bot_env
    tn.contract_boundary_from_bottom_(xrange=(i-1,i),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1235, in contract_boundary_from_bottom
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 857, in _contract_boundary_single
    compress_opts=compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 723, in compress_row
    cutoff=cutoff, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5038, in compress_between
    **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 4942, in _compress_between_tids
    tensor_compress_bond(ta, tb, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 967, in tensor_compress_bond
    get='tensors', method='qr')
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 816, in tensor_split
    right = reshape(right, (-1, *right_dims))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [-1, 0] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 632, in pair_energies_deterministic
    ex[site1,site2] = self.pair_energy_deterministic(config,peps,site1,site2,cache_bot,cache_top,sign_fn) * sign
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 613, in pair_energy_deterministic
    top_term = self.get_top_env(i,row,top_term,config_new,cache_top)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 258, in get_top_env
    tn.contract_boundary_from_top_(xrange=(i,i+1),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1351, in contract_boundary_from_top
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 848, in _contract_boundary_single
    canonize_fn(i, equalize_norms=equalize_norms)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 583, in canonize_row
    self.canonize_between((i, j), (i, j - 1), **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5110, in canonize_between
    self._canonize_between_tids(tid1, tid2, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5068, in _canonize_between_tids
    tensor_canonize_bond(Tl, Tr, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 897, in tensor_canonize_bond
    new_T1, tRfact = T1.split(left_env_ix, get='tensors', **split_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 815, in tensor_split
    left = reshape(left, (*left_dims, -1))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [0, 8, -1] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 632, in pair_energies_deterministic
    ex[site1,site2] = self.pair_energy_deterministic(config,peps,site1,site2,cache_bot,cache_top,sign_fn) * sign
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 613, in pair_energy_deterministic
    top_term = self.get_top_env(i,row,top_term,config_new,cache_top)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 258, in get_top_env
    tn.contract_boundary_from_top_(xrange=(i,i+1),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1351, in contract_boundary_from_top
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 848, in _contract_boundary_single
    canonize_fn(i, equalize_norms=equalize_norms)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 583, in canonize_row
    self.canonize_between((i, j), (i, j - 1), **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5110, in canonize_between
    self._canonize_between_tids(tid1, tid2, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5068, in _canonize_between_tids
    tensor_canonize_bond(Tl, Tr, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 897, in tensor_canonize_bond
    new_T1, tRfact = T1.split(left_env_ix, get='tensors', **split_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 815, in tensor_split
    left = reshape(left, (*left_dims, -1))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [0, 8, -1] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 632, in pair_energies_deterministic
    ex[site1,site2] = self.pair_energy_deterministic(config,peps,site1,site2,cache_bot,cache_top,sign_fn) * sign
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 606, in pair_energy_deterministic
    bot_term = self.get_bot_env(i,row,bot_term,config_new,cache_bot)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 224, in get_bot_env
    tn.contract_boundary_from_bottom_(xrange=(i-1,i),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1235, in contract_boundary_from_bottom
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 848, in _contract_boundary_single
    canonize_fn(i, equalize_norms=equalize_norms)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 579, in canonize_row
    self.canonize_between((i, j), (i, j + 1), **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5110, in canonize_between
    self._canonize_between_tids(tid1, tid2, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5068, in _canonize_between_tids
    tensor_canonize_bond(Tl, Tr, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 897, in tensor_canonize_bond
    new_T1, tRfact = T1.split(left_env_ix, get='tensors', **split_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 815, in tensor_split
    left = reshape(left, (*left_dims, -1))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [0, 8, -1] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 632, in pair_energies_deterministic
    ex[site1,site2] = self.pair_energy_deterministic(config,peps,site1,site2,cache_bot,cache_top,sign_fn) * sign
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 606, in pair_energy_deterministic
    bot_term = self.get_bot_env(i,row,bot_term,config_new,cache_bot)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 224, in get_bot_env
    tn.contract_boundary_from_bottom_(xrange=(i-1,i),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1235, in contract_boundary_from_bottom
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 857, in _contract_boundary_single
    compress_opts=compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 723, in compress_row
    cutoff=cutoff, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5038, in compress_between
    **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 4942, in _compress_between_tids
    tensor_compress_bond(ta, tb, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 974, in tensor_compress_bond
    absorb=absorb, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 815, in tensor_split
    left = reshape(left, (*left_dims, -1))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [0, -1] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 632, in pair_energies_deterministic
    ex[site1,site2] = self.pair_energy_deterministic(config,peps,site1,site2,cache_bot,cache_top,sign_fn) * sign
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 606, in pair_energy_deterministic
    bot_term = self.get_bot_env(i,row,bot_term,config_new,cache_bot)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 224, in get_bot_env
    tn.contract_boundary_from_bottom_(xrange=(i-1,i),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1235, in contract_boundary_from_bottom
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 857, in _contract_boundary_single
    compress_opts=compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 723, in compress_row
    cutoff=cutoff, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5038, in compress_between
    **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 4942, in _compress_between_tids
    tensor_compress_bond(ta, tb, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 967, in tensor_compress_bond
    get='tensors', method='qr')
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 816, in tensor_split
    right = reshape(right, (-1, *right_dims))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [-1, 0] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 632, in pair_energies_deterministic
    ex[site1,site2] = self.pair_energy_deterministic(config,peps,site1,site2,cache_bot,cache_top,sign_fn) * sign
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 606, in pair_energy_deterministic
    bot_term = self.get_bot_env(i,row,bot_term,config_new,cache_bot)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 224, in get_bot_env
    tn.contract_boundary_from_bottom_(xrange=(i-1,i),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1235, in contract_boundary_from_bottom
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 848, in _contract_boundary_single
    canonize_fn(i, equalize_norms=equalize_norms)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 579, in canonize_row
    self.canonize_between((i, j), (i, j + 1), **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5110, in canonize_between
    self._canonize_between_tids(tid1, tid2, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5068, in _canonize_between_tids
    tensor_canonize_bond(Tl, Tr, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 897, in tensor_canonize_bond
    new_T1, tRfact = T1.split(left_env_ix, get='tensors', **split_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 815, in tensor_split
    left = reshape(left, (*left_dims, -1))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [0, 8, -1] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 632, in pair_energies_deterministic
    ex[site1,site2] = self.pair_energy_deterministic(config,peps,site1,site2,cache_bot,cache_top,sign_fn) * sign
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 613, in pair_energy_deterministic
    top_term = self.get_top_env(i,row,top_term,config_new,cache_top)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 258, in get_top_env
    tn.contract_boundary_from_top_(xrange=(i,i+1),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1351, in contract_boundary_from_top
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 848, in _contract_boundary_single
    canonize_fn(i, equalize_norms=equalize_norms)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 583, in canonize_row
    self.canonize_between((i, j), (i, j - 1), **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5110, in canonize_between
    self._canonize_between_tids(tid1, tid2, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5068, in _canonize_between_tids
    tensor_canonize_bond(Tl, Tr, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 897, in tensor_canonize_bond
    new_T1, tRfact = T1.split(left_env_ix, get='tensors', **split_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 815, in tensor_split
    left = reshape(left, (*left_dims, -1))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [0, 8, -1] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 632, in pair_energies_deterministic
    ex[site1,site2] = self.pair_energy_deterministic(config,peps,site1,site2,cache_bot,cache_top,sign_fn) * sign
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 606, in pair_energy_deterministic
    bot_term = self.get_bot_env(i,row,bot_term,config_new,cache_bot)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 224, in get_bot_env
    tn.contract_boundary_from_bottom_(xrange=(i-1,i),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1235, in contract_boundary_from_bottom
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 848, in _contract_boundary_single
    canonize_fn(i, equalize_norms=equalize_norms)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 579, in canonize_row
    self.canonize_between((i, j), (i, j + 1), **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5110, in canonize_between
    self._canonize_between_tids(tid1, tid2, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5068, in _canonize_between_tids
    tensor_canonize_bond(Tl, Tr, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 897, in tensor_canonize_bond
    new_T1, tRfact = T1.split(left_env_ix, get='tensors', **split_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 815, in tensor_split
    left = reshape(left, (*left_dims, -1))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [0, 8, -1] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 632, in pair_energies_deterministic
    ex[site1,site2] = self.pair_energy_deterministic(config,peps,site1,site2,cache_bot,cache_top,sign_fn) * sign
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 613, in pair_energy_deterministic
    top_term = self.get_top_env(i,row,top_term,config_new,cache_top)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 258, in get_top_env
    tn.contract_boundary_from_top_(xrange=(i,i+1),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1351, in contract_boundary_from_top
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 848, in _contract_boundary_single
    canonize_fn(i, equalize_norms=equalize_norms)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 583, in canonize_row
    self.canonize_between((i, j), (i, j - 1), **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5110, in canonize_between
    self._canonize_between_tids(tid1, tid2, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5068, in _canonize_between_tids
    tensor_canonize_bond(Tl, Tr, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 897, in tensor_canonize_bond
    new_T1, tRfact = T1.split(left_env_ix, get='tensors', **split_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 815, in tensor_split
    left = reshape(left, (*left_dims, -1))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [0, 8, -1] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 632, in pair_energies_deterministic
    ex[site1,site2] = self.pair_energy_deterministic(config,peps,site1,site2,cache_bot,cache_top,sign_fn) * sign
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 606, in pair_energy_deterministic
    bot_term = self.get_bot_env(i,row,bot_term,config_new,cache_bot)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 224, in get_bot_env
    tn.contract_boundary_from_bottom_(xrange=(i-1,i),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1235, in contract_boundary_from_bottom
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 848, in _contract_boundary_single
    canonize_fn(i, equalize_norms=equalize_norms)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 579, in canonize_row
    self.canonize_between((i, j), (i, j + 1), **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5110, in canonize_between
    self._canonize_between_tids(tid1, tid2, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5068, in _canonize_between_tids
    tensor_canonize_bond(Tl, Tr, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 897, in tensor_canonize_bond
    new_T1, tRfact = T1.split(left_env_ix, get='tensors', **split_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 815, in tensor_split
    left = reshape(left, (*left_dims, -1))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [0, 8, -1] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 625, in pair_energies_deterministic
    env_bot,env_top = self.get_all_benvs(peps,config,cache_bot,cache_top)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 278, in get_all_benvs
    env_top = self.get_all_top_envs(peps,config,cache_top,imin=imin)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 268, in get_all_top_envs
    env_prev = self.get_top_env(i,row,env_prev,config,cache_top)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 258, in get_top_env
    tn.contract_boundary_from_top_(xrange=(i,i+1),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1351, in contract_boundary_from_top
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 848, in _contract_boundary_single
    canonize_fn(i, equalize_norms=equalize_norms)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 583, in canonize_row
    self.canonize_between((i, j), (i, j - 1), **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5110, in canonize_between
    self._canonize_between_tids(tid1, tid2, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5068, in _canonize_between_tids
    tensor_canonize_bond(Tl, Tr, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 897, in tensor_canonize_bond
    new_T1, tRfact = T1.split(left_env_ix, get='tensors', **split_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 815, in tensor_split
    left = reshape(left, (*left_dims, -1))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [0, 8, -1] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 632, in pair_energies_deterministic
    ex[site1,site2] = self.pair_energy_deterministic(config,peps,site1,site2,cache_bot,cache_top,sign_fn) * sign
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 606, in pair_energy_deterministic
    bot_term = self.get_bot_env(i,row,bot_term,config_new,cache_bot)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 224, in get_bot_env
    tn.contract_boundary_from_bottom_(xrange=(i-1,i),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1235, in contract_boundary_from_bottom
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 848, in _contract_boundary_single
    canonize_fn(i, equalize_norms=equalize_norms)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 579, in canonize_row
    self.canonize_between((i, j), (i, j + 1), **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5110, in canonize_between
    self._canonize_between_tids(tid1, tid2, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5068, in _canonize_between_tids
    tensor_canonize_bond(Tl, Tr, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 897, in tensor_canonize_bond
    new_T1, tRfact = T1.split(left_env_ix, get='tensors', **split_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 815, in tensor_split
    left = reshape(left, (*left_dims, -1))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [0, 8, -1] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 632, in pair_energies_deterministic
    ex[site1,site2] = self.pair_energy_deterministic(config,peps,site1,site2,cache_bot,cache_top,sign_fn) * sign
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 613, in pair_energy_deterministic
    top_term = self.get_top_env(i,row,top_term,config_new,cache_top)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 258, in get_top_env
    tn.contract_boundary_from_top_(xrange=(i,i+1),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1351, in contract_boundary_from_top
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 857, in _contract_boundary_single
    compress_opts=compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 719, in compress_row
    cutoff=cutoff, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5038, in compress_between
    **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 4942, in _compress_between_tids
    tensor_compress_bond(ta, tb, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 967, in tensor_compress_bond
    get='tensors', method='qr')
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 816, in tensor_split
    right = reshape(right, (-1, *right_dims))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [-1, 0] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 632, in pair_energies_deterministic
    ex[site1,site2] = self.pair_energy_deterministic(config,peps,site1,site2,cache_bot,cache_top,sign_fn) * sign
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 613, in pair_energy_deterministic
    top_term = self.get_top_env(i,row,top_term,config_new,cache_top)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 258, in get_top_env
    tn.contract_boundary_from_top_(xrange=(i,i+1),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1351, in contract_boundary_from_top
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 857, in _contract_boundary_single
    compress_opts=compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 719, in compress_row
    cutoff=cutoff, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5038, in compress_between
    **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 4942, in _compress_between_tids
    tensor_compress_bond(ta, tb, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 967, in tensor_compress_bond
    get='tensors', method='qr')
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 816, in tensor_split
    right = reshape(right, (-1, *right_dims))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [-1, 0] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 632, in pair_energies_deterministic
    ex[site1,site2] = self.pair_energy_deterministic(config,peps,site1,site2,cache_bot,cache_top,sign_fn) * sign
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 606, in pair_energy_deterministic
    bot_term = self.get_bot_env(i,row,bot_term,config_new,cache_bot)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 224, in get_bot_env
    tn.contract_boundary_from_bottom_(xrange=(i-1,i),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1235, in contract_boundary_from_bottom
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 848, in _contract_boundary_single
    canonize_fn(i, equalize_norms=equalize_norms)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 579, in canonize_row
    self.canonize_between((i, j), (i, j + 1), **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5110, in canonize_between
    self._canonize_between_tids(tid1, tid2, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5068, in _canonize_between_tids
    tensor_canonize_bond(Tl, Tr, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 897, in tensor_canonize_bond
    new_T1, tRfact = T1.split(left_env_ix, get='tensors', **split_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 815, in tensor_split
    left = reshape(left, (*left_dims, -1))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [0, 8, -1] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 632, in pair_energies_deterministic
    ex[site1,site2] = self.pair_energy_deterministic(config,peps,site1,site2,cache_bot,cache_top,sign_fn) * sign
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 613, in pair_energy_deterministic
    top_term = self.get_top_env(i,row,top_term,config_new,cache_top)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 258, in get_top_env
    tn.contract_boundary_from_top_(xrange=(i,i+1),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1351, in contract_boundary_from_top
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 857, in _contract_boundary_single
    compress_opts=compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 719, in compress_row
    cutoff=cutoff, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5038, in compress_between
    **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 4942, in _compress_between_tids
    tensor_compress_bond(ta, tb, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 974, in tensor_compress_bond
    absorb=absorb, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 815, in tensor_split
    left = reshape(left, (*left_dims, -1))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [0, -1] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 632, in pair_energies_deterministic
    ex[site1,site2] = self.pair_energy_deterministic(config,peps,site1,site2,cache_bot,cache_top,sign_fn) * sign
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 613, in pair_energy_deterministic
    top_term = self.get_top_env(i,row,top_term,config_new,cache_top)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 258, in get_top_env
    tn.contract_boundary_from_top_(xrange=(i,i+1),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1351, in contract_boundary_from_top
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 857, in _contract_boundary_single
    compress_opts=compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 719, in compress_row
    cutoff=cutoff, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5038, in compress_between
    **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 4942, in _compress_between_tids
    tensor_compress_bond(ta, tb, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 967, in tensor_compress_bond
    get='tensors', method='qr')
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 816, in tensor_split
    right = reshape(right, (-1, *right_dims))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [-1, 0] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 632, in pair_energies_deterministic
    ex[site1,site2] = self.pair_energy_deterministic(config,peps,site1,site2,cache_bot,cache_top,sign_fn) * sign
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 613, in pair_energy_deterministic
    top_term = self.get_top_env(i,row,top_term,config_new,cache_top)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 258, in get_top_env
    tn.contract_boundary_from_top_(xrange=(i,i+1),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1351, in contract_boundary_from_top
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 857, in _contract_boundary_single
    compress_opts=compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 719, in compress_row
    cutoff=cutoff, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5038, in compress_between
    **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 4942, in _compress_between_tids
    tensor_compress_bond(ta, tb, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 974, in tensor_compress_bond
    absorb=absorb, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 815, in tensor_split
    left = reshape(left, (*left_dims, -1))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [0, -1] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 632, in pair_energies_deterministic
    ex[site1,site2] = self.pair_energy_deterministic(config,peps,site1,site2,cache_bot,cache_top,sign_fn) * sign
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 606, in pair_energy_deterministic
    bot_term = self.get_bot_env(i,row,bot_term,config_new,cache_bot)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 224, in get_bot_env
    tn.contract_boundary_from_bottom_(xrange=(i-1,i),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1235, in contract_boundary_from_bottom
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 848, in _contract_boundary_single
    canonize_fn(i, equalize_norms=equalize_norms)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 579, in canonize_row
    self.canonize_between((i, j), (i, j + 1), **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5110, in canonize_between
    self._canonize_between_tids(tid1, tid2, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5068, in _canonize_between_tids
    tensor_canonize_bond(Tl, Tr, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 897, in tensor_canonize_bond
    new_T1, tRfact = T1.split(left_env_ix, get='tensors', **split_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 815, in tensor_split
    left = reshape(left, (*left_dims, -1))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [0, 8, -1] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 632, in pair_energies_deterministic
    ex[site1,site2] = self.pair_energy_deterministic(config,peps,site1,site2,cache_bot,cache_top,sign_fn) * sign
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 613, in pair_energy_deterministic
    top_term = self.get_top_env(i,row,top_term,config_new,cache_top)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 258, in get_top_env
    tn.contract_boundary_from_top_(xrange=(i,i+1),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1351, in contract_boundary_from_top
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 848, in _contract_boundary_single
    canonize_fn(i, equalize_norms=equalize_norms)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 583, in canonize_row
    self.canonize_between((i, j), (i, j - 1), **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5110, in canonize_between
    self._canonize_between_tids(tid1, tid2, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5068, in _canonize_between_tids
    tensor_canonize_bond(Tl, Tr, absorb=absorb, **canonize_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 897, in tensor_canonize_bond
    new_T1, tRfact = T1.split(left_env_ix, get='tensors', **split_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 815, in tensor_split
    left = reshape(left, (*left_dims, -1))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [0, 8, -1] because the unspecified dimension size -1 can be any value and is ambiguous
Traceback (most recent call last):
  File "run.py", line 74, in <module>
    tnvmc.run(start,stop,tmpdir=tmpdir)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 184, in run
    self.sample()
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 214, in sample
    self._sample_stochastic(compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/vmc.py", line 258, in _sample_stochastic
    config,self.sampler.amplitude_factory,compute_v=compute_v,compute_Hv=compute_Hv)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 656, in compute_local_energy
    ex_dict,cx,sign = self.pair_energies_deterministic(config,peps,cache_bot,cache_top,sign_fn)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 632, in pair_energies_deterministic
    ex[site1,site2] = self.pair_energy_deterministic(config,peps,site1,site2,cache_bot,cache_top,sign_fn) * sign
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 613, in pair_energy_deterministic
    top_term = self.get_top_env(i,row,top_term,config_new,cache_top)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d_vmc.py", line 258, in get_top_env
    tn.contract_boundary_from_top_(xrange=(i,i+1),**self.compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1351, in contract_boundary_from_top
    **contract_boundary_opts,
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 1115, in contract_boundary_from
    tn._contract_boundary_single(**contract_boundary_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 857, in _contract_boundary_single
    compress_opts=compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_2d.py", line 719, in compress_row
    cutoff=cutoff, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 5038, in compress_between
    **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 4942, in _compress_between_tids
    tensor_compress_bond(ta, tb, **compress_opts)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 967, in tensor_compress_bond
    get='tensors', method='qr')
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 2279, in split
    return tensor_split(self, *args, **kwargs)
  File "/home/rppeng/code/quimb-refactor/quimb/tensor/tensor_core.py", line 816, in tensor_split
    right = reshape(right, (-1, *right_dims))
  File "/home/rppeng/code/autoray/autoray/autoray.py", line 480, in reshape
    return x.reshape(shape)
RuntimeError: cannot reshape tensor of 0 elements into shape [-1, 0] because the unspecified dimension size -1 can be any value and is ambiguous
mpirun: Forwarding signal 18 to job
slurmstepd: error: *** JOB 493397 ON pauling016 CANCELLED AT 2023-05-25T14:05:40 ***
mpirun: abort is already in progress...hit ctrl-c again to forcibly terminate

